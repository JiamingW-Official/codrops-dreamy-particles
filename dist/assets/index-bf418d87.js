var Da=Object.defineProperty;var Ca=(o,t,e)=>t in o?Da(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var Oi=(o,t,e)=>(Ca(o,typeof t!="symbol"?t+"":t,e),e);import{L as Sa,F as ka,S as Ea,E as Ta,a as Ji,G as Ia,M as Vn,D as Pa,b as zn,H as Oa,C as kn,B as Fi,c as Fa,d as Aa,A as La}from"./GPGPU-6bd59e16.js";class Ra{constructor(){this.dataMap=null}async init(){try{const t=await fetch("./data/market_data.json?v="+new Date().getTime());if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.dataMap=await t.json(),console.log("Market Data Loaded:",Object.keys(this.dataMap).length,"days")}catch(t){console.error("Failed to load market data:",t)}}getDataForDate(t){if(!this.dataMap)return console.warn("Market data not loaded yet."),this.getMockFallback(t);const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),r=`${e}-${n}-${i}`;let a=this.dataMap[r];if(!a)for(let s=1;s<=5;s++){const c=new Date(t);c.setDate(t.getDate()-s);const u=c.getFullYear(),l=String(c.getMonth()+1).padStart(2,"0"),f=String(c.getDate()).padStart(2,"0"),m=`${u}-${l}-${f}`;if(this.dataMap[m]){a=this.dataMap[m];break}}return a||this.getMockFallback(t)}getMockFallback(t){return{date:t.toISOString().split("T")[0],fearGreedIndex:50,sentiment:0,marketChangePercent:0,headlines:["Data unavailable for this date","Please check fetch_data.py"],volatility:.2,vix:20,indexValue:0,sp500Value:0,volume:0,dayHigh:0,dayLow:0,yearHigh:0,yearLow:0,sectorStat:0,rsi:50,tenYearYield:4,moodState:"Neutral",regime:"Data Missing"}}}class Na extends Sa{constructor(t){super(t)}load(t,e,n,i){const r=this,a=new ka(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(s){const c=r.parse(JSON.parse(s));e&&e(c)},n,i)}parse(t){return new $a(t)}}class $a{constructor(t){this.isFont=!0,this.type="Font",this.data=t}generateShapes(t,e=100){const n=[],i=Ba(t,e,this.data);for(let r=0,a=i.length;r<a;r++)n.push(...i[r].toShapes());return n}}function Ba(o,t,e){const n=Array.from(o),i=t/e.resolution,r=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*i,a=[];let s=0,c=0;for(let u=0;u<n.length;u++){const l=n[u];if(l===`
`)s=0,c-=r;else{const f=Ya(l,i,s,c,e);s+=f.offsetX,a.push(f.path)}}return a}function Ya(o,t,e,n,i){const r=i.glyphs[o]||i.glyphs["?"];if(!r){console.error('THREE.Font: character "'+o+'" does not exists in font family '+i.familyName+".");return}const a=new Ea;let s,c,u,l,f,m,p,_;if(r.o){const d=r._cachedOutline||(r._cachedOutline=r.o.split(" "));for(let v=0,y=d.length;v<y;)switch(d[v++]){case"m":s=d[v++]*t+e,c=d[v++]*t+n,a.moveTo(s,c);break;case"l":s=d[v++]*t+e,c=d[v++]*t+n,a.lineTo(s,c);break;case"q":u=d[v++]*t+e,l=d[v++]*t+n,f=d[v++]*t+e,m=d[v++]*t+n,a.quadraticCurveTo(f,m,u,l);break;case"b":u=d[v++]*t+e,l=d[v++]*t+n,f=d[v++]*t+e,m=d[v++]*t+n,p=d[v++]*t+e,_=d[v++]*t+n,a.bezierCurveTo(f,m,p,_,u,l);break}}return{offsetX:r.ha*t,path:a}}class Ha extends Ta{constructor(t,e={}){const n=e.font;if(n===void 0)super();else{const i=n.generateShapes(t,e.size);e.depth===void 0&&e.height!==void 0&&console.warn("THREE.TextGeometry: .height is now depreciated. Please use .depth instead"),e.depth=e.depth!==void 0?e.depth:e.height!==void 0?e.height:50,e.bevelThickness===void 0&&(e.bevelThickness=10),e.bevelSize===void 0&&(e.bevelSize=8),e.bevelEnabled===void 0&&(e.bevelEnabled=!1),super(i,e)}this.type="TextGeometry"}}class Va{constructor(){this.experience=new Ji,this.scene=this.experience.scene,this.camera=this.experience.camera,this.group=new Ia,this.scene.add(this.group),this.words=[],this.font=null,this.loader=new Na,this.loader.load("/fonts/helvetiker_regular.typeface.json",t=>{this.font=t}),this.stopWords=new Set(["stock","market","daily","news","update","today","price","shares","gains","losses","drop","rise","fall","plunge","record","highs","lows","watch","moves","action","closely"])}updateHeadlines(t){if(!this.font||!t)return;this.words.forEach(c=>{c.geometry.dispose(),c.material.dispose(),this.group.remove(c)}),this.words=[];const n=t.map(c=>c.title).join(" ").toLowerCase().match(/\b\w+\b/g)||[],i={};n.forEach(c=>{c.length>3&&!this.stopWords.has(c)&&(i[c]=(i[c]||0)+1)});const a=Object.keys(i).sort((c,u)=>i[u]-i[c]).slice(0,8);if(a.length===0)return;const s=new Vn({color:16777215,transparent:!0,opacity:.6,side:Pa});a.forEach((c,u)=>{const l=new Ha(c.toUpperCase(),{font:this.font,size:.15,height:.02,curveSegments:4});l.center();const f=new zn(l,s),m=Math.acos(-1+2*u/a.length),p=Math.sqrt(a.length*Math.PI)*m,_=3.5;f.position.setFromSphericalCoords(_,m,p),f.lookAt(0,0,0),f.userData={word:c,angle:Math.random()*Math.PI*2,speed:.2+Math.random()*.2,yOffset:(Math.random()-.5)*2},this.group.add(f),this.words.push(f)})}update(t){this.group.rotation.y=t*.1,this.group.rotation.z=Math.sin(t*.05)*.1,this.words.forEach(e=>{this.experience.camera&&this.experience.camera.instance&&e.lookAt(this.experience.camera.instance.position)})}checkIntersects(t){if(!this.group||this.words.length===0)return null;const e=t.intersectObjects(this.words,!1);if(e.length>0){this.words.forEach(i=>i.material.color.setHex(16777215));const n=e[0].object;return n.material.color.setHex(65450),n.userData.word}else this.words.forEach(n=>n.material.color.setHex(16777215));return null}}function We(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function Zi(o,t){o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.__proto__=t}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Oe={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Pt={duration:.5,overwrite:!1,delay:0},si,me,Z,Ne=1e8,J=1/Ne,jn=Math.PI*2,za=jn/4,ja=0,er=Math.sqrt,Ga=Math.cos,Ua=Math.sin,ce=function(t){return typeof t=="string"},ie=function(t){return typeof t=="function"},qe=function(t){return typeof t=="number"},oi=function(t){return typeof t>"u"},Ge=function(t){return typeof t=="object"},xe=function(t){return t!==!1},li=function(){return typeof window<"u"},an=function(t){return ie(t)||ce(t)},tr=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},pe=Array.isArray,Gn=/(?:-?\.?\d|\.)+/gi,nr=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Dt=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,En=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ir=/[+-]=-?[.\d]+/,rr=/[^,'"\[\]\s]+/gi,Wa=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,te,He,Un,ci,Fe={},fn={},ar,sr=function(t){return(fn=_t(t,Fe))&&De},ui=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},jt=function(t,e){return!e&&console.warn(t)},or=function(t,e){return t&&(Fe[t]=e)&&fn&&(fn[t]=e)||Fe},Gt=function(){return 0},Xa={suppressEvents:!0,isStart:!0,kill:!1},ln={suppressEvents:!0,kill:!1},qa={suppressEvents:!0},fi={},it=[],Wn={},lr,Te={},Tn={},Ai=30,cn=[],di="",hi=function(t){var e=t[0],n,i;if(Ge(e)||ie(e)||(t=[t]),!(n=(e._gsap||{}).harness)){for(i=cn.length;i--&&!cn[i].targetTest(e););n=cn[i]}for(i=t.length;i--;)t[i]&&(t[i]._gsap||(t[i]._gsap=new Or(t[i],n)))||t.splice(i,1);return t},mt=function(t){return t._gsap||hi($e(t))[0]._gsap},cr=function(t,e,n){return(n=t[e])&&ie(n)?t[e]():oi(n)&&t.getAttribute&&t.getAttribute(e)||n},be=function(t,e){return(t=t.split(",")).forEach(e)||t},re=function(t){return Math.round(t*1e5)/1e5||0},le=function(t){return Math.round(t*1e7)/1e7||0},St=function(t,e){var n=e.charAt(0),i=parseFloat(e.substr(2));return t=parseFloat(t),n==="+"?t+i:n==="-"?t-i:n==="*"?t*i:t/i},Ka=function(t,e){for(var n=e.length,i=0;t.indexOf(e[i])<0&&++i<n;);return i<n},dn=function(){var t=it.length,e=it.slice(0),n,i;for(Wn={},it.length=0,n=0;n<t;n++)i=e[n],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},ur=function(t,e,n,i){it.length&&!me&&dn(),t.render(e,n,i||me&&e<0&&(t._initted||t._startAt)),it.length&&!me&&dn()},fr=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(rr).length<2?e:ce(t)?t.trim():t},dr=function(t){return t},Be=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},Qa=function(t){return function(e,n){for(var i in n)i in e||i==="duration"&&t||i==="ease"||(e[i]=n[i])}},_t=function(t,e){for(var n in e)t[n]=e[n];return t},Li=function o(t,e){for(var n in e)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(t[n]=Ge(e[n])?o(t[n]||(t[n]={}),e[n]):e[n]);return t},hn=function(t,e){var n={},i;for(i in t)i in e||(n[i]=t[i]);return n},Yt=function(t){var e=t.parent||te,n=t.keyframes?Qa(pe(t.keyframes)):Be;if(xe(t.inherit))for(;e;)n(t,e.vars.defaults),e=e.parent||e._dp;return t},Ja=function(t,e){for(var n=t.length,i=n===e.length;i&&n--&&t[n]===e[n];);return n<0},hr=function(t,e,n,i,r){n===void 0&&(n="_first"),i===void 0&&(i="_last");var a=t[i],s;if(r)for(s=e[r];a&&a[r]>s;)a=a._prev;return a?(e._next=a._next,a._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[i]=e,e._prev=a,e.parent=e._dp=t,e},yn=function(t,e,n,i){n===void 0&&(n="_first"),i===void 0&&(i="_last");var r=e._prev,a=e._next;r?r._next=a:t[n]===e&&(t[n]=a),a?a._prev=r:t[i]===e&&(t[i]=r),e._next=e._prev=e.parent=null},at=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},pt=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},Za=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},Xn=function(t,e,n,i){return t._startAt&&(me?t._startAt.revert(ln):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,i))},es=function o(t){return!t||t._ts&&o(t.parent)},Ri=function(t){return t._repeat?Ot(t._tTime,t=t.duration()+t._rDelay)*t:0},Ot=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},mn=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},xn=function(t){return t._end=le(t._start+(t._tDur/Math.abs(t._ts||t._rts||J)||0))},bn=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=le(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),xn(t),n._dirty||pt(n,t)),t},mr=function(t,e){var n;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(n=mn(t.rawTime(),e),(!e._dur||Jt(0,e.totalDuration(),n)-e._tTime>J)&&e.render(n,!0)),pt(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-J}},Ve=function(t,e,n,i){return e.parent&&at(e),e._start=le((qe(n)?n:n||t!==te?Le(t,n,e):t._time)+e._delay),e._end=le(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),hr(t,e,"_first","_last",t._sort?"_start":0),qn(e)||(t._recent=e),i||mr(t,e),t._ts<0&&bn(t,t._tTime),t},pr=function(t,e){return(Fe.ScrollTrigger||ui("scrollTrigger",e))&&Fe.ScrollTrigger.create(e,t)},gr=function(t,e,n,i,r){if(pi(t,e,r),!t._initted)return 1;if(!n&&t._pt&&!me&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&lr!==Ie.frame)return it.push(t),t._lazy=[r,i],1},ts=function o(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||o(e))},qn=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},ns=function(t,e,n,i){var r=t.ratio,a=e<0||!e&&(!t._start&&ts(t)&&!(!t._initted&&qn(t))||(t._ts<0||t._dp._ts<0)&&!qn(t))?0:1,s=t._rDelay,c=0,u,l,f;if(s&&t._repeat&&(c=Jt(0,t._tDur,e),l=Ot(c,s),t._yoyo&&l&1&&(a=1-a),l!==Ot(t._tTime,s)&&(r=1-a,t.vars.repeatRefresh&&t._initted&&t.invalidate())),a!==r||me||i||t._zTime===J||!e&&t._zTime){if(!t._initted&&gr(t,e,i,n,c))return;for(f=t._zTime,t._zTime=e||(n?J:0),n||(n=e&&!f),t.ratio=a,t._from&&(a=1-a),t._time=0,t._tTime=c,u=t._pt;u;)u.r(a,u.d),u=u._next;e<0&&Xn(t,e,n,!0),t._onUpdate&&!n&&Pe(t,"onUpdate"),c&&t._repeat&&!n&&t.parent&&Pe(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===a&&(a&&at(t,1),!n&&!me&&(Pe(t,a?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},is=function(t,e,n){var i;if(n>e)for(i=t._first;i&&i._start<=n;){if(i.data==="isPause"&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=n;){if(i.data==="isPause"&&i._start<e)return i;i=i._prev}},Ft=function(t,e,n,i){var r=t._repeat,a=le(e)||0,s=t._tTime/t._tDur;return s&&!i&&(t._time*=a/t._dur),t._dur=a,t._tDur=r?r<0?1e10:le(a*(r+1)+t._rDelay*r):a,s>0&&!i&&bn(t,t._tTime=t._tDur*s),t.parent&&xn(t),n||pt(t.parent,t),t},Ni=function(t){return t instanceof ve?pt(t):Ft(t,t._dur)},rs={_start:0,endTime:Gt,totalDuration:Gt},Le=function o(t,e,n){var i=t.labels,r=t._recent||rs,a=t.duration()>=Ne?r.endTime(!1):t._dur,s,c,u;return ce(e)&&(isNaN(e)||e in i)?(c=e.charAt(0),u=e.substr(-1)==="%",s=e.indexOf("="),c==="<"||c===">"?(s>=0&&(e=e.replace(/=/,"")),(c==="<"?r._start:r.endTime(r._repeat>=0))+(parseFloat(e.substr(1))||0)*(u?(s<0?r:n).totalDuration()/100:1)):s<0?(e in i||(i[e]=a),i[e]):(c=parseFloat(e.charAt(s-1)+e.substr(s+1)),u&&n&&(c=c/100*(pe(n)?n[0]:n).totalDuration()),s>1?o(t,e.substr(0,s-1),n)+c:a+c)):e==null?a:+e},Ht=function(t,e,n){var i=qe(e[1]),r=(i?2:1)+(t<2?0:1),a=e[r],s,c;if(i&&(a.duration=e[1]),a.parent=n,t){for(s=a,c=n;c&&!("immediateRender"in s);)s=c.vars.defaults||{},c=xe(c.vars.inherit)&&c.parent;a.immediateRender=xe(s.immediateRender),t<2?a.runBackwards=1:a.startAt=e[r-1]}return new ae(e[0],a,e[r+1])},ot=function(t,e){return t||t===0?e(t):e},Jt=function(t,e,n){return n<t?t:n>e?e:n},he=function(t,e){return!ce(t)||!(e=Wa.exec(t))?"":e[1]},as=function(t,e,n){return ot(n,function(i){return Jt(t,e,i)})},Kn=[].slice,vr=function(t,e){return t&&Ge(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&Ge(t[0]))&&!t.nodeType&&t!==He},ss=function(t,e,n){return n===void 0&&(n=[]),t.forEach(function(i){var r;return ce(i)&&!e||vr(i,1)?(r=n).push.apply(r,$e(i)):n.push(i)})||n},$e=function(t,e,n){return Z&&!e&&Z.selector?Z.selector(t):ce(t)&&!n&&(Un||!At())?Kn.call((e||ci).querySelectorAll(t),0):pe(t)?ss(t,n):vr(t)?Kn.call(t,0):t?[t]:[]},Qn=function(t){return t=$e(t)[0]||jt("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return $e(e,n.querySelectorAll?n:n===t?jt("Invalid scope")||ci.createElement("div"):t)}},_r=function(t){return t.sort(function(){return .5-Math.random()})},yr=function(t){if(ie(t))return t;var e=Ge(t)?t:{each:t},n=gt(e.ease),i=e.from||0,r=parseFloat(e.base)||0,a={},s=i>0&&i<1,c=isNaN(i)||s,u=e.axis,l=i,f=i;return ce(i)?l=f={center:.5,edges:.5,end:1}[i]||0:!s&&c&&(l=i[0],f=i[1]),function(m,p,_){var d=(_||e).length,v=a[d],y,w,b,D,k,C,T,I,E;if(!v){if(E=e.grid==="auto"?0:(e.grid||[1,Ne])[1],!E){for(T=-Ne;T<(T=_[E++].getBoundingClientRect().left)&&E<d;);E<d&&E--}for(v=a[d]=[],y=c?Math.min(E,d)*l-.5:i%E,w=E===Ne?0:c?d*f/E-.5:i/E|0,T=0,I=Ne,C=0;C<d;C++)b=C%E-y,D=w-(C/E|0),v[C]=k=u?Math.abs(u==="y"?D:b):er(b*b+D*D),k>T&&(T=k),k<I&&(I=k);i==="random"&&_r(v),v.max=T-I,v.min=I,v.v=d=(parseFloat(e.amount)||parseFloat(e.each)*(E>d?d-1:u?u==="y"?d/E:E:Math.max(E,d/E))||0)*(i==="edges"?-1:1),v.b=d<0?r-d:r,v.u=he(e.amount||e.each)||0,n=n&&d<0?Tr(n):n}return d=(v[m]-v.min)/v.max||0,le(v.b+(n?n(d):d)*v.v)+v.u}},Jn=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var i=le(Math.round(parseFloat(n)/t)*t*e);return(i-i%1)/e+(qe(n)?0:he(n))}},xr=function(t,e){var n=pe(t),i,r;return!n&&Ge(t)&&(i=n=t.radius||Ne,t.values?(t=$e(t.values),(r=!qe(t[0]))&&(i*=i)):t=Jn(t.increment)),ot(e,n?ie(t)?function(a){return r=t(a),Math.abs(r-a)<=i?r:a}:function(a){for(var s=parseFloat(r?a.x:a),c=parseFloat(r?a.y:0),u=Ne,l=0,f=t.length,m,p;f--;)r?(m=t[f].x-s,p=t[f].y-c,m=m*m+p*p):m=Math.abs(t[f]-s),m<u&&(u=m,l=f);return l=!i||u<=i?t[l]:a,r||l===a||qe(a)?l:l+he(a)}:Jn(t))},br=function(t,e,n,i){return ot(pe(t)?!e:n===!0?!!(n=0):!i,function(){return pe(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+n*.99))/n)*n*i)/i})},os=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(i){return e.reduce(function(r,a){return a(r)},i)}},ls=function(t,e){return function(n){return t(parseFloat(n))+(e||he(n))}},cs=function(t,e,n){return Mr(t,e,0,1,n)},wr=function(t,e,n){return ot(n,function(i){return t[~~e(i)]})},us=function o(t,e,n){var i=e-t;return pe(t)?wr(t,o(0,t.length),e):ot(n,function(r){return(i+(r-t)%i)%i+t})},fs=function o(t,e,n){var i=e-t,r=i*2;return pe(t)?wr(t,o(0,t.length-1),e):ot(n,function(a){return a=(r+(a-t)%r)%r||0,t+(a>i?r-a:a)})},Ut=function(t){for(var e=0,n="",i,r,a,s;~(i=t.indexOf("random(",e));)a=t.indexOf(")",i),s=t.charAt(i+7)==="[",r=t.substr(i+7,a-i-7).match(s?rr:Gn),n+=t.substr(e,i-e)+br(s?r:+r[0],s?0:+r[1],+r[2]||1e-5),e=a+1;return n+t.substr(e,t.length-e)},Mr=function(t,e,n,i,r){var a=e-t,s=i-n;return ot(r,function(c){return n+((c-t)/a*s||0)})},ds=function o(t,e,n,i){var r=isNaN(t+e)?0:function(p){return(1-p)*t+p*e};if(!r){var a=ce(t),s={},c,u,l,f,m;if(n===!0&&(i=1)&&(n=null),a)t={p:t},e={p:e};else if(pe(t)&&!pe(e)){for(l=[],f=t.length,m=f-2,u=1;u<f;u++)l.push(o(t[u-1],t[u]));f--,r=function(_){_*=f;var d=Math.min(m,~~_);return l[d](_-d)},n=e}else i||(t=_t(pe(t)?[]:{},t));if(!l){for(c in e)mi.call(s,t,c,"get",e[c]);r=function(_){return _i(_,s)||(a?t.p:t)}}}return ot(n,r)},$i=function(t,e,n){var i=t.labels,r=Ne,a,s,c;for(a in i)s=i[a]-e,s<0==!!n&&s&&r>(s=Math.abs(s))&&(c=a,r=s);return c},Pe=function(t,e,n){var i=t.vars,r=i[e],a=Z,s=t._ctx,c,u,l;if(r)return c=i[e+"Params"],u=i.callbackScope||t,n&&it.length&&dn(),s&&(Z=s),l=c?r.apply(u,c):r.call(u),Z=a,l},$t=function(t){return at(t),t.scrollTrigger&&t.scrollTrigger.kill(!!me),t.progress()<1&&Pe(t,"onInterrupt"),t},Ct,Dr=[],Cr=function(t){if(t)if(t=!t.name&&t.default||t,li()||t.headless){var e=t.name,n=ie(t),i=e&&!n&&t.init?function(){this._props=[]}:t,r={init:Gt,render:_i,add:mi,kill:Es,modifier:ks,rawVars:0},a={targetTest:0,get:0,getSetter:vi,aliases:{},register:0};if(At(),t!==i){if(Te[e])return;Be(i,Be(hn(t,r),a)),_t(i.prototype,_t(r,hn(t,a))),Te[i.prop=e]=i,t.targetTest&&(cn.push(i),fi[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}or(e,i),t.register&&t.register(De,i,we)}else Dr.push(t)},Q=255,Bt={aqua:[0,Q,Q],lime:[0,Q,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Q],navy:[0,0,128],white:[Q,Q,Q],olive:[128,128,0],yellow:[Q,Q,0],orange:[Q,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Q,0,0],pink:[Q,192,203],cyan:[0,Q,Q],transparent:[Q,Q,Q,0]},In=function(t,e,n){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(n-e)*t*6:t<.5?n:t*3<2?e+(n-e)*(2/3-t)*6:e)*Q+.5|0},Sr=function(t,e,n){var i=t?qe(t)?[t>>16,t>>8&Q,t&Q]:0:Bt.black,r,a,s,c,u,l,f,m,p,_;if(!i){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Bt[t])i=Bt[t];else if(t.charAt(0)==="#"){if(t.length<6&&(r=t.charAt(1),a=t.charAt(2),s=t.charAt(3),t="#"+r+r+a+a+s+s+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return i=parseInt(t.substr(1,6),16),[i>>16,i>>8&Q,i&Q,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),i=[t>>16,t>>8&Q,t&Q]}else if(t.substr(0,3)==="hsl"){if(i=_=t.match(Gn),!e)c=+i[0]%360/360,u=+i[1]/100,l=+i[2]/100,a=l<=.5?l*(u+1):l+u-l*u,r=l*2-a,i.length>3&&(i[3]*=1),i[0]=In(c+1/3,r,a),i[1]=In(c,r,a),i[2]=In(c-1/3,r,a);else if(~t.indexOf("="))return i=t.match(nr),n&&i.length<4&&(i[3]=1),i}else i=t.match(Gn)||Bt.transparent;i=i.map(Number)}return e&&!_&&(r=i[0]/Q,a=i[1]/Q,s=i[2]/Q,f=Math.max(r,a,s),m=Math.min(r,a,s),l=(f+m)/2,f===m?c=u=0:(p=f-m,u=l>.5?p/(2-f-m):p/(f+m),c=f===r?(a-s)/p+(a<s?6:0):f===a?(s-r)/p+2:(r-a)/p+4,c*=60),i[0]=~~(c+.5),i[1]=~~(u*100+.5),i[2]=~~(l*100+.5)),n&&i.length<4&&(i[3]=1),i},kr=function(t){var e=[],n=[],i=-1;return t.split(rt).forEach(function(r){var a=r.match(Dt)||[];e.push.apply(e,a),n.push(i+=a.length+1)}),e.c=n,e},Bi=function(t,e,n){var i="",r=(t+i).match(rt),a=e?"hsla(":"rgba(",s=0,c,u,l,f;if(!r)return t;if(r=r.map(function(m){return(m=Sr(m,e,1))&&a+(e?m[0]+","+m[1]+"%,"+m[2]+"%,"+m[3]:m.join(","))+")"}),n&&(l=kr(t),c=n.c,c.join(i)!==l.c.join(i)))for(u=t.replace(rt,"1").split(Dt),f=u.length-1;s<f;s++)i+=u[s]+(~c.indexOf(s)?r.shift()||a+"0,0,0,0)":(l.length?l:r.length?r:n).shift());if(!u)for(u=t.split(rt),f=u.length-1;s<f;s++)i+=u[s]+r[s];return i+u[f]},rt=function(){var o="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Bt)o+="|"+t+"\\b";return new RegExp(o+")","gi")}(),hs=/hsl[a]?\(/,Er=function(t){var e=t.join(" "),n;if(rt.lastIndex=0,rt.test(e))return n=hs.test(e),t[1]=Bi(t[1],n),t[0]=Bi(t[0],n,kr(t[1])),!0},Wt,Ie=function(){var o=Date.now,t=500,e=33,n=o(),i=n,r=1e3/240,a=r,s=[],c,u,l,f,m,p,_=function d(v){var y=o()-i,w=v===!0,b,D,k,C;if((y>t||y<0)&&(n+=y-e),i+=y,k=i-n,b=k-a,(b>0||w)&&(C=++f.frame,m=k-f.time*1e3,f.time=k=k/1e3,a+=b+(b>=r?4:r-b),D=1),w||(c=u(d)),D)for(p=0;p<s.length;p++)s[p](k,m,C,v)};return f={time:0,frame:0,tick:function(){_(!0)},deltaRatio:function(v){return m/(1e3/(v||60))},wake:function(){ar&&(!Un&&li()&&(He=Un=window,ci=He.document||{},Fe.gsap=De,(He.gsapVersions||(He.gsapVersions=[])).push(De.version),sr(fn||He.GreenSockGlobals||!He.gsap&&He||{}),Dr.forEach(Cr)),l=typeof requestAnimationFrame<"u"&&requestAnimationFrame,c&&f.sleep(),u=l||function(v){return setTimeout(v,a-f.time*1e3+1|0)},Wt=1,_(2))},sleep:function(){(l?cancelAnimationFrame:clearTimeout)(c),Wt=0,u=Gt},lagSmoothing:function(v,y){t=v||1/0,e=Math.min(y||33,t)},fps:function(v){r=1e3/(v||240),a=f.time*1e3+r},add:function(v,y,w){var b=y?function(D,k,C,T){v(D,k,C,T),f.remove(b)}:v;return f.remove(v),s[w?"unshift":"push"](b),At(),b},remove:function(v,y){~(y=s.indexOf(v))&&s.splice(y,1)&&p>=y&&p--},_listeners:s},f}(),At=function(){return!Wt&&Ie.wake()},X={},ms=/^[\d.\-M][\d.\-,\s]/,ps=/["']/g,gs=function(t){for(var e={},n=t.substr(1,t.length-3).split(":"),i=n[0],r=1,a=n.length,s,c,u;r<a;r++)c=n[r],s=r!==a-1?c.lastIndexOf(","):c.length,u=c.substr(0,s),e[i]=isNaN(u)?u.replace(ps,"").trim():+u,i=c.substr(s+1).trim();return e},vs=function(t){var e=t.indexOf("(")+1,n=t.indexOf(")"),i=t.indexOf("(",e);return t.substring(e,~i&&i<n?t.indexOf(")",n+1):n)},_s=function(t){var e=(t+"").split("("),n=X[e[0]];return n&&e.length>1&&n.config?n.config.apply(null,~t.indexOf("{")?[gs(e[1])]:vs(t).split(",").map(fr)):X._CE&&ms.test(t)?X._CE("",t):n},Tr=function(t){return function(e){return 1-t(1-e)}},Ir=function o(t,e){for(var n=t._first,i;n;)n instanceof ve?o(n,e):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==e&&(n.timeline?o(n.timeline,e):(i=n._ease,n._ease=n._yEase,n._yEase=i,n._yoyo=e)),n=n._next},gt=function(t,e){return t&&(ie(t)?t:X[t]||_s(t))||e},xt=function(t,e,n,i){n===void 0&&(n=function(c){return 1-e(1-c)}),i===void 0&&(i=function(c){return c<.5?e(c*2)/2:1-e((1-c)*2)/2});var r={easeIn:e,easeOut:n,easeInOut:i},a;return be(t,function(s){X[s]=Fe[s]=r,X[a=s.toLowerCase()]=n;for(var c in r)X[a+(c==="easeIn"?".in":c==="easeOut"?".out":".inOut")]=X[s+"."+c]=r[c]}),r},Pr=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},Pn=function o(t,e,n){var i=e>=1?e:1,r=(n||(t?.3:.45))/(e<1?e:1),a=r/jn*(Math.asin(1/i)||0),s=function(l){return l===1?1:i*Math.pow(2,-10*l)*Ua((l-a)*r)+1},c=t==="out"?s:t==="in"?function(u){return 1-s(1-u)}:Pr(s);return r=jn/r,c.config=function(u,l){return o(t,u,l)},c},On=function o(t,e){e===void 0&&(e=1.70158);var n=function(a){return a?--a*a*((e+1)*a+e)+1:0},i=t==="out"?n:t==="in"?function(r){return 1-n(1-r)}:Pr(n);return i.config=function(r){return o(t,r)},i};be("Linear,Quad,Cubic,Quart,Quint,Strong",function(o,t){var e=t<5?t+1:t;xt(o+",Power"+(e-1),t?function(n){return Math.pow(n,e)}:function(n){return n},function(n){return 1-Math.pow(1-n,e)},function(n){return n<.5?Math.pow(n*2,e)/2:1-Math.pow((1-n)*2,e)/2})});X.Linear.easeNone=X.none=X.Linear.easeIn;xt("Elastic",Pn("in"),Pn("out"),Pn());(function(o,t){var e=1/t,n=2*e,i=2.5*e,r=function(s){return s<e?o*s*s:s<n?o*Math.pow(s-1.5/t,2)+.75:s<i?o*(s-=2.25/t)*s+.9375:o*Math.pow(s-2.625/t,2)+.984375};xt("Bounce",function(a){return 1-r(1-a)},r)})(7.5625,2.75);xt("Expo",function(o){return o?Math.pow(2,10*(o-1)):0});xt("Circ",function(o){return-(er(1-o*o)-1)});xt("Sine",function(o){return o===1?1:-Ga(o*za)+1});xt("Back",On("in"),On("out"),On());X.SteppedEase=X.steps=Fe.SteppedEase={config:function(t,e){t===void 0&&(t=1);var n=1/t,i=t+(e?0:1),r=e?1:0,a=1-J;return function(s){return((i*Jt(0,a,s)|0)+r)*n}}};Pt.ease=X["quad.out"];be("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(o){return di+=o+","+o+"Params,"});var Or=function(t,e){this.id=ja++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:cr,this.set=e?e.getSetter:vi},Xt=function(){function o(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Ft(this,+e.duration,1,1),this.data=e.data,Z&&(this._ctx=Z,Z.data.push(this)),Wt||Ie.wake()}var t=o.prototype;return t.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},t.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},t.totalDuration=function(n){return arguments.length?(this._dirty=0,Ft(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(n,i){if(At(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(bn(this,n),!r._dp||r.parent||mr(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&Ve(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===J||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),ur(this,n,i)),this},t.time=function(n,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+Ri(this))%(this._dur+this._rDelay)||(n?this._dur:0),i):this._time},t.totalProgress=function(n,i){return arguments.length?this.totalTime(this.totalDuration()*n,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},t.progress=function(n,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+Ri(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(n,i){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*r,i):this._repeat?Ot(this._tTime,r)+1:1},t.timeScale=function(n,i){if(!arguments.length)return this._rts===-J?0:this._rts;if(this._rts===n)return this;var r=this.parent&&this._ts?mn(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-J?0:this._rts,this.totalTime(Jt(-Math.abs(this._delay),this._tDur,r),i!==!1),xn(this),Za(this)},t.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(At(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==J&&(this._tTime-=J)))),this):this._ps},t.startTime=function(n){if(arguments.length){this._start=n;var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&Ve(i,this,n-this._delay),this}return this._start},t.endTime=function(n){return this._start+(xe(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(n){var i=this.parent||this._dp;return i?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?mn(i.rawTime(n),this):this._tTime:this._tTime},t.revert=function(n){n===void 0&&(n=qa);var i=me;return me=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),me=i,this},t.globalTime=function(n){for(var i=this,r=arguments.length?n:i.rawTime();i;)r=i._start+r/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(n):r},t.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,Ni(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(n){if(arguments.length){var i=this._time;return this._rDelay=n,Ni(this),i?this.time(i):this}return this._rDelay},t.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},t.seek=function(n,i){return this.totalTime(Le(this,n),xe(i))},t.restart=function(n,i){return this.play().totalTime(n?-this._delay:0,xe(i))},t.play=function(n,i){return n!=null&&this.seek(n,i),this.reversed(!1).paused(!1)},t.reverse=function(n,i){return n!=null&&this.seek(n||this.totalDuration(),i),this.reversed(!0).paused(!1)},t.pause=function(n,i){return n!=null&&this.seek(n,i),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-J:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-J,this},t.isActive=function(){var n=this.parent||this._dp,i=this._start,r;return!!(!n||this._ts&&this._initted&&n.isActive()&&(r=n.rawTime(!0))>=i&&r<this.endTime(!0)-J)},t.eventCallback=function(n,i,r){var a=this.vars;return arguments.length>1?(i?(a[n]=i,r&&(a[n+"Params"]=r),n==="onUpdate"&&(this._onUpdate=i)):delete a[n],this):a[n]},t.then=function(n){var i=this;return new Promise(function(r){var a=ie(n)?n:dr,s=function(){var u=i.then;i.then=null,ie(a)&&(a=a(i))&&(a.then||a===i)&&(i.then=u),r(a),i.then=u};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?s():i._prom=s})},t.kill=function(){$t(this)},o}();Be(Xt.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-J,_prom:0,_ps:!1,_rts:1});var ve=function(o){Zi(t,o);function t(n,i){var r;return n===void 0&&(n={}),r=o.call(this,n)||this,r.labels={},r.smoothChildTiming=!!n.smoothChildTiming,r.autoRemoveChildren=!!n.autoRemoveChildren,r._sort=xe(n.sortChildren),te&&Ve(n.parent||te,We(r),i),n.reversed&&r.reverse(),n.paused&&r.paused(!0),n.scrollTrigger&&pr(We(r),n.scrollTrigger),r}var e=t.prototype;return e.to=function(i,r,a){return Ht(0,arguments,this),this},e.from=function(i,r,a){return Ht(1,arguments,this),this},e.fromTo=function(i,r,a,s){return Ht(2,arguments,this),this},e.set=function(i,r,a){return r.duration=0,r.parent=this,Yt(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new ae(i,r,Le(this,a),1),this},e.call=function(i,r,a){return Ve(this,ae.delayedCall(0,i,r),a)},e.staggerTo=function(i,r,a,s,c,u,l){return a.duration=r,a.stagger=a.stagger||s,a.onComplete=u,a.onCompleteParams=l,a.parent=this,new ae(i,a,Le(this,c)),this},e.staggerFrom=function(i,r,a,s,c,u,l){return a.runBackwards=1,Yt(a).immediateRender=xe(a.immediateRender),this.staggerTo(i,r,a,s,c,u,l)},e.staggerFromTo=function(i,r,a,s,c,u,l,f){return s.startAt=a,Yt(s).immediateRender=xe(s.immediateRender),this.staggerTo(i,r,s,c,u,l,f)},e.render=function(i,r,a){var s=this._time,c=this._dirty?this.totalDuration():this._tDur,u=this._dur,l=i<=0?0:le(i),f=this._zTime<0!=i<0&&(this._initted||!u),m,p,_,d,v,y,w,b,D,k,C,T;if(this!==te&&l>c&&i>=0&&(l=c),l!==this._tTime||a||f){if(s!==this._time&&u&&(l+=this._time-s,i+=this._time-s),m=l,D=this._start,b=this._ts,y=!b,f&&(u||(s=this._zTime),(i||!r)&&(this._zTime=i)),this._repeat){if(C=this._yoyo,v=u+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(v*100+i,r,a);if(m=le(l%v),l===c?(d=this._repeat,m=u):(d=~~(l/v),d&&d===l/v&&(m=u,d--),m>u&&(m=u)),k=Ot(this._tTime,v),!s&&this._tTime&&k!==d&&this._tTime-k*v-this._dur<=0&&(k=d),C&&d&1&&(m=u-m,T=1),d!==k&&!this._lock){var I=C&&k&1,E=I===(C&&d&1);if(d<k&&(I=!I),s=I?0:l%u?u:l,this._lock=1,this.render(s||(T?0:le(d*v)),r,!u)._lock=0,this._tTime=l,!r&&this.parent&&Pe(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),s&&s!==this._time||y!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(u=this._dur,c=this._tDur,E&&(this._lock=2,s=I?u:-1e-4,this.render(s,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!y)return this;Ir(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(w=is(this,le(s),le(m)),w&&(l-=m-(m=w._start))),this._tTime=l,this._time=m,this._act=!b,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,s=0),!s&&m&&!r&&!d&&(Pe(this,"onStart"),this._tTime!==l))return this;if(m>=s&&i>=0)for(p=this._first;p;){if(_=p._next,(p._act||m>=p._start)&&p._ts&&w!==p){if(p.parent!==this)return this.render(i,r,a);if(p.render(p._ts>0?(m-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(m-p._start)*p._ts,r,a),m!==this._time||!this._ts&&!y){w=0,_&&(l+=this._zTime=-J);break}}p=_}else{p=this._last;for(var B=i<0?i:m;p;){if(_=p._prev,(p._act||B<=p._end)&&p._ts&&w!==p){if(p.parent!==this)return this.render(i,r,a);if(p.render(p._ts>0?(B-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(B-p._start)*p._ts,r,a||me&&(p._initted||p._startAt)),m!==this._time||!this._ts&&!y){w=0,_&&(l+=this._zTime=B?-J:J);break}}p=_}}if(w&&!r&&(this.pause(),w.render(m>=s?0:-J)._zTime=m>=s?1:-1,this._ts))return this._start=D,xn(this),this.render(i,r,a);this._onUpdate&&!r&&Pe(this,"onUpdate",!0),(l===c&&this._tTime>=this.totalDuration()||!l&&s)&&(D===this._start||Math.abs(b)!==Math.abs(this._ts))&&(this._lock||((i||!u)&&(l===c&&this._ts>0||!l&&this._ts<0)&&at(this,1),!r&&!(i<0&&!s)&&(l||s||!c)&&(Pe(this,l===c&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(l<c&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(i,r){var a=this;if(qe(r)||(r=Le(this,r,i)),!(i instanceof Xt)){if(pe(i))return i.forEach(function(s){return a.add(s,r)}),this;if(ce(i))return this.addLabel(i,r);if(ie(i))i=ae.delayedCall(0,i);else return this}return this!==i?Ve(this,i,r):this},e.getChildren=function(i,r,a,s){i===void 0&&(i=!0),r===void 0&&(r=!0),a===void 0&&(a=!0),s===void 0&&(s=-Ne);for(var c=[],u=this._first;u;)u._start>=s&&(u instanceof ae?r&&c.push(u):(a&&c.push(u),i&&c.push.apply(c,u.getChildren(!0,r,a)))),u=u._next;return c},e.getById=function(i){for(var r=this.getChildren(1,1,1),a=r.length;a--;)if(r[a].vars.id===i)return r[a]},e.remove=function(i){return ce(i)?this.removeLabel(i):ie(i)?this.killTweensOf(i):(yn(this,i),i===this._recent&&(this._recent=this._last),pt(this))},e.totalTime=function(i,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=le(Ie.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),o.prototype.totalTime.call(this,i,r),this._forcing=0,this):this._tTime},e.addLabel=function(i,r){return this.labels[i]=Le(this,r),this},e.removeLabel=function(i){return delete this.labels[i],this},e.addPause=function(i,r,a){var s=ae.delayedCall(0,r||Gt,a);return s.data="isPause",this._hasPause=1,Ve(this,s,Le(this,i))},e.removePause=function(i){var r=this._first;for(i=Le(this,i);r;)r._start===i&&r.data==="isPause"&&at(r),r=r._next},e.killTweensOf=function(i,r,a){for(var s=this.getTweensOf(i,a),c=s.length;c--;)et!==s[c]&&s[c].kill(i,r);return this},e.getTweensOf=function(i,r){for(var a=[],s=$e(i),c=this._first,u=qe(r),l;c;)c instanceof ae?Ka(c._targets,s)&&(u?(!et||c._initted&&c._ts)&&c.globalTime(0)<=r&&c.globalTime(c.totalDuration())>r:!r||c.isActive())&&a.push(c):(l=c.getTweensOf(s,r)).length&&a.push.apply(a,l),c=c._next;return a},e.tweenTo=function(i,r){r=r||{};var a=this,s=Le(a,i),c=r,u=c.startAt,l=c.onStart,f=c.onStartParams,m=c.immediateRender,p,_=ae.to(a,Be({ease:r.ease||"none",lazy:!1,immediateRender:!1,time:s,overwrite:"auto",duration:r.duration||Math.abs((s-(u&&"time"in u?u.time:a._time))/a.timeScale())||J,onStart:function(){if(a.pause(),!p){var v=r.duration||Math.abs((s-(u&&"time"in u?u.time:a._time))/a.timeScale());_._dur!==v&&Ft(_,v,0,1).render(_._time,!0,!0),p=1}l&&l.apply(_,f||[])}},r));return m?_.render(0):_},e.tweenFromTo=function(i,r,a){return this.tweenTo(r,Be({startAt:{time:Le(this,i)}},a))},e.recent=function(){return this._recent},e.nextLabel=function(i){return i===void 0&&(i=this._time),$i(this,Le(this,i))},e.previousLabel=function(i){return i===void 0&&(i=this._time),$i(this,Le(this,i),1)},e.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+J)},e.shiftChildren=function(i,r,a){a===void 0&&(a=0);for(var s=this._first,c=this.labels,u;s;)s._start>=a&&(s._start+=i,s._end+=i),s=s._next;if(r)for(u in c)c[u]>=a&&(c[u]+=i);return pt(this)},e.invalidate=function(i){var r=this._first;for(this._lock=0;r;)r.invalidate(i),r=r._next;return o.prototype.invalidate.call(this,i)},e.clear=function(i){i===void 0&&(i=!0);for(var r=this._first,a;r;)a=r._next,this.remove(r),r=a;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),pt(this)},e.totalDuration=function(i){var r=0,a=this,s=a._last,c=Ne,u,l,f;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-i:i));if(a._dirty){for(f=a.parent;s;)u=s._prev,s._dirty&&s.totalDuration(),l=s._start,l>c&&a._sort&&s._ts&&!a._lock?(a._lock=1,Ve(a,s,l-s._delay,1)._lock=0):c=l,l<0&&s._ts&&(r-=l,(!f&&!a._dp||f&&f.smoothChildTiming)&&(a._start+=l/a._ts,a._time-=l,a._tTime-=l),a.shiftChildren(-l,!1,-1/0),c=0),s._end>r&&s._ts&&(r=s._end),s=u;Ft(a,a===te&&a._time>r?a._time:r,1,1),a._dirty=0}return a._tDur},t.updateRoot=function(i){if(te._ts&&(ur(te,mn(i,te)),lr=Ie.frame),Ie.frame>=Ai){Ai+=Oe.autoSleep||120;var r=te._first;if((!r||!r._ts)&&Oe.autoSleep&&Ie._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||Ie.sleep()}}},t}(Xt);Be(ve.prototype,{_lock:0,_hasPause:0,_forcing:0});var ys=function(t,e,n,i,r,a,s){var c=new we(this._pt,t,e,0,1,$r,null,r),u=0,l=0,f,m,p,_,d,v,y,w;for(c.b=n,c.e=i,n+="",i+="",(y=~i.indexOf("random("))&&(i=Ut(i)),a&&(w=[n,i],a(w,t,e),n=w[0],i=w[1]),m=n.match(En)||[];f=En.exec(i);)_=f[0],d=i.substring(u,f.index),p?p=(p+1)%5:d.substr(-5)==="rgba("&&(p=1),_!==m[l++]&&(v=parseFloat(m[l-1])||0,c._pt={_next:c._pt,p:d||l===1?d:",",s:v,c:_.charAt(1)==="="?St(v,_)-v:parseFloat(_)-v,m:p&&p<4?Math.round:0},u=En.lastIndex);return c.c=u<i.length?i.substring(u,i.length):"",c.fp=s,(ir.test(i)||y)&&(c.e=0),this._pt=c,c},mi=function(t,e,n,i,r,a,s,c,u,l){ie(i)&&(i=i(r||0,t,a));var f=t[e],m=n!=="get"?n:ie(f)?u?t[e.indexOf("set")||!ie(t["get"+e.substr(3)])?e:"get"+e.substr(3)](u):t[e]():f,p=ie(f)?u?Ds:Rr:gi,_;if(ce(i)&&(~i.indexOf("random(")&&(i=Ut(i)),i.charAt(1)==="="&&(_=St(m,i)+(he(m)||0),(_||_===0)&&(i=_))),!l||m!==i||Zn)return!isNaN(m*i)&&i!==""?(_=new we(this._pt,t,e,+m||0,i-(m||0),typeof f=="boolean"?Ss:Nr,0,p),u&&(_.fp=u),s&&_.modifier(s,this,t),this._pt=_):(!f&&!(e in t)&&ui(e,i),ys.call(this,t,e,m,i,p,c||Oe.stringFilter,u))},xs=function(t,e,n,i,r){if(ie(t)&&(t=Vt(t,r,e,n,i)),!Ge(t)||t.style&&t.nodeType||pe(t)||tr(t))return ce(t)?Vt(t,r,e,n,i):t;var a={},s;for(s in t)a[s]=Vt(t[s],r,e,n,i);return a},Fr=function(t,e,n,i,r,a){var s,c,u,l;if(Te[t]&&(s=new Te[t]).init(r,s.rawVars?e[t]:xs(e[t],i,r,a,n),n,i,a)!==!1&&(n._pt=c=new we(n._pt,r,t,0,1,s.render,s,0,s.priority),n!==Ct))for(u=n._ptLookup[n._targets.indexOf(r)],l=s._props.length;l--;)u[s._props[l]]=c;return s},et,Zn,pi=function o(t,e,n){var i=t.vars,r=i.ease,a=i.startAt,s=i.immediateRender,c=i.lazy,u=i.onUpdate,l=i.runBackwards,f=i.yoyoEase,m=i.keyframes,p=i.autoRevert,_=t._dur,d=t._startAt,v=t._targets,y=t.parent,w=y&&y.data==="nested"?y.vars.targets:v,b=t._overwrite==="auto"&&!si,D=t.timeline,k,C,T,I,E,B,j,P,A,V,G,S,F;if(D&&(!m||!r)&&(r="none"),t._ease=gt(r,Pt.ease),t._yEase=f?Tr(gt(f===!0?r:f,Pt.ease)):0,f&&t._yoyo&&!t._repeat&&(f=t._yEase,t._yEase=t._ease,t._ease=f),t._from=!D&&!!i.runBackwards,!D||m&&!i.stagger){if(P=v[0]?mt(v[0]).harness:0,S=P&&i[P.prop],k=hn(i,fi),d&&(d._zTime<0&&d.progress(1),e<0&&l&&s&&!p?d.render(-1,!0):d.revert(l&&_?ln:Xa),d._lazy=0),a){if(at(t._startAt=ae.set(v,Be({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!d&&xe(c),startAt:null,delay:0,onUpdate:u&&function(){return Pe(t,"onUpdate")},stagger:0},a))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(me||!s&&!p)&&t._startAt.revert(ln),s&&_&&e<=0&&n<=0){e&&(t._zTime=e);return}}else if(l&&_&&!d){if(e&&(s=!1),T=Be({overwrite:!1,data:"isFromStart",lazy:s&&!d&&xe(c),immediateRender:s,stagger:0,parent:y},k),S&&(T[P.prop]=S),at(t._startAt=ae.set(v,T)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(me?t._startAt.revert(ln):t._startAt.render(-1,!0)),t._zTime=e,!s)o(t._startAt,J,J);else if(!e)return}for(t._pt=t._ptCache=0,c=_&&xe(c)||c&&!_,C=0;C<v.length;C++){if(E=v[C],j=E._gsap||hi(v)[C]._gsap,t._ptLookup[C]=V={},Wn[j.id]&&it.length&&dn(),G=w===v?C:w.indexOf(E),P&&(A=new P).init(E,S||k,t,G,w)!==!1&&(t._pt=I=new we(t._pt,E,A.name,0,1,A.render,A,0,A.priority),A._props.forEach(function($){V[$]=I}),A.priority&&(B=1)),!P||S)for(T in k)Te[T]&&(A=Fr(T,k,t,G,E,w))?A.priority&&(B=1):V[T]=I=mi.call(t,E,T,"get",k[T],G,w,0,i.stringFilter);t._op&&t._op[C]&&t.kill(E,t._op[C]),b&&t._pt&&(et=t,te.killTweensOf(E,V,t.globalTime(e)),F=!t.parent,et=0),t._pt&&c&&(Wn[j.id]=1)}B&&Br(t),t._onInit&&t._onInit(t)}t._onUpdate=u,t._initted=(!t._op||t._pt)&&!F,m&&e<=0&&D.render(Ne,!0,!0)},bs=function(t,e,n,i,r,a,s,c){var u=(t._pt&&t._ptCache||(t._ptCache={}))[e],l,f,m,p;if(!u)for(u=t._ptCache[e]=[],m=t._ptLookup,p=t._targets.length;p--;){if(l=m[p][e],l&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return Zn=1,t.vars[e]="+=0",pi(t,s),Zn=0,c?jt(e+" not eligible for reset"):1;u.push(l)}for(p=u.length;p--;)f=u[p],l=f._pt||f,l.s=(i||i===0)&&!r?i:l.s+(i||0)+a*l.c,l.c=n-l.s,f.e&&(f.e=re(n)+he(f.e)),f.b&&(f.b=l.s+he(f.b))},ws=function(t,e){var n=t[0]?mt(t[0]).harness:0,i=n&&n.aliases,r,a,s,c;if(!i)return e;r=_t({},e);for(a in i)if(a in r)for(c=i[a].split(","),s=c.length;s--;)r[c[s]]=r[a];return r},Ms=function(t,e,n,i){var r=e.ease||i||"power1.inOut",a,s;if(pe(e))s=n[t]||(n[t]=[]),e.forEach(function(c,u){return s.push({t:u/(e.length-1)*100,v:c,e:r})});else for(a in e)s=n[a]||(n[a]=[]),a==="ease"||s.push({t:parseFloat(t),v:e[a],e:r})},Vt=function(t,e,n,i,r){return ie(t)?t.call(e,n,i,r):ce(t)&&~t.indexOf("random(")?Ut(t):t},Ar=di+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Lr={};be(Ar+",id,stagger,delay,duration,paused,scrollTrigger",function(o){return Lr[o]=1});var ae=function(o){Zi(t,o);function t(n,i,r,a){var s;typeof i=="number"&&(r.duration=i,i=r,r=null),s=o.call(this,a?i:Yt(i))||this;var c=s.vars,u=c.duration,l=c.delay,f=c.immediateRender,m=c.stagger,p=c.overwrite,_=c.keyframes,d=c.defaults,v=c.scrollTrigger,y=c.yoyoEase,w=i.parent||te,b=(pe(n)||tr(n)?qe(n[0]):"length"in i)?[n]:$e(n),D,k,C,T,I,E,B,j;if(s._targets=b.length?hi(b):jt("GSAP target "+n+" not found. https://gsap.com",!Oe.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=p,_||m||an(u)||an(l)){if(i=s.vars,D=s.timeline=new ve({data:"nested",defaults:d||{},targets:w&&w.data==="nested"?w.vars.targets:b}),D.kill(),D.parent=D._dp=We(s),D._start=0,m||an(u)||an(l)){if(T=b.length,B=m&&yr(m),Ge(m))for(I in m)~Ar.indexOf(I)&&(j||(j={}),j[I]=m[I]);for(k=0;k<T;k++)C=hn(i,Lr),C.stagger=0,y&&(C.yoyoEase=y),j&&_t(C,j),E=b[k],C.duration=+Vt(u,We(s),k,E,b),C.delay=(+Vt(l,We(s),k,E,b)||0)-s._delay,!m&&T===1&&C.delay&&(s._delay=l=C.delay,s._start+=l,C.delay=0),D.to(E,C,B?B(k,E,b):0),D._ease=X.none;D.duration()?u=l=0:s.timeline=0}else if(_){Yt(Be(D.vars.defaults,{ease:"none"})),D._ease=gt(_.ease||i.ease||"none");var P=0,A,V,G;if(pe(_))_.forEach(function(S){return D.to(b,S,">")}),D.duration();else{C={};for(I in _)I==="ease"||I==="easeEach"||Ms(I,_[I],C,_.easeEach);for(I in C)for(A=C[I].sort(function(S,F){return S.t-F.t}),P=0,k=0;k<A.length;k++)V=A[k],G={ease:V.e,duration:(V.t-(k?A[k-1].t:0))/100*u},G[I]=V.v,D.to(b,G,P),P+=G.duration;D.duration()<u&&D.to({},{duration:u-D.duration()})}}u||s.duration(u=D.duration())}else s.timeline=0;return p===!0&&!si&&(et=We(s),te.killTweensOf(b),et=0),Ve(w,We(s),r),i.reversed&&s.reverse(),i.paused&&s.paused(!0),(f||!u&&!_&&s._start===le(w._time)&&xe(f)&&es(We(s))&&w.data!=="nested")&&(s._tTime=-J,s.render(Math.max(0,-l)||0)),v&&pr(We(s),v),s}var e=t.prototype;return e.render=function(i,r,a){var s=this._time,c=this._tDur,u=this._dur,l=i<0,f=i>c-J&&!l?c:i<J?0:i,m,p,_,d,v,y,w,b,D;if(!u)ns(this,i,r,a);else if(f!==this._tTime||!i||a||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==l){if(m=f,b=this.timeline,this._repeat){if(d=u+this._rDelay,this._repeat<-1&&l)return this.totalTime(d*100+i,r,a);if(m=le(f%d),f===c?(_=this._repeat,m=u):(_=~~(f/d),_&&_===le(f/d)&&(m=u,_--),m>u&&(m=u)),y=this._yoyo&&_&1,y&&(D=this._yEase,m=u-m),v=Ot(this._tTime,d),m===s&&!a&&this._initted&&_===v)return this._tTime=f,this;_!==v&&(b&&this._yEase&&Ir(b,y),this.vars.repeatRefresh&&!y&&!this._lock&&this._time!==d&&this._initted&&(this._lock=a=1,this.render(le(d*_),!0).invalidate()._lock=0))}if(!this._initted){if(gr(this,l?i:m,a,r,f))return this._tTime=0,this;if(s!==this._time&&!(a&&this.vars.repeatRefresh&&_!==v))return this;if(u!==this._dur)return this.render(i,r,a)}if(this._tTime=f,this._time=m,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=w=(D||this._ease)(m/u),this._from&&(this.ratio=w=1-w),m&&!s&&!r&&!_&&(Pe(this,"onStart"),this._tTime!==f))return this;for(p=this._pt;p;)p.r(w,p.d),p=p._next;b&&b.render(i<0?i:b._dur*b._ease(m/this._dur),r,a)||this._startAt&&(this._zTime=i),this._onUpdate&&!r&&(l&&Xn(this,i,r,a),Pe(this,"onUpdate")),this._repeat&&_!==v&&this.vars.onRepeat&&!r&&this.parent&&Pe(this,"onRepeat"),(f===this._tDur||!f)&&this._tTime===f&&(l&&!this._onUpdate&&Xn(this,i,!0,!0),(i||!u)&&(f===this._tDur&&this._ts>0||!f&&this._ts<0)&&at(this,1),!r&&!(l&&!s)&&(f||s||y)&&(Pe(this,f===c?"onComplete":"onReverseComplete",!0),this._prom&&!(f<c&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),o.prototype.invalidate.call(this,i)},e.resetTo=function(i,r,a,s,c){Wt||Ie.wake(),this._ts||this.play();var u=Math.min(this._dur,(this._dp._time-this._start)*this._ts),l;return this._initted||pi(this,u),l=this._ease(u/this._dur),bs(this,i,r,a,s,l,u,c)?this.resetTo(i,r,a,s,1):(bn(this,0),this.parent||hr(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(i,r){if(r===void 0&&(r="all"),!i&&(!r||r==="all"))return this._lazy=this._pt=0,this.parent?$t(this):this;if(this.timeline){var a=this.timeline.totalDuration();return this.timeline.killTweensOf(i,r,et&&et.vars.overwrite!==!0)._first||$t(this),this.parent&&a!==this.timeline.totalDuration()&&Ft(this,this._dur*this.timeline._tDur/a,0,1),this}var s=this._targets,c=i?$e(i):s,u=this._ptLookup,l=this._pt,f,m,p,_,d,v,y;if((!r||r==="all")&&Ja(s,c))return r==="all"&&(this._pt=0),$t(this);for(f=this._op=this._op||[],r!=="all"&&(ce(r)&&(d={},be(r,function(w){return d[w]=1}),r=d),r=ws(s,r)),y=s.length;y--;)if(~c.indexOf(s[y])){m=u[y],r==="all"?(f[y]=r,_=m,p={}):(p=f[y]=f[y]||{},_=r);for(d in _)v=m&&m[d],v&&((!("kill"in v.d)||v.d.kill(d)===!0)&&yn(this,v,"_pt"),delete m[d]),p!=="all"&&(p[d]=1)}return this._initted&&!this._pt&&l&&$t(this),this},t.to=function(i,r){return new t(i,r,arguments[2])},t.from=function(i,r){return Ht(1,arguments)},t.delayedCall=function(i,r,a,s){return new t(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:r,onReverseComplete:r,onCompleteParams:a,onReverseCompleteParams:a,callbackScope:s})},t.fromTo=function(i,r,a){return Ht(2,arguments)},t.set=function(i,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new t(i,r)},t.killTweensOf=function(i,r,a){return te.killTweensOf(i,r,a)},t}(Xt);Be(ae.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});be("staggerTo,staggerFrom,staggerFromTo",function(o){ae[o]=function(){var t=new ve,e=Kn.call(arguments,0);return e.splice(o==="staggerFromTo"?5:4,0,0),t[o].apply(t,e)}});var gi=function(t,e,n){return t[e]=n},Rr=function(t,e,n){return t[e](n)},Ds=function(t,e,n,i){return t[e](i.fp,n)},Cs=function(t,e,n){return t.setAttribute(e,n)},vi=function(t,e){return ie(t[e])?Rr:oi(t[e])&&t.setAttribute?Cs:gi},Nr=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},Ss=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},$r=function(t,e){var n=e._pt,i="";if(!t&&e.b)i=e.b;else if(t===1&&e.e)i=e.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*t):Math.round((n.s+n.c*t)*1e4)/1e4)+i,n=n._next;i+=e.c}e.set(e.t,e.p,i,e)},_i=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},ks=function(t,e,n,i){for(var r=this._pt,a;r;)a=r._next,r.p===i&&r.modifier(t,e,n),r=a},Es=function(t){for(var e=this._pt,n,i;e;)i=e._next,e.p===t&&!e.op||e.op===t?yn(this,e,"_pt"):e.dep||(n=1),e=i;return!n},Ts=function(t,e,n,i){i.mSet(t,e,i.m.call(i.tween,n,i.mt),i)},Br=function(t){for(var e=t._pt,n,i,r,a;e;){for(n=e._next,i=r;i&&i.pr>e.pr;)i=i._next;(e._prev=i?i._prev:a)?e._prev._next=e:r=e,(e._next=i)?i._prev=e:a=e,e=n}t._pt=r},we=function(){function o(e,n,i,r,a,s,c,u,l){this.t=n,this.s=r,this.c=a,this.p=i,this.r=s||Nr,this.d=c||this,this.set=u||gi,this.pr=l||0,this._next=e,e&&(e._prev=this)}var t=o.prototype;return t.modifier=function(n,i,r){this.mSet=this.mSet||this.set,this.set=Ts,this.m=n,this.mt=r,this.tween=i},o}();be(di+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(o){return fi[o]=1});Fe.TweenMax=Fe.TweenLite=ae;Fe.TimelineLite=Fe.TimelineMax=ve;te=new ve({sortChildren:!1,defaults:Pt,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Oe.stringFilter=Er;var vt=[],un={},Is=[],Yi=0,Ps=0,Fn=function(t){return(un[t]||Is).map(function(e){return e()})},ei=function(){var t=Date.now(),e=[];t-Yi>2&&(Fn("matchMediaInit"),vt.forEach(function(n){var i=n.queries,r=n.conditions,a,s,c,u;for(s in i)a=He.matchMedia(i[s]).matches,a&&(c=1),a!==r[s]&&(r[s]=a,u=1);u&&(n.revert(),c&&e.push(n))}),Fn("matchMediaRevert"),e.forEach(function(n){return n.onMatch(n,function(i){return n.add(null,i)})}),Yi=t,Fn("matchMedia"))},Yr=function(){function o(e,n){this.selector=n&&Qn(n),this.data=[],this._r=[],this.isReverted=!1,this.id=Ps++,e&&this.add(e)}var t=o.prototype;return t.add=function(n,i,r){ie(n)&&(r=i,i=n,n=ie);var a=this,s=function(){var u=Z,l=a.selector,f;return u&&u!==a&&u.data.push(a),r&&(a.selector=Qn(r)),Z=a,f=i.apply(a,arguments),ie(f)&&a._r.push(f),Z=u,a.selector=l,a.isReverted=!1,f};return a.last=s,n===ie?s(a,function(c){return a.add(null,c)}):n?a[n]=s:s},t.ignore=function(n){var i=Z;Z=null,n(this),Z=i},t.getTweens=function(){var n=[];return this.data.forEach(function(i){return i instanceof o?n.push.apply(n,i.getTweens()):i instanceof ae&&!(i.parent&&i.parent.data==="nested")&&n.push(i)}),n},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(n,i){var r=this;if(n?function(){for(var s=r.getTweens(),c=r.data.length,u;c--;)u=r.data[c],u.data==="isFlip"&&(u.revert(),u.getChildren(!0,!0,!1).forEach(function(l){return s.splice(s.indexOf(l),1)}));for(s.map(function(l){return{g:l._dur||l._delay||l._sat&&!l._sat.vars.immediateRender?l.globalTime(0):-1/0,t:l}}).sort(function(l,f){return f.g-l.g||-1/0}).forEach(function(l){return l.t.revert(n)}),c=r.data.length;c--;)u=r.data[c],u instanceof ve?u.data!=="nested"&&(u.scrollTrigger&&u.scrollTrigger.revert(),u.kill()):!(u instanceof ae)&&u.revert&&u.revert(n);r._r.forEach(function(l){return l(n,r)}),r.isReverted=!0}():this.data.forEach(function(s){return s.kill&&s.kill()}),this.clear(),i)for(var a=vt.length;a--;)vt[a].id===this.id&&vt.splice(a,1)},t.revert=function(n){this.kill(n||{})},o}(),Os=function(){function o(e){this.contexts=[],this.scope=e,Z&&Z.data.push(this)}var t=o.prototype;return t.add=function(n,i,r){Ge(n)||(n={matches:n});var a=new Yr(0,r||this.scope),s=a.conditions={},c,u,l;Z&&!a.selector&&(a.selector=Z.selector),this.contexts.push(a),i=a.add("onMatch",i),a.queries=n;for(u in n)u==="all"?l=1:(c=He.matchMedia(n[u]),c&&(vt.indexOf(a)<0&&vt.push(a),(s[u]=c.matches)&&(l=1),c.addListener?c.addListener(ei):c.addEventListener("change",ei)));return l&&i(a,function(f){return a.add(null,f)}),this},t.revert=function(n){this.kill(n||{})},t.kill=function(n){this.contexts.forEach(function(i){return i.kill(n,!0)})},o}(),pn={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(function(i){return Cr(i)})},timeline:function(t){return new ve(t)},getTweensOf:function(t,e){return te.getTweensOf(t,e)},getProperty:function(t,e,n,i){ce(t)&&(t=$e(t)[0]);var r=mt(t||{}).get,a=n?dr:fr;return n==="native"&&(n=""),t&&(e?a((Te[e]&&Te[e].get||r)(t,e,n,i)):function(s,c,u){return a((Te[s]&&Te[s].get||r)(t,s,c,u))})},quickSetter:function(t,e,n){if(t=$e(t),t.length>1){var i=t.map(function(l){return De.quickSetter(l,e,n)}),r=i.length;return function(l){for(var f=r;f--;)i[f](l)}}t=t[0]||{};var a=Te[e],s=mt(t),c=s.harness&&(s.harness.aliases||{})[e]||e,u=a?function(l){var f=new a;Ct._pt=0,f.init(t,n?l+n:l,Ct,0,[t]),f.render(1,f),Ct._pt&&_i(1,Ct)}:s.set(t,c);return a?u:function(l){return u(t,c,n?l+n:l,s,1)}},quickTo:function(t,e,n){var i,r=De.to(t,_t((i={},i[e]="+=0.1",i.paused=!0,i),n||{})),a=function(c,u,l){return r.resetTo(e,c,u,l)};return a.tween=r,a},isTweening:function(t){return te.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=gt(t.ease,Pt.ease)),Li(Pt,t||{})},config:function(t){return Li(Oe,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,i=t.plugins,r=t.defaults,a=t.extendTimeline;(i||"").split(",").forEach(function(s){return s&&!Te[s]&&!Fe[s]&&jt(e+" effect requires "+s+" plugin.")}),Tn[e]=function(s,c,u){return n($e(s),Be(c||{},r),u)},a&&(ve.prototype[e]=function(s,c,u){return this.add(Tn[e](s,Ge(c)?c:(u=c)&&{},this),u)})},registerEase:function(t,e){X[t]=gt(e)},parseEase:function(t,e){return arguments.length?gt(t,e):X},getById:function(t){return te.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var n=new ve(t),i,r;for(n.smoothChildTiming=xe(t.smoothChildTiming),te.remove(n),n._dp=0,n._time=n._tTime=te._time,i=te._first;i;)r=i._next,(e||!(!i._dur&&i instanceof ae&&i.vars.onComplete===i._targets[0]))&&Ve(n,i,i._start-i._delay),i=r;return Ve(te,n,0),n},context:function(t,e){return t?new Yr(t,e):Z},matchMedia:function(t){return new Os(t)},matchMediaRefresh:function(){return vt.forEach(function(t){var e=t.conditions,n,i;for(i in e)e[i]&&(e[i]=!1,n=1);n&&t.revert()})||ei()},addEventListener:function(t,e){var n=un[t]||(un[t]=[]);~n.indexOf(e)||n.push(e)},removeEventListener:function(t,e){var n=un[t],i=n&&n.indexOf(e);i>=0&&n.splice(i,1)},utils:{wrap:us,wrapYoyo:fs,distribute:yr,random:br,snap:xr,normalize:cs,getUnit:he,clamp:as,splitColor:Sr,toArray:$e,selector:Qn,mapRange:Mr,pipe:os,unitize:ls,interpolate:ds,shuffle:_r},install:sr,effects:Tn,ticker:Ie,updateRoot:ve.updateRoot,plugins:Te,globalTimeline:te,core:{PropTween:we,globals:or,Tween:ae,Timeline:ve,Animation:Xt,getCache:mt,_removeLinkedListItem:yn,reverting:function(){return me},context:function(t){return t&&Z&&(Z.data.push(t),t._ctx=Z),Z},suppressOverwrites:function(t){return si=t}}};be("to,from,fromTo,delayedCall,set,killTweensOf",function(o){return pn[o]=ae[o]});Ie.add(ve.updateRoot);Ct=pn.to({},{duration:0});var Fs=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},As=function(t,e){var n=t._targets,i,r,a;for(i in e)for(r=n.length;r--;)a=t._ptLookup[r][i],a&&(a=a.d)&&(a._pt&&(a=Fs(a,i)),a&&a.modifier&&a.modifier(e[i],t,n[r],i))},An=function(t,e){return{name:t,rawVars:1,init:function(i,r,a){a._onInit=function(s){var c,u;if(ce(r)&&(c={},be(r,function(l){return c[l]=1}),r=c),e){c={};for(u in r)c[u]=e(r[u]);r=c}As(s,r)}}}},De=pn.registerPlugin({name:"attr",init:function(t,e,n,i,r){var a,s,c;this.tween=n;for(a in e)c=t.getAttribute(a)||"",s=this.add(t,"setAttribute",(c||0)+"",e[a],i,r,0,0,a),s.op=a,s.b=c,this._props.push(a)},render:function(t,e){for(var n=e._pt;n;)me?n.set(n.t,n.p,n.b,n):n.r(t,n.d),n=n._next}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n],0,0,0,0,0,1)}},An("roundProps",Jn),An("modifiers"),An("snap",xr))||pn;ae.version=ve.version=De.version="3.12.5";ar=1;li()&&At();X.Power0;X.Power1;X.Power2;X.Power3;X.Power4;X.Linear;X.Quad;X.Cubic;X.Quart;X.Quint;X.Strong;X.Elastic;X.Back;X.SteppedEase;X.Bounce;X.Sine;X.Expo;X.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Hi,tt,kt,yi,dt,Vi,xi,Ls=function(){return typeof window<"u"},Ke={},ut=180/Math.PI,Et=Math.PI/180,Mt=Math.atan2,zi=1e8,bi=/([A-Z])/g,Rs=/(left|right|width|margin|padding|x)/i,Ns=/[\s,\(]\S/,ze={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ti=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},$s=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},Bs=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},Ys=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},Hr=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},Vr=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},Hs=function(t,e,n){return t.style[e]=n},Vs=function(t,e,n){return t.style.setProperty(e,n)},zs=function(t,e,n){return t._gsap[e]=n},js=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},Gs=function(t,e,n,i,r){var a=t._gsap;a.scaleX=a.scaleY=n,a.renderTransform(r,a)},Us=function(t,e,n,i,r){var a=t._gsap;a[e]=n,a.renderTransform(r,a)},ne="transform",Me=ne+"Origin",Ws=function o(t,e){var n=this,i=this.target,r=i.style,a=i._gsap;if(t in Ke&&r){if(this.tfm=this.tfm||{},t!=="transform")t=ze[t]||t,~t.indexOf(",")?t.split(",").forEach(function(s){return n.tfm[s]=Xe(i,s)}):this.tfm[t]=a.x?a[t]:Xe(i,t),t===Me&&(this.tfm.zOrigin=a.zOrigin);else return ze.transform.split(",").forEach(function(s){return o.call(n,s,e)});if(this.props.indexOf(ne)>=0)return;a.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(Me,e,"")),t=ne}(r||e)&&this.props.push(t,e,r[t])},zr=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},Xs=function(){var t=this.props,e=this.target,n=e.style,i=e._gsap,r,a;for(r=0;r<t.length;r+=3)t[r+1]?e[t[r]]=t[r+2]:t[r+2]?n[t[r]]=t[r+2]:n.removeProperty(t[r].substr(0,2)==="--"?t[r]:t[r].replace(bi,"-$1").toLowerCase());if(this.tfm){for(a in this.tfm)i[a]=this.tfm[a];i.svg&&(i.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),r=xi(),(!r||!r.isStart)&&!n[ne]&&(zr(n),i.zOrigin&&n[Me]&&(n[Me]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},jr=function(t,e){var n={target:t,props:[],revert:Xs,save:Ws};return t._gsap||De.core.getCache(t),e&&e.split(",").forEach(function(i){return n.save(i)}),n},Gr,ni=function(t,e){var n=tt.createElementNS?tt.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):tt.createElement(t);return n&&n.style?n:tt.createElement(t)},je=function o(t,e,n){var i=getComputedStyle(t);return i[e]||i.getPropertyValue(e.replace(bi,"-$1").toLowerCase())||i.getPropertyValue(e)||!n&&o(t,Lt(e)||e,1)||""},ji="O,Moz,ms,Ms,Webkit".split(","),Lt=function(t,e,n){var i=e||dt,r=i.style,a=5;if(t in r&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);a--&&!(ji[a]+t in r););return a<0?null:(a===3?"ms":a>=0?ji[a]:"")+t},ii=function(){Ls()&&window.document&&(Hi=window,tt=Hi.document,kt=tt.documentElement,dt=ni("div")||{style:{}},ni("div"),ne=Lt(ne),Me=ne+"Origin",dt.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Gr=!!Lt("perspective"),xi=De.core.reverting,yi=1)},Ln=function o(t){var e=ni("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,i=this.nextSibling,r=this.style.cssText,a;if(kt.appendChild(e),e.appendChild(this),this.style.display="block",t)try{a=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=o}catch{}else this._gsapBBox&&(a=this._gsapBBox());return n&&(i?n.insertBefore(this,i):n.appendChild(this)),kt.removeChild(e),this.style.cssText=r,a},Gi=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},Ur=function(t){var e;try{e=t.getBBox()}catch{e=Ln.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Ln||(e=Ln.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+Gi(t,["x","cx","x1"])||0,y:+Gi(t,["y","cy","y1"])||0,width:0,height:0}:e},Wr=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&Ur(t))},yt=function(t,e){if(e){var n=t.style,i;e in Ke&&e!==Me&&(e=ne),n.removeProperty?(i=e.substr(0,2),(i==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),n.removeProperty(i==="--"?e:e.replace(bi,"-$1").toLowerCase())):n.removeAttribute(e)}},nt=function(t,e,n,i,r,a){var s=new we(t._pt,e,n,0,1,a?Vr:Hr);return t._pt=s,s.b=i,s.e=r,t._props.push(n),s},Ui={deg:1,rad:1,turn:1},qs={grid:1,flex:1},st=function o(t,e,n,i){var r=parseFloat(n)||0,a=(n+"").trim().substr((r+"").length)||"px",s=dt.style,c=Rs.test(e),u=t.tagName.toLowerCase()==="svg",l=(u?"client":"offset")+(c?"Width":"Height"),f=100,m=i==="px",p=i==="%",_,d,v,y;if(i===a||!r||Ui[i]||Ui[a])return r;if(a!=="px"&&!m&&(r=o(t,e,n,"px")),y=t.getCTM&&Wr(t),(p||a==="%")&&(Ke[e]||~e.indexOf("adius")))return _=y?t.getBBox()[c?"width":"height"]:t[l],re(p?r/_*f:r/100*_);if(s[c?"width":"height"]=f+(m?a:i),d=~e.indexOf("adius")||i==="em"&&t.appendChild&&!u?t:t.parentNode,y&&(d=(t.ownerSVGElement||{}).parentNode),(!d||d===tt||!d.appendChild)&&(d=tt.body),v=d._gsap,v&&p&&v.width&&c&&v.time===Ie.time&&!v.uncache)return re(r/v.width*f);if(p&&(e==="height"||e==="width")){var w=t.style[e];t.style[e]=f+i,_=t[l],w?t.style[e]=w:yt(t,e)}else(p||a==="%")&&!qs[je(d,"display")]&&(s.position=je(t,"position")),d===t&&(s.position="static"),d.appendChild(dt),_=dt[l],d.removeChild(dt),s.position="absolute";return c&&p&&(v=mt(d),v.time=Ie.time,v.width=d[l]),re(m?_*r/f:_&&r?f/_*r:0)},Xe=function(t,e,n,i){var r;return yi||ii(),e in ze&&e!=="transform"&&(e=ze[e],~e.indexOf(",")&&(e=e.split(",")[0])),Ke[e]&&e!=="transform"?(r=Kt(t,i),r=e!=="transformOrigin"?r[e]:r.svg?r.origin:vn(je(t,Me))+" "+r.zOrigin+"px"):(r=t.style[e],(!r||r==="auto"||i||~(r+"").indexOf("calc("))&&(r=gn[e]&&gn[e](t,e,n)||je(t,e)||cr(t,e)||(e==="opacity"?1:0))),n&&!~(r+"").trim().indexOf(" ")?st(t,e,r,n)+n:r},Ks=function(t,e,n,i){if(!n||n==="none"){var r=Lt(e,t,1),a=r&&je(t,r,1);a&&a!==n?(e=r,n=a):e==="borderColor"&&(n=je(t,"borderTopColor"))}var s=new we(this._pt,t.style,e,0,1,$r),c=0,u=0,l,f,m,p,_,d,v,y,w,b,D,k;if(s.b=n,s.e=i,n+="",i+="",i==="auto"&&(d=t.style[e],t.style[e]=i,i=je(t,e)||i,d?t.style[e]=d:yt(t,e)),l=[n,i],Er(l),n=l[0],i=l[1],m=n.match(Dt)||[],k=i.match(Dt)||[],k.length){for(;f=Dt.exec(i);)v=f[0],w=i.substring(c,f.index),_?_=(_+1)%5:(w.substr(-5)==="rgba("||w.substr(-5)==="hsla(")&&(_=1),v!==(d=m[u++]||"")&&(p=parseFloat(d)||0,D=d.substr((p+"").length),v.charAt(1)==="="&&(v=St(p,v)+D),y=parseFloat(v),b=v.substr((y+"").length),c=Dt.lastIndex-b.length,b||(b=b||Oe.units[e]||D,c===i.length&&(i+=b,s.e+=b)),D!==b&&(p=st(t,e,d,b)||0),s._pt={_next:s._pt,p:w||u===1?w:",",s:p,c:y-p,m:_&&_<4||e==="zIndex"?Math.round:0});s.c=c<i.length?i.substring(c,i.length):""}else s.r=e==="display"&&i==="none"?Vr:Hr;return ir.test(i)&&(s.e=0),this._pt=s,s},Wi={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Qs=function(t){var e=t.split(" "),n=e[0],i=e[1]||"50%";return(n==="top"||n==="bottom"||i==="left"||i==="right")&&(t=n,n=i,i=t),e[0]=Wi[n]||n,e[1]=Wi[i]||i,e.join(" ")},Js=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n=e.t,i=n.style,r=e.u,a=n._gsap,s,c,u;if(r==="all"||r===!0)i.cssText="",c=1;else for(r=r.split(","),u=r.length;--u>-1;)s=r[u],Ke[s]&&(c=1,s=s==="transformOrigin"?Me:ne),yt(n,s);c&&(yt(n,ne),a&&(a.svg&&n.removeAttribute("transform"),Kt(n,1),a.uncache=1,zr(i)))}},gn={clearProps:function(t,e,n,i,r){if(r.data!=="isFromStart"){var a=t._pt=new we(t._pt,e,n,0,0,Js);return a.u=i,a.pr=-10,a.tween=r,t._props.push(n),1}}},qt=[1,0,0,1,0,0],Xr={},qr=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},Xi=function(t){var e=je(t,ne);return qr(e)?qt:e.substr(7).match(nr).map(re)},wi=function(t,e){var n=t._gsap||mt(t),i=t.style,r=Xi(t),a,s,c,u;return n.svg&&t.getAttribute("transform")?(c=t.transform.baseVal.consolidate().matrix,r=[c.a,c.b,c.c,c.d,c.e,c.f],r.join(",")==="1,0,0,1,0,0"?qt:r):(r===qt&&!t.offsetParent&&t!==kt&&!n.svg&&(c=i.display,i.display="block",a=t.parentNode,(!a||!t.offsetParent)&&(u=1,s=t.nextElementSibling,kt.appendChild(t)),r=Xi(t),c?i.display=c:yt(t,"display"),u&&(s?a.insertBefore(t,s):a?a.appendChild(t):kt.removeChild(t))),e&&r.length>6?[r[0],r[1],r[4],r[5],r[12],r[13]]:r)},ri=function(t,e,n,i,r,a){var s=t._gsap,c=r||wi(t,!0),u=s.xOrigin||0,l=s.yOrigin||0,f=s.xOffset||0,m=s.yOffset||0,p=c[0],_=c[1],d=c[2],v=c[3],y=c[4],w=c[5],b=e.split(" "),D=parseFloat(b[0])||0,k=parseFloat(b[1])||0,C,T,I,E;n?c!==qt&&(T=p*v-_*d)&&(I=D*(v/T)+k*(-d/T)+(d*w-v*y)/T,E=D*(-_/T)+k*(p/T)-(p*w-_*y)/T,D=I,k=E):(C=Ur(t),D=C.x+(~b[0].indexOf("%")?D/100*C.width:D),k=C.y+(~(b[1]||b[0]).indexOf("%")?k/100*C.height:k)),i||i!==!1&&s.smooth?(y=D-u,w=k-l,s.xOffset=f+(y*p+w*d)-y,s.yOffset=m+(y*_+w*v)-w):s.xOffset=s.yOffset=0,s.xOrigin=D,s.yOrigin=k,s.smooth=!!i,s.origin=e,s.originIsAbsolute=!!n,t.style[Me]="0px 0px",a&&(nt(a,s,"xOrigin",u,D),nt(a,s,"yOrigin",l,k),nt(a,s,"xOffset",f,s.xOffset),nt(a,s,"yOffset",m,s.yOffset)),t.setAttribute("data-svg-origin",D+" "+k)},Kt=function(t,e){var n=t._gsap||new Or(t);if("x"in n&&!e&&!n.uncache)return n;var i=t.style,r=n.scaleX<0,a="px",s="deg",c=getComputedStyle(t),u=je(t,Me)||"0",l,f,m,p,_,d,v,y,w,b,D,k,C,T,I,E,B,j,P,A,V,G,S,F,$,z,Y,oe,ue,Qe,_e,fe;return l=f=m=d=v=y=w=b=D=0,p=_=1,n.svg=!!(t.getCTM&&Wr(t)),c.translate&&((c.translate!=="none"||c.scale!=="none"||c.rotate!=="none")&&(i[ne]=(c.translate!=="none"?"translate3d("+(c.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(c.rotate!=="none"?"rotate("+c.rotate+") ":"")+(c.scale!=="none"?"scale("+c.scale.split(" ").join(",")+") ":"")+(c[ne]!=="none"?c[ne]:"")),i.scale=i.rotate=i.translate="none"),T=wi(t,n.svg),n.svg&&(n.uncache?($=t.getBBox(),u=n.xOrigin-$.x+"px "+(n.yOrigin-$.y)+"px",F=""):F=!e&&t.getAttribute("data-svg-origin"),ri(t,F||u,!!F||n.originIsAbsolute,n.smooth!==!1,T)),k=n.xOrigin||0,C=n.yOrigin||0,T!==qt&&(j=T[0],P=T[1],A=T[2],V=T[3],l=G=T[4],f=S=T[5],T.length===6?(p=Math.sqrt(j*j+P*P),_=Math.sqrt(V*V+A*A),d=j||P?Mt(P,j)*ut:0,w=A||V?Mt(A,V)*ut+d:0,w&&(_*=Math.abs(Math.cos(w*Et))),n.svg&&(l-=k-(k*j+C*A),f-=C-(k*P+C*V))):(fe=T[6],Qe=T[7],Y=T[8],oe=T[9],ue=T[10],_e=T[11],l=T[12],f=T[13],m=T[14],I=Mt(fe,ue),v=I*ut,I&&(E=Math.cos(-I),B=Math.sin(-I),F=G*E+Y*B,$=S*E+oe*B,z=fe*E+ue*B,Y=G*-B+Y*E,oe=S*-B+oe*E,ue=fe*-B+ue*E,_e=Qe*-B+_e*E,G=F,S=$,fe=z),I=Mt(-A,ue),y=I*ut,I&&(E=Math.cos(-I),B=Math.sin(-I),F=j*E-Y*B,$=P*E-oe*B,z=A*E-ue*B,_e=V*B+_e*E,j=F,P=$,A=z),I=Mt(P,j),d=I*ut,I&&(E=Math.cos(I),B=Math.sin(I),F=j*E+P*B,$=G*E+S*B,P=P*E-j*B,S=S*E-G*B,j=F,G=$),v&&Math.abs(v)+Math.abs(d)>359.9&&(v=d=0,y=180-y),p=re(Math.sqrt(j*j+P*P+A*A)),_=re(Math.sqrt(S*S+fe*fe)),I=Mt(G,S),w=Math.abs(I)>2e-4?I*ut:0,D=_e?1/(_e<0?-_e:_e):0),n.svg&&(F=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!qr(je(t,ne)),F&&t.setAttribute("transform",F))),Math.abs(w)>90&&Math.abs(w)<270&&(r?(p*=-1,w+=d<=0?180:-180,d+=d<=0?180:-180):(_*=-1,w+=w<=0?180:-180)),e=e||n.uncache,n.x=l-((n.xPercent=l&&(!e&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-l)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+a,n.y=f-((n.yPercent=f&&(!e&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-f)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+a,n.z=m+a,n.scaleX=re(p),n.scaleY=re(_),n.rotation=re(d)+s,n.rotationX=re(v)+s,n.rotationY=re(y)+s,n.skewX=w+s,n.skewY=b+s,n.transformPerspective=D+a,(n.zOrigin=parseFloat(u.split(" ")[2])||!e&&n.zOrigin||0)&&(i[Me]=vn(u)),n.xOffset=n.yOffset=0,n.force3D=Oe.force3D,n.renderTransform=n.svg?eo:Gr?Kr:Zs,n.uncache=0,n},vn=function(t){return(t=t.split(" "))[0]+" "+t[1]},Rn=function(t,e,n){var i=he(e);return re(parseFloat(e)+parseFloat(st(t,"x",n+"px",i)))+i},Zs=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Kr(t,e)},lt="0deg",Nt="0px",ct=") ",Kr=function(t,e){var n=e||this,i=n.xPercent,r=n.yPercent,a=n.x,s=n.y,c=n.z,u=n.rotation,l=n.rotationY,f=n.rotationX,m=n.skewX,p=n.skewY,_=n.scaleX,d=n.scaleY,v=n.transformPerspective,y=n.force3D,w=n.target,b=n.zOrigin,D="",k=y==="auto"&&t&&t!==1||y===!0;if(b&&(f!==lt||l!==lt)){var C=parseFloat(l)*Et,T=Math.sin(C),I=Math.cos(C),E;C=parseFloat(f)*Et,E=Math.cos(C),a=Rn(w,a,T*E*-b),s=Rn(w,s,-Math.sin(C)*-b),c=Rn(w,c,I*E*-b+b)}v!==Nt&&(D+="perspective("+v+ct),(i||r)&&(D+="translate("+i+"%, "+r+"%) "),(k||a!==Nt||s!==Nt||c!==Nt)&&(D+=c!==Nt||k?"translate3d("+a+", "+s+", "+c+") ":"translate("+a+", "+s+ct),u!==lt&&(D+="rotate("+u+ct),l!==lt&&(D+="rotateY("+l+ct),f!==lt&&(D+="rotateX("+f+ct),(m!==lt||p!==lt)&&(D+="skew("+m+", "+p+ct),(_!==1||d!==1)&&(D+="scale("+_+", "+d+ct),w.style[ne]=D||"translate(0, 0)"},eo=function(t,e){var n=e||this,i=n.xPercent,r=n.yPercent,a=n.x,s=n.y,c=n.rotation,u=n.skewX,l=n.skewY,f=n.scaleX,m=n.scaleY,p=n.target,_=n.xOrigin,d=n.yOrigin,v=n.xOffset,y=n.yOffset,w=n.forceCSS,b=parseFloat(a),D=parseFloat(s),k,C,T,I,E;c=parseFloat(c),u=parseFloat(u),l=parseFloat(l),l&&(l=parseFloat(l),u+=l,c+=l),c||u?(c*=Et,u*=Et,k=Math.cos(c)*f,C=Math.sin(c)*f,T=Math.sin(c-u)*-m,I=Math.cos(c-u)*m,u&&(l*=Et,E=Math.tan(u-l),E=Math.sqrt(1+E*E),T*=E,I*=E,l&&(E=Math.tan(l),E=Math.sqrt(1+E*E),k*=E,C*=E)),k=re(k),C=re(C),T=re(T),I=re(I)):(k=f,I=m,C=T=0),(b&&!~(a+"").indexOf("px")||D&&!~(s+"").indexOf("px"))&&(b=st(p,"x",a,"px"),D=st(p,"y",s,"px")),(_||d||v||y)&&(b=re(b+_-(_*k+d*T)+v),D=re(D+d-(_*C+d*I)+y)),(i||r)&&(E=p.getBBox(),b=re(b+i/100*E.width),D=re(D+r/100*E.height)),E="matrix("+k+","+C+","+T+","+I+","+b+","+D+")",p.setAttribute("transform",E),w&&(p.style[ne]=E)},to=function(t,e,n,i,r){var a=360,s=ce(r),c=parseFloat(r)*(s&&~r.indexOf("rad")?ut:1),u=c-i,l=i+u+"deg",f,m;return s&&(f=r.split("_")[1],f==="short"&&(u%=a,u!==u%(a/2)&&(u+=u<0?a:-a)),f==="cw"&&u<0?u=(u+a*zi)%a-~~(u/a)*a:f==="ccw"&&u>0&&(u=(u-a*zi)%a-~~(u/a)*a)),t._pt=m=new we(t._pt,e,n,i,u,$s),m.e=l,m.u="deg",t._props.push(n),m},qi=function(t,e){for(var n in e)t[n]=e[n];return t},no=function(t,e,n){var i=qi({},n._gsap),r="perspective,force3D,transformOrigin,svgOrigin",a=n.style,s,c,u,l,f,m,p,_;i.svg?(u=n.getAttribute("transform"),n.setAttribute("transform",""),a[ne]=e,s=Kt(n,1),yt(n,ne),n.setAttribute("transform",u)):(u=getComputedStyle(n)[ne],a[ne]=e,s=Kt(n,1),a[ne]=u);for(c in Ke)u=i[c],l=s[c],u!==l&&r.indexOf(c)<0&&(p=he(u),_=he(l),f=p!==_?st(n,c,u,_):parseFloat(u),m=parseFloat(l),t._pt=new we(t._pt,s,c,f,m-f,ti),t._pt.u=_||0,t._props.push(c));qi(s,i)};be("padding,margin,Width,Radius",function(o,t){var e="Top",n="Right",i="Bottom",r="Left",a=(t<3?[e,n,i,r]:[e+r,e+n,i+n,i+r]).map(function(s){return t<2?o+s:"border"+s+o});gn[t>1?"border"+o:o]=function(s,c,u,l,f){var m,p;if(arguments.length<4)return m=a.map(function(_){return Xe(s,_,u)}),p=m.join(" "),p.split(m[0]).length===5?m[0]:p;m=(l+"").split(" "),p={},a.forEach(function(_,d){return p[_]=m[d]=m[d]||m[(d-1)/2|0]}),s.init(c,p,f)}});var Qr={name:"css",register:ii,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,i,r){var a=this._props,s=t.style,c=n.vars.startAt,u,l,f,m,p,_,d,v,y,w,b,D,k,C,T,I;yi||ii(),this.styles=this.styles||jr(t),I=this.styles.props,this.tween=n;for(d in e)if(d!=="autoRound"&&(l=e[d],!(Te[d]&&Fr(d,e,n,i,t,r)))){if(p=typeof l,_=gn[d],p==="function"&&(l=l.call(n,i,t,r),p=typeof l),p==="string"&&~l.indexOf("random(")&&(l=Ut(l)),_)_(this,t,d,l,n)&&(T=1);else if(d.substr(0,2)==="--")u=(getComputedStyle(t).getPropertyValue(d)+"").trim(),l+="",rt.lastIndex=0,rt.test(u)||(v=he(u),y=he(l)),y?v!==y&&(u=st(t,d,u,y)+y):v&&(l+=v),this.add(s,"setProperty",u,l,i,r,0,0,d),a.push(d),I.push(d,0,s[d]);else if(p!=="undefined"){if(c&&d in c?(u=typeof c[d]=="function"?c[d].call(n,i,t,r):c[d],ce(u)&&~u.indexOf("random(")&&(u=Ut(u)),he(u+"")||u==="auto"||(u+=Oe.units[d]||he(Xe(t,d))||""),(u+"").charAt(1)==="="&&(u=Xe(t,d))):u=Xe(t,d),m=parseFloat(u),w=p==="string"&&l.charAt(1)==="="&&l.substr(0,2),w&&(l=l.substr(2)),f=parseFloat(l),d in ze&&(d==="autoAlpha"&&(m===1&&Xe(t,"visibility")==="hidden"&&f&&(m=0),I.push("visibility",0,s.visibility),nt(this,s,"visibility",m?"inherit":"hidden",f?"inherit":"hidden",!f)),d!=="scale"&&d!=="transform"&&(d=ze[d],~d.indexOf(",")&&(d=d.split(",")[0]))),b=d in Ke,b){if(this.styles.save(d),D||(k=t._gsap,k.renderTransform&&!e.parseTransform||Kt(t,e.parseTransform),C=e.smoothOrigin!==!1&&k.smooth,D=this._pt=new we(this._pt,s,ne,0,1,k.renderTransform,k,0,-1),D.dep=1),d==="scale")this._pt=new we(this._pt,k,"scaleY",k.scaleY,(w?St(k.scaleY,w+f):f)-k.scaleY||0,ti),this._pt.u=0,a.push("scaleY",d),d+="X";else if(d==="transformOrigin"){I.push(Me,0,s[Me]),l=Qs(l),k.svg?ri(t,l,0,C,0,this):(y=parseFloat(l.split(" ")[2])||0,y!==k.zOrigin&&nt(this,k,"zOrigin",k.zOrigin,y),nt(this,s,d,vn(u),vn(l)));continue}else if(d==="svgOrigin"){ri(t,l,1,C,0,this);continue}else if(d in Xr){to(this,k,d,m,w?St(m,w+l):l);continue}else if(d==="smoothOrigin"){nt(this,k,"smooth",k.smooth,l);continue}else if(d==="force3D"){k[d]=l;continue}else if(d==="transform"){no(this,l,t);continue}}else d in s||(d=Lt(d)||d);if(b||(f||f===0)&&(m||m===0)&&!Ns.test(l)&&d in s)v=(u+"").substr((m+"").length),f||(f=0),y=he(l)||(d in Oe.units?Oe.units[d]:v),v!==y&&(m=st(t,d,u,y)),this._pt=new we(this._pt,b?k:s,d,m,(w?St(m,w+f):f)-m,!b&&(y==="px"||d==="zIndex")&&e.autoRound!==!1?Ys:ti),this._pt.u=y||0,v!==y&&y!=="%"&&(this._pt.b=u,this._pt.r=Bs);else if(d in s)Ks.call(this,t,d,u,w?w+l:l);else if(d in t)this.add(t,d,u||t[d],w?w+l:l,i,r);else if(d!=="parseTransform"){ui(d,l);continue}b||(d in s?I.push(d,0,s[d]):I.push(d,1,u||t[d])),a.push(d)}}T&&Br(this)},render:function(t,e){if(e.tween._time||!xi())for(var n=e._pt;n;)n.r(t,n.d),n=n._next;else e.styles.revert()},get:Xe,aliases:ze,getSetter:function(t,e,n){var i=ze[e];return i&&i.indexOf(",")<0&&(e=i),e in Ke&&e!==Me&&(t._gsap.x||Xe(t,"x"))?n&&Vi===n?e==="scale"?js:zs:(Vi=n||{})&&(e==="scale"?Gs:Us):t.style&&!oi(t.style[e])?Hs:~e.indexOf("-")?Vs:vi(t,e)},core:{_removeProperty:yt,_getMatrix:wi}};De.utils.checkPrefix=Lt;De.core.getStyleSaver=jr;(function(o,t,e,n){var i=be(o+","+t+","+e,function(r){Ke[r]=1});be(t,function(r){Oe.units[r]="deg",Xr[r]=1}),ze[i[13]]=o+","+t,be(n,function(r){var a=r.split(":");ze[a[1]]=i[a[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");be("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(o){Oe.units[o]="px"});De.registerPlugin(Qr);var ke=De.registerPlugin(Qr)||De;ke.core.Tween;const Ze=class Ze extends Oa{static getInstance(){return Ze.instance||(Ze.instance=new Ze),Ze.instance}constructor(){super(Ze.id),this.scene=this.experience.scene,this.canvas=this.experience.canvas,this.renderer=this.experience.renderer,this.camera=this.experience.camera,this.mouse=this.experience.mouse,this.sizes=this.experience.sizes,this.resources=this.experience.resources,this.debug=this.experience.debug,this.params={color:new kn("#F777A8"),size:1,minAlpha:.04,maxAlpha:.8,force:.2},this.currentModelName="mask",this.init()}init(){this.setupMask(),this.setupGPGPU(),this.setupDebug()}setupMask(){const t=this.currentModelName||"mask",e=this.resources.models[t];let n;if(e)n=this.resolveMesh(e.scene);else{console.error(`Model ${t} not found! Using fallback.`);const i=new Fi(1,1,1),r=new Vn({color:16711680,wireframe:!0});n=new zn(i,r)}this.model=n,this.keywordCloud||(this.keywordCloud=new Va)}setupCameraPosition(){}setupGPGPU(){this.gpgpu=new Fa({size:1200,camera:this.camera,renderer:this.renderer.webglRenderer,mouse:this.mouse,scene:this.scene,sizes:this.sizes,model:this.model,debug:this.debug,audio:this.experience.audio,webcam:this.experience.webcam,params:this.params})}setupDebug(){if(this.debug.active){this.particlesFolder&&this.particlesFolder.destroy(),this.debug.gui.width=300,this.particlesFolder=this.debug.gui.addFolder("particles"),this.particlesFolder.addColor(this.params,"color").name("Color").onChange(()=>{this.gpgpu&&this.gpgpu.material&&this.gpgpu.material.uniforms.uColor&&this.gpgpu.material.uniforms.uColor.value.copy(this.params.color)}),this.particlesFolder.add(this.gpgpu.material.uniforms.uParticleSize,"value").min(.1).max(10).step(.1).name("Size"),this.particlesFolder.add(this.gpgpu.uniforms.velocityUniforms.uForce,"value").min(0).max(1).step(.01).name("Force"),this.particlesFolder.add(this.params,"minAlpha").min(0).max(1).step(.01).name("Min Alpha").onChange(()=>{this.gpgpu.material.uniforms.uMinAlpha&&(this.gpgpu.material.uniforms.uMinAlpha.value=this.params.minAlpha)}),this.particlesFolder.add(this.params,"maxAlpha").min(0).max(1).step(.01).name("Max Alpha").onChange(()=>{this.gpgpu.material.uniforms.uMaxAlpha&&(this.gpgpu.material.uniforms.uMaxAlpha.value=this.params.maxAlpha)}),this.particlesFolder.add(this,"randomize");const t={mask:"mask",veneciaMask:"veneciaMask",samurai:"samurai",cyborg:"cyborg",subway:"subway"};this.particlesFolder.add({model:"mask"},"model",t).onChange(e=>this.changeModel(e))}}randomize(){this.gpgpu&&this.gpgpu.material&&this.gpgpu.material.uniforms.uRandom&&(this.gpgpu.material.uniforms.uRandom.value=Math.random())}async switchModel(t){if(this.currentModelName===t)return;console.log(`[Mask] Switching Pantheon Model to: ${t}`);const e=this.params.minAlpha;ke.to(this.params,{minAlpha:0,duration:.3}),this.gpgpu&&this.gpgpu.mesh&&ke.to(this.gpgpu.mesh.rotation,{y:this.gpgpu.mesh.rotation.y+Math.PI*4,duration:.5,ease:"power2.inOut"});try{let n;if(this.resources.models[t])n=this.resolveMesh(this.resources.models[t].scene);else{const i=`models/pantheon/${t}.glb`;console.log(`[Mask] Loading ${i}...`),n=await this.loadModelFromUrl(i),this.resources.models[t]={scene:n}}if(!n)throw new Error("No mesh found");this.updateGPGPUGeometry(n),this.currentModelName=t,this.gpgpu&&this.gpgpu.uniforms.velocityUniforms.uAttraction&&(ke.fromTo(this.gpgpu.uniforms.velocityUniforms.uAttraction,{value:2},{value:.2,duration:.8,ease:"power4.out"}),ke.fromTo(this.gpgpu.uniforms.velocityUniforms.uForce,{value:0},{value:.5,duration:1.2,ease:"power2.out"})),ke.to(this.params,{minAlpha:e,duration:.5,delay:0}),console.log(`[Mask] Switched to ${t}`)}catch(n){console.warn(`[Mask] Failed to switch to ${t}:`,n),ke.to(this.params,{minAlpha:e,duration:1})}}resolveMesh(t){let e=null;if(t.traverse&&t.traverse(n=>{!e&&n.isMesh&&n.geometry&&(e=n)}),!e){console.warn("Mask.resolveMesh: No mesh found in scene",t),console.warn("Mask.resolveMesh: detailed scene",t.children);const n=new Fi(1,1,1),i=new Vn({color:16711680,wireframe:!0}),r=new zn(n,i);return r.name="Fallback_Dummy",r}return e.scale.set(1.7,1.7,1.7),e.updateMatrixWorld(),e}async loadModelFromUrl(t){const e=new Aa;return new Promise((n,i)=>{e.load(t,r=>{n(this.resolveMesh(r.scene))},void 0,r=>{console.warn("Error loading model",t),i(r)})})}updateGPGPUGeometry(t){this.gpgpu&&(typeof this.gpgpu.updateTarget=="function"?this.gpgpu.updateTarget(t):console.error("GPGPU.updateTarget not implemented!"))}setupMask(){}changeModel(t){this.switchModel(t)}updateVisualization(t){if(!t)return;this.currentData=t;const e=t.marketChangePercent||0,n=t.vix||20,i=t.fearGreedIndex||50,r=t.volumeRatio||1,a=t.tenYearYield||4;this.keywordCloud&&t.headlines&&this.keywordCloud.updateHeadlines(t.headlines);const s={0:{h:340,s:95,l:40,name:"Extreme Panic"},25:{h:260,s:60,l:40,name:"Fear"},45:{h:220,s:40,l:40,name:"Nervous"},55:{h:180,s:40,l:45,name:"Neutral"},75:{h:160,s:70,l:50,name:"Greed"},100:{h:50,s:95,l:60,name:"Euphoria"}},c=(Y,oe,ue)=>({h:Y.h+(oe.h-Y.h)*ue,s:Y.s+(oe.s-Y.s)*ue,l:Y.l+(oe.l-Y.l)*ue});let u=0,l=100;const f=Object.keys(s).map(Y=>parseInt(Y)).sort((Y,oe)=>Y-oe);for(let Y=0;Y<f.length-1;Y++)if(i>=f[Y]&&i<=f[Y+1]){u=f[Y],l=f[Y+1];break}const m=l-u,p=(i-u)/m,_=c(s[u],s[l],p);let d=_.h,v=_.s,y=_.l;const w=Math.max(0,a-4);w>0&&(d-=w*15);const b=(r-1)*20;v=Math.max(20,Math.min(100,v+b)),r>1.5&&(y+=5),d+=(t.day||1)%5*2,d=d%360,d<0&&(d+=360),v=Math.max(0,Math.min(100,v)),y=Math.max(0,Math.min(100,y));const D=new kn(`hsl(${Math.round(d)}, ${Math.round(v)}%, ${Math.round(y)}%)`),k=r,C=.5+k*.8,T=t.intradayRange||1,I=Math.min(1,T/3),E=Math.abs(t.marketGap||0),B=Math.min(1,E/2);let j=0;(n>28||e<-1.8)&&(j=Math.min(1,(n-25)/20+Math.abs(e)/5),j>.5&&D.lerp(new kn(16711680),.3));const P=j*.015,A=j*.2,V=.2+(t.volatility||.4)*.8+k*.1+B*.3+j*.5,S=.04+Math.min(1,Math.max(0,(a-3)/2))*.05,F=i/100;let z=1.5+Math.abs(e)*1.5+F*1;if(z+=Math.random()*I*1.5,ke.to(this.params.color,{r:D.r,g:D.g,b:D.b,duration:2,ease:"power2.out",onUpdate:()=>{this.gpgpu&&this.gpgpu.material&&this.gpgpu.material.uniforms.uColor&&this.gpgpu.material.uniforms.uColor.value.copy(this.params.color)}}),this.gpgpu&&this.gpgpu.material){const Y=Math.abs(i-50)/50;ke.to(this.gpgpu.material.uniforms.uMarketIntensity,{value:Y,duration:2.5}),ke.to(this.gpgpu.material.uniforms.uForce,{value:V,duration:2.5});const oe=I>.5?"elastic.out(1, 0.3)":"back.out(1.0)";ke.to(this.gpgpu.material.uniforms.uParticleSize,{value:z,duration:2.5,ease:oe}),ke.to(this.params,{minAlpha:S,duration:2})}if(this.renderer&&this.renderer.postprocessing){const Y=this.renderer.postprocessing;Y.setGlitch(P),this.fxParams||(this.fxParams={bloom:1,shake:0}),ke.to(this.fxParams,{bloom:C,shake:A,duration:2,onUpdate:()=>{Y.setBloom(this.fxParams.bloom),this.camera&&(this.camera.shakeIntensity=this.fxParams.shake)}})}this.currentBaseSize=z}update(){if(this.gpgpu&&(this.gpgpu.compute(),this.currentData&&this.gpgpu.material&&this.gpgpu.uniforms.velocityUniforms)){const t=performance.now()*.001,e=this.currentData.vix||20;let n=1+e/10,i=.4;e>30&&(n=8,i=.2);const r=1+Math.sin(t*n)*i;this.gpgpu.material.uniforms.uParticleSize&&(this.gpgpu.material.uniforms.uParticleSize.value=(this.params.size||1.5)*r);const a=(Math.random()-.5)*(e/800);let s=(this.params.force||.2)+a;s=Math.min(.6,Math.max(.1,s)),this.gpgpu.uniforms.velocityUniforms.uForce.value=s}this.keywordCloud&&this.experience.time&&this.keywordCloud.update(this.experience.time.elapsed/1e3)}};Oi(Ze,"instance");let ht=Ze;var Nn=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],Tt={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(o){return typeof console<"u"&&console.warn(o)},getWeek:function(o){var t=new Date(o.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var e=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},Qt={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(o){var t=o%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},ye=function(o,t){return t===void 0&&(t=2),("000"+o).slice(t*-1)},Re=function(o){return o===!0?1:0};function Ki(o,t){var e;return function(){var n=this,i=arguments;clearTimeout(e),e=setTimeout(function(){return o.apply(n,i)},t)}}var $n=function(o){return o instanceof Array?o:[o]};function ge(o,t,e){if(e===!0)return o.classList.add(t);o.classList.remove(t)}function q(o,t,e){var n=window.document.createElement(o);return t=t||"",e=e||"",n.className=t,e!==void 0&&(n.textContent=e),n}function sn(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function Jr(o,t){if(t(o))return o;if(o.parentNode)return Jr(o.parentNode,t)}function on(o,t){var e=q("div","numInputWrapper"),n=q("input","numInput "+o),i=q("span","arrowUp"),r=q("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?n.type="number":(n.type="text",n.pattern="\\d*"),t!==void 0)for(var a in t)n.setAttribute(a,t[a]);return e.appendChild(n),e.appendChild(i),e.appendChild(r),e}function Se(o){try{if(typeof o.composedPath=="function"){var t=o.composedPath();return t[0]}return o.target}catch{return o.target}}var Bn=function(){},_n=function(o,t,e){return e.months[t?"shorthand":"longhand"][o]},io={D:Bn,F:function(o,t,e){o.setMonth(e.months.longhand.indexOf(t))},G:function(o,t){o.setHours((o.getHours()>=12?12:0)+parseFloat(t))},H:function(o,t){o.setHours(parseFloat(t))},J:function(o,t){o.setDate(parseFloat(t))},K:function(o,t,e){o.setHours(o.getHours()%12+12*Re(new RegExp(e.amPM[1],"i").test(t)))},M:function(o,t,e){o.setMonth(e.months.shorthand.indexOf(t))},S:function(o,t){o.setSeconds(parseFloat(t))},U:function(o,t){return new Date(parseFloat(t)*1e3)},W:function(o,t,e){var n=parseInt(t),i=new Date(o.getFullYear(),0,2+(n-1)*7,0,0,0,0);return i.setDate(i.getDate()-i.getDay()+e.firstDayOfWeek),i},Y:function(o,t){o.setFullYear(parseFloat(t))},Z:function(o,t){return new Date(t)},d:function(o,t){o.setDate(parseFloat(t))},h:function(o,t){o.setHours((o.getHours()>=12?12:0)+parseFloat(t))},i:function(o,t){o.setMinutes(parseFloat(t))},j:function(o,t){o.setDate(parseFloat(t))},l:Bn,m:function(o,t){o.setMonth(parseFloat(t)-1)},n:function(o,t){o.setMonth(parseFloat(t)-1)},s:function(o,t){o.setSeconds(parseFloat(t))},u:function(o,t){return new Date(parseFloat(t))},w:Bn,y:function(o,t){o.setFullYear(2e3+parseFloat(t))}},ft={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},zt={Z:function(o){return o.toISOString()},D:function(o,t,e){return t.weekdays.shorthand[zt.w(o,t,e)]},F:function(o,t,e){return _n(zt.n(o,t,e)-1,!1,t)},G:function(o,t,e){return ye(zt.h(o,t,e))},H:function(o){return ye(o.getHours())},J:function(o,t){return t.ordinal!==void 0?o.getDate()+t.ordinal(o.getDate()):o.getDate()},K:function(o,t){return t.amPM[Re(o.getHours()>11)]},M:function(o,t){return _n(o.getMonth(),!0,t)},S:function(o){return ye(o.getSeconds())},U:function(o){return o.getTime()/1e3},W:function(o,t,e){return e.getWeek(o)},Y:function(o){return ye(o.getFullYear(),4)},d:function(o){return ye(o.getDate())},h:function(o){return o.getHours()%12?o.getHours()%12:12},i:function(o){return ye(o.getMinutes())},j:function(o){return o.getDate()},l:function(o,t){return t.weekdays.longhand[o.getDay()]},m:function(o){return ye(o.getMonth()+1)},n:function(o){return o.getMonth()+1},s:function(o){return o.getSeconds()},u:function(o){return o.getTime()},w:function(o){return o.getDay()},y:function(o){return String(o.getFullYear()).substring(2)}},Zr=function(o){var t=o.config,e=t===void 0?Tt:t,n=o.l10n,i=n===void 0?Qt:n,r=o.isMobile,a=r===void 0?!1:r;return function(s,c,u){var l=u||i;return e.formatDate!==void 0&&!a?e.formatDate(s,c,l):c.split("").map(function(f,m,p){return zt[f]&&p[m-1]!=="\\"?zt[f](s,l,e):f!=="\\"?f:""}).join("")}},ai=function(o){var t=o.config,e=t===void 0?Tt:t,n=o.l10n,i=n===void 0?Qt:n;return function(r,a,s,c){if(!(r!==0&&!r)){var u=c||i,l,f=r;if(r instanceof Date)l=new Date(r.getTime());else if(typeof r!="string"&&r.toFixed!==void 0)l=new Date(r);else if(typeof r=="string"){var m=a||(e||Tt).dateFormat,p=String(r).trim();if(p==="today")l=new Date,s=!0;else if(e&&e.parseDate)l=e.parseDate(r,m);else if(/Z$/.test(p)||/GMT$/.test(p))l=new Date(r);else{for(var _=void 0,d=[],v=0,y=0,w="";v<m.length;v++){var b=m[v],D=b==="\\",k=m[v-1]==="\\"||D;if(ft[b]&&!k){w+=ft[b];var C=new RegExp(w).exec(r);C&&(_=!0)&&d[b!=="Y"?"push":"unshift"]({fn:io[b],val:C[++y]})}else D||(w+=".")}l=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),d.forEach(function(T){var I=T.fn,E=T.val;return l=I(l,E,u)||l}),l=_?l:void 0}}if(!(l instanceof Date&&!isNaN(l.getTime()))){e.errorHandler(new Error("Invalid date provided: "+f));return}return s===!0&&l.setHours(0,0,0,0),l}}};function Ee(o,t,e){return e===void 0&&(e=!0),e!==!1?new Date(o.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):o.getTime()-t.getTime()}var ro=function(o,t,e){return o>Math.min(t,e)&&o<Math.max(t,e)},Yn=function(o,t,e){return o*3600+t*60+e},ao=function(o){var t=Math.floor(o/3600),e=(o-t*3600)/60;return[t,e,o-t*3600-e*60]},so={DAY:864e5};function Hn(o){var t=o.defaultHour,e=o.defaultMinute,n=o.defaultSeconds;if(o.minDate!==void 0){var i=o.minDate.getHours(),r=o.minDate.getMinutes(),a=o.minDate.getSeconds();t<i&&(t=i),t===i&&e<r&&(e=r),t===i&&e===r&&n<a&&(n=o.minDate.getSeconds())}if(o.maxDate!==void 0){var s=o.maxDate.getHours(),c=o.maxDate.getMinutes();t=Math.min(t,s),t===s&&(e=Math.min(c,e)),t===s&&e===c&&(n=o.maxDate.getSeconds())}return{hours:t,minutes:e,seconds:n}}typeof Object.assign!="function"&&(Object.assign=function(o){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(!o)throw TypeError("Cannot convert undefined or null to object");for(var n=function(s){s&&Object.keys(s).forEach(function(c){return o[c]=s[c]})},i=0,r=t;i<r.length;i++){var a=r[i];n(a)}return o});var de=globalThis&&globalThis.__assign||function(){return de=Object.assign||function(o){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i])}return o},de.apply(this,arguments)},Qi=globalThis&&globalThis.__spreadArrays||function(){for(var o=0,t=0,e=arguments.length;t<e;t++)o+=arguments[t].length;for(var n=Array(o),i=0,t=0;t<e;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,i++)n[i]=r[a];return n},oo=300;function lo(o,t){var e={config:de(de({},Tt),se.defaultConfig),l10n:Qt};e.parseDate=ai({config:e.config,l10n:e.l10n}),e._handlers=[],e.pluginElements=[],e.loadedPlugins=[],e._bind=d,e._setHoursFromDate=m,e._positionCalendar=tn,e.changeMonth=oe,e.changeYear=Je,e.clear=ue,e.close=Qe,e.onMouseOver=en,e._createElement=q,e.createDay=C,e.destroy=_e,e.isEnabled=Ae,e.jumpToDate=w,e.updateValue=Ue,e.open=na,e.redraw=ki,e.set=sa,e.setDate=oa,e.toggle=fa;function n(){e.utils={getDaysInMonth:function(h,g){return h===void 0&&(h=e.currentMonth),g===void 0&&(g=e.currentYear),h===1&&(g%4===0&&g%100!==0||g%400===0)?29:e.l10n.daysInMonth[h]}}}function i(){e.element=e.input=o,e.isOpen=!1,ia(),Si(),ca(),la(),n(),e.isMobile||k(),y(),(e.selectedDates.length||e.config.noCalendar)&&(e.config.enableTime&&m(e.config.noCalendar?e.latestSelectedDateObj:void 0),Ue(!1)),s();var h=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!e.isMobile&&h&&tn(),ee("onReady")}function r(){var h;return((h=e.calendarContainer)===null||h===void 0?void 0:h.getRootNode()).activeElement||document.activeElement}function a(h){return h.bind(e)}function s(){var h=e.config;h.weekNumbers===!1&&h.showMonths===1||h.noCalendar!==!0&&window.requestAnimationFrame(function(){if(e.calendarContainer!==void 0&&(e.calendarContainer.style.visibility="hidden",e.calendarContainer.style.display="block"),e.daysContainer!==void 0){var g=(e.days.offsetWidth+1)*h.showMonths;e.daysContainer.style.width=g+"px",e.calendarContainer.style.width=g+(e.weekWrapper!==void 0?e.weekWrapper.offsetWidth:0)+"px",e.calendarContainer.style.removeProperty("visibility"),e.calendarContainer.style.removeProperty("display")}})}function c(h){if(e.selectedDates.length===0){var g=e.config.minDate===void 0||Ee(new Date,e.config.minDate)>=0?new Date:new Date(e.config.minDate.getTime()),x=Hn(e.config);g.setHours(x.hours,x.minutes,x.seconds,g.getMilliseconds()),e.selectedDates=[g],e.latestSelectedDateObj=g}h!==void 0&&h.type!=="blur"&&ma(h);var M=e._input.value;f(),Ue(),e._input.value!==M&&e._debouncedChange()}function u(h,g){return h%12+12*Re(g===e.l10n.amPM[1])}function l(h){switch(h%24){case 0:case 12:return 12;default:return h%12}}function f(){if(!(e.hourElement===void 0||e.minuteElement===void 0)){var h=(parseInt(e.hourElement.value.slice(-2),10)||0)%24,g=(parseInt(e.minuteElement.value,10)||0)%60,x=e.secondElement!==void 0?(parseInt(e.secondElement.value,10)||0)%60:0;e.amPM!==void 0&&(h=u(h,e.amPM.textContent));var M=e.config.minTime!==void 0||e.config.minDate&&e.minDateHasTime&&e.latestSelectedDateObj&&Ee(e.latestSelectedDateObj,e.config.minDate,!0)===0,O=e.config.maxTime!==void 0||e.config.maxDate&&e.maxDateHasTime&&e.latestSelectedDateObj&&Ee(e.latestSelectedDateObj,e.config.maxDate,!0)===0;if(e.config.maxTime!==void 0&&e.config.minTime!==void 0&&e.config.minTime>e.config.maxTime){var L=Yn(e.config.minTime.getHours(),e.config.minTime.getMinutes(),e.config.minTime.getSeconds()),U=Yn(e.config.maxTime.getHours(),e.config.maxTime.getMinutes(),e.config.maxTime.getSeconds()),N=Yn(h,g,x);if(N>U&&N<L){var W=ao(L);h=W[0],g=W[1],x=W[2]}}else{if(O){var R=e.config.maxTime!==void 0?e.config.maxTime:e.config.maxDate;h=Math.min(h,R.getHours()),h===R.getHours()&&(g=Math.min(g,R.getMinutes())),g===R.getMinutes()&&(x=Math.min(x,R.getSeconds()))}if(M){var H=e.config.minTime!==void 0?e.config.minTime:e.config.minDate;h=Math.max(h,H.getHours()),h===H.getHours()&&g<H.getMinutes()&&(g=H.getMinutes()),g===H.getMinutes()&&(x=Math.max(x,H.getSeconds()))}}p(h,g,x)}}function m(h){var g=h||e.latestSelectedDateObj;g&&g instanceof Date&&p(g.getHours(),g.getMinutes(),g.getSeconds())}function p(h,g,x){e.latestSelectedDateObj!==void 0&&e.latestSelectedDateObj.setHours(h%24,g,x||0,0),!(!e.hourElement||!e.minuteElement||e.isMobile)&&(e.hourElement.value=ye(e.config.time_24hr?h:(12+h)%12+12*Re(h%12===0)),e.minuteElement.value=ye(g),e.amPM!==void 0&&(e.amPM.textContent=e.l10n.amPM[Re(h>=12)]),e.secondElement!==void 0&&(e.secondElement.value=ye(x)))}function _(h){var g=Se(h),x=parseInt(g.value)+(h.delta||0);(x/1e3>1||h.key==="Enter"&&!/[^\d]/.test(x.toString()))&&Je(x)}function d(h,g,x,M){if(g instanceof Array)return g.forEach(function(O){return d(h,O,x,M)});if(h instanceof Array)return h.forEach(function(O){return d(O,g,x,M)});h.addEventListener(g,x,M),e._handlers.push({remove:function(){return h.removeEventListener(g,x,M)}})}function v(){ee("onChange")}function y(){if(e.config.wrap&&["open","close","toggle","clear"].forEach(function(x){Array.prototype.forEach.call(e.element.querySelectorAll("[data-"+x+"]"),function(M){return d(M,"click",e[x])})}),e.isMobile){ua();return}var h=Ki(ta,50);if(e._debouncedChange=Ki(v,oo),e.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&d(e.daysContainer,"mouseover",function(x){e.config.mode==="range"&&en(Se(x))}),d(e._input,"keydown",Mi),e.calendarContainer!==void 0&&d(e.calendarContainer,"keydown",Mi),!e.config.inline&&!e.config.static&&d(window,"resize",h),window.ontouchstart!==void 0?d(window.document,"touchstart",bt):d(window.document,"mousedown",bt),d(window.document,"focus",bt,{capture:!0}),e.config.clickOpens===!0&&(d(e._input,"focus",e.open),d(e._input,"click",e.open)),e.daysContainer!==void 0&&(d(e.monthNav,"click",ha),d(e.monthNav,["keyup","increment"],_),d(e.daysContainer,"click",Ei)),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0){var g=function(x){return Se(x).select()};d(e.timeContainer,["increment"],c),d(e.timeContainer,"blur",c,{capture:!0}),d(e.timeContainer,"click",b),d([e.hourElement,e.minuteElement],["focus","click"],g),e.secondElement!==void 0&&d(e.secondElement,"focus",function(){return e.secondElement&&e.secondElement.select()}),e.amPM!==void 0&&d(e.amPM,"click",function(x){c(x)})}e.config.allowInput&&d(e._input,"blur",ea)}function w(h,g){var x=h!==void 0?e.parseDate(h):e.latestSelectedDateObj||(e.config.minDate&&e.config.minDate>e.now?e.config.minDate:e.config.maxDate&&e.config.maxDate<e.now?e.config.maxDate:e.now),M=e.currentYear,O=e.currentMonth;try{x!==void 0&&(e.currentYear=x.getFullYear(),e.currentMonth=x.getMonth())}catch(L){L.message="Invalid date supplied: "+x,e.config.errorHandler(L)}g&&e.currentYear!==M&&(ee("onYearChange"),A()),g&&(e.currentYear!==M||e.currentMonth!==O)&&ee("onMonthChange"),e.redraw()}function b(h){var g=Se(h);~g.className.indexOf("arrow")&&D(h,g.classList.contains("arrowUp")?1:-1)}function D(h,g,x){var M=h&&Se(h),O=x||M&&M.parentNode&&M.parentNode.firstChild,L=Mn("increment");L.delta=g,O&&O.dispatchEvent(L)}function k(){var h=window.document.createDocumentFragment();if(e.calendarContainer=q("div","flatpickr-calendar"),e.calendarContainer.tabIndex=-1,!e.config.noCalendar){if(h.appendChild(S()),e.innerContainer=q("div","flatpickr-innerContainer"),e.config.weekNumbers){var g=Y(),x=g.weekWrapper,M=g.weekNumbers;e.innerContainer.appendChild(x),e.weekNumbers=M,e.weekWrapper=x}e.rContainer=q("div","flatpickr-rContainer"),e.rContainer.appendChild($()),e.daysContainer||(e.daysContainer=q("div","flatpickr-days"),e.daysContainer.tabIndex=-1),P(),e.rContainer.appendChild(e.daysContainer),e.innerContainer.appendChild(e.rContainer),h.appendChild(e.innerContainer)}e.config.enableTime&&h.appendChild(F()),ge(e.calendarContainer,"rangeMode",e.config.mode==="range"),ge(e.calendarContainer,"animate",e.config.animate===!0),ge(e.calendarContainer,"multiMonth",e.config.showMonths>1),e.calendarContainer.appendChild(h);var O=e.config.appendTo!==void 0&&e.config.appendTo.nodeType!==void 0;if((e.config.inline||e.config.static)&&(e.calendarContainer.classList.add(e.config.inline?"inline":"static"),e.config.inline&&(!O&&e.element.parentNode?e.element.parentNode.insertBefore(e.calendarContainer,e._input.nextSibling):e.config.appendTo!==void 0&&e.config.appendTo.appendChild(e.calendarContainer)),e.config.static)){var L=q("div","flatpickr-wrapper");e.element.parentNode&&e.element.parentNode.insertBefore(L,e.element),L.appendChild(e.element),e.altInput&&L.appendChild(e.altInput),L.appendChild(e.calendarContainer)}!e.config.static&&!e.config.inline&&(e.config.appendTo!==void 0?e.config.appendTo:window.document.body).appendChild(e.calendarContainer)}function C(h,g,x,M){var O=Ae(g,!0),L=q("span",h,g.getDate().toString());return L.dateObj=g,L.$i=M,L.setAttribute("aria-label",e.formatDate(g,e.config.ariaDateFormat)),h.indexOf("hidden")===-1&&Ee(g,e.now)===0&&(e.todayDateElem=L,L.classList.add("today"),L.setAttribute("aria-current","date")),O?(L.tabIndex=-1,Dn(g)&&(L.classList.add("selected"),e.selectedDateElem=L,e.config.mode==="range"&&(ge(L,"startRange",e.selectedDates[0]&&Ee(g,e.selectedDates[0],!0)===0),ge(L,"endRange",e.selectedDates[1]&&Ee(g,e.selectedDates[1],!0)===0),h==="nextMonthDay"&&L.classList.add("inRange")))):L.classList.add("flatpickr-disabled"),e.config.mode==="range"&&da(g)&&!Dn(g)&&L.classList.add("inRange"),e.weekNumbers&&e.config.showMonths===1&&h!=="prevMonthDay"&&M%7===6&&e.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+e.config.getWeek(g)+"</span>"),ee("onDayCreate",L),L}function T(h){h.focus(),e.config.mode==="range"&&en(h)}function I(h){for(var g=h>0?0:e.config.showMonths-1,x=h>0?e.config.showMonths:-1,M=g;M!=x;M+=h)for(var O=e.daysContainer.children[M],L=h>0?0:O.children.length-1,U=h>0?O.children.length:-1,N=L;N!=U;N+=h){var W=O.children[N];if(W.className.indexOf("hidden")===-1&&Ae(W.dateObj))return W}}function E(h,g){for(var x=h.className.indexOf("Month")===-1?h.dateObj.getMonth():e.currentMonth,M=g>0?e.config.showMonths:-1,O=g>0?1:-1,L=x-e.currentMonth;L!=M;L+=O)for(var U=e.daysContainer.children[L],N=x-e.currentMonth===L?h.$i+g:g<0?U.children.length-1:0,W=U.children.length,R=N;R>=0&&R<W&&R!=(g>0?W:-1);R+=O){var H=U.children[R];if(H.className.indexOf("hidden")===-1&&Ae(H.dateObj)&&Math.abs(h.$i-R)>=Math.abs(g))return T(H)}e.changeMonth(O),B(I(O),0)}function B(h,g){var x=r(),M=Zt(x||document.body),O=h!==void 0?h:M?x:e.selectedDateElem!==void 0&&Zt(e.selectedDateElem)?e.selectedDateElem:e.todayDateElem!==void 0&&Zt(e.todayDateElem)?e.todayDateElem:I(g>0?1:-1);O===void 0?e._input.focus():M?E(O,g):T(O)}function j(h,g){for(var x=(new Date(h,g,1).getDay()-e.l10n.firstDayOfWeek+7)%7,M=e.utils.getDaysInMonth((g-1+12)%12,h),O=e.utils.getDaysInMonth(g,h),L=window.document.createDocumentFragment(),U=e.config.showMonths>1,N=U?"prevMonthDay hidden":"prevMonthDay",W=U?"nextMonthDay hidden":"nextMonthDay",R=M+1-x,H=0;R<=M;R++,H++)L.appendChild(C("flatpickr-day "+N,new Date(h,g-1,R),R,H));for(R=1;R<=O;R++,H++)L.appendChild(C("flatpickr-day",new Date(h,g,R),R,H));for(var K=O+1;K<=42-x&&(e.config.showMonths===1||H%7!==0);K++,H++)L.appendChild(C("flatpickr-day "+W,new Date(h,g+1,K%O),K,H));var Ye=q("div","dayContainer");return Ye.appendChild(L),Ye}function P(){if(e.daysContainer!==void 0){sn(e.daysContainer),e.weekNumbers&&sn(e.weekNumbers);for(var h=document.createDocumentFragment(),g=0;g<e.config.showMonths;g++){var x=new Date(e.currentYear,e.currentMonth,1);x.setMonth(e.currentMonth+g),h.appendChild(j(x.getFullYear(),x.getMonth()))}e.daysContainer.appendChild(h),e.days=e.daysContainer.firstChild,e.config.mode==="range"&&e.selectedDates.length===1&&en()}}function A(){if(!(e.config.showMonths>1||e.config.monthSelectorType!=="dropdown")){var h=function(M){return e.config.minDate!==void 0&&e.currentYear===e.config.minDate.getFullYear()&&M<e.config.minDate.getMonth()?!1:!(e.config.maxDate!==void 0&&e.currentYear===e.config.maxDate.getFullYear()&&M>e.config.maxDate.getMonth())};e.monthsDropdownContainer.tabIndex=-1,e.monthsDropdownContainer.innerHTML="";for(var g=0;g<12;g++)if(h(g)){var x=q("option","flatpickr-monthDropdown-month");x.value=new Date(e.currentYear,g).getMonth().toString(),x.textContent=_n(g,e.config.shorthandCurrentMonth,e.l10n),x.tabIndex=-1,e.currentMonth===g&&(x.selected=!0),e.monthsDropdownContainer.appendChild(x)}}}function V(){var h=q("div","flatpickr-month"),g=window.document.createDocumentFragment(),x;e.config.showMonths>1||e.config.monthSelectorType==="static"?x=q("span","cur-month"):(e.monthsDropdownContainer=q("select","flatpickr-monthDropdown-months"),e.monthsDropdownContainer.setAttribute("aria-label",e.l10n.monthAriaLabel),d(e.monthsDropdownContainer,"change",function(U){var N=Se(U),W=parseInt(N.value,10);e.changeMonth(W-e.currentMonth),ee("onMonthChange")}),A(),x=e.monthsDropdownContainer);var M=on("cur-year",{tabindex:"-1"}),O=M.getElementsByTagName("input")[0];O.setAttribute("aria-label",e.l10n.yearAriaLabel),e.config.minDate&&O.setAttribute("min",e.config.minDate.getFullYear().toString()),e.config.maxDate&&(O.setAttribute("max",e.config.maxDate.getFullYear().toString()),O.disabled=!!e.config.minDate&&e.config.minDate.getFullYear()===e.config.maxDate.getFullYear());var L=q("div","flatpickr-current-month");return L.appendChild(x),L.appendChild(M),g.appendChild(L),h.appendChild(g),{container:h,yearElement:O,monthElement:x}}function G(){sn(e.monthNav),e.monthNav.appendChild(e.prevMonthNav),e.config.showMonths&&(e.yearElements=[],e.monthElements=[]);for(var h=e.config.showMonths;h--;){var g=V();e.yearElements.push(g.yearElement),e.monthElements.push(g.monthElement),e.monthNav.appendChild(g.container)}e.monthNav.appendChild(e.nextMonthNav)}function S(){return e.monthNav=q("div","flatpickr-months"),e.yearElements=[],e.monthElements=[],e.prevMonthNav=q("span","flatpickr-prev-month"),e.prevMonthNav.innerHTML=e.config.prevArrow,e.nextMonthNav=q("span","flatpickr-next-month"),e.nextMonthNav.innerHTML=e.config.nextArrow,G(),Object.defineProperty(e,"_hidePrevMonthArrow",{get:function(){return e.__hidePrevMonthArrow},set:function(h){e.__hidePrevMonthArrow!==h&&(ge(e.prevMonthNav,"flatpickr-disabled",h),e.__hidePrevMonthArrow=h)}}),Object.defineProperty(e,"_hideNextMonthArrow",{get:function(){return e.__hideNextMonthArrow},set:function(h){e.__hideNextMonthArrow!==h&&(ge(e.nextMonthNav,"flatpickr-disabled",h),e.__hideNextMonthArrow=h)}}),e.currentYearElement=e.yearElements[0],rn(),e.monthNav}function F(){e.calendarContainer.classList.add("hasTime"),e.config.noCalendar&&e.calendarContainer.classList.add("noCalendar");var h=Hn(e.config);e.timeContainer=q("div","flatpickr-time"),e.timeContainer.tabIndex=-1;var g=q("span","flatpickr-time-separator",":"),x=on("flatpickr-hour",{"aria-label":e.l10n.hourAriaLabel});e.hourElement=x.getElementsByTagName("input")[0];var M=on("flatpickr-minute",{"aria-label":e.l10n.minuteAriaLabel});if(e.minuteElement=M.getElementsByTagName("input")[0],e.hourElement.tabIndex=e.minuteElement.tabIndex=-1,e.hourElement.value=ye(e.latestSelectedDateObj?e.latestSelectedDateObj.getHours():e.config.time_24hr?h.hours:l(h.hours)),e.minuteElement.value=ye(e.latestSelectedDateObj?e.latestSelectedDateObj.getMinutes():h.minutes),e.hourElement.setAttribute("step",e.config.hourIncrement.toString()),e.minuteElement.setAttribute("step",e.config.minuteIncrement.toString()),e.hourElement.setAttribute("min",e.config.time_24hr?"0":"1"),e.hourElement.setAttribute("max",e.config.time_24hr?"23":"12"),e.hourElement.setAttribute("maxlength","2"),e.minuteElement.setAttribute("min","0"),e.minuteElement.setAttribute("max","59"),e.minuteElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(x),e.timeContainer.appendChild(g),e.timeContainer.appendChild(M),e.config.time_24hr&&e.timeContainer.classList.add("time24hr"),e.config.enableSeconds){e.timeContainer.classList.add("hasSeconds");var O=on("flatpickr-second");e.secondElement=O.getElementsByTagName("input")[0],e.secondElement.value=ye(e.latestSelectedDateObj?e.latestSelectedDateObj.getSeconds():h.seconds),e.secondElement.setAttribute("step",e.minuteElement.getAttribute("step")),e.secondElement.setAttribute("min","0"),e.secondElement.setAttribute("max","59"),e.secondElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(q("span","flatpickr-time-separator",":")),e.timeContainer.appendChild(O)}return e.config.time_24hr||(e.amPM=q("span","flatpickr-am-pm",e.l10n.amPM[Re((e.latestSelectedDateObj?e.hourElement.value:e.config.defaultHour)>11)]),e.amPM.title=e.l10n.toggleTitle,e.amPM.tabIndex=-1,e.timeContainer.appendChild(e.amPM)),e.timeContainer}function $(){e.weekdayContainer?sn(e.weekdayContainer):e.weekdayContainer=q("div","flatpickr-weekdays");for(var h=e.config.showMonths;h--;){var g=q("div","flatpickr-weekdaycontainer");e.weekdayContainer.appendChild(g)}return z(),e.weekdayContainer}function z(){if(e.weekdayContainer){var h=e.l10n.firstDayOfWeek,g=Qi(e.l10n.weekdays.shorthand);h>0&&h<g.length&&(g=Qi(g.splice(h,g.length),g.splice(0,h)));for(var x=e.config.showMonths;x--;)e.weekdayContainer.children[x].innerHTML=`
      <span class='flatpickr-weekday'>
        `+g.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function Y(){e.calendarContainer.classList.add("hasWeeks");var h=q("div","flatpickr-weekwrapper");h.appendChild(q("span","flatpickr-weekday",e.l10n.weekAbbreviation));var g=q("div","flatpickr-weeks");return h.appendChild(g),{weekWrapper:h,weekNumbers:g}}function oe(h,g){g===void 0&&(g=!0);var x=g?h:h-e.currentMonth;x<0&&e._hidePrevMonthArrow===!0||x>0&&e._hideNextMonthArrow===!0||(e.currentMonth+=x,(e.currentMonth<0||e.currentMonth>11)&&(e.currentYear+=e.currentMonth>11?1:-1,e.currentMonth=(e.currentMonth+12)%12,ee("onYearChange"),A()),P(),ee("onMonthChange"),rn())}function ue(h,g){if(h===void 0&&(h=!0),g===void 0&&(g=!0),e.input.value="",e.altInput!==void 0&&(e.altInput.value=""),e.mobileInput!==void 0&&(e.mobileInput.value=""),e.selectedDates=[],e.latestSelectedDateObj=void 0,g===!0&&(e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth()),e.config.enableTime===!0){var x=Hn(e.config),M=x.hours,O=x.minutes,L=x.seconds;p(M,O,L)}e.redraw(),h&&ee("onChange")}function Qe(){e.isOpen=!1,e.isMobile||(e.calendarContainer!==void 0&&e.calendarContainer.classList.remove("open"),e._input!==void 0&&e._input.classList.remove("active")),ee("onClose")}function _e(){e.config!==void 0&&ee("onDestroy");for(var h=e._handlers.length;h--;)e._handlers[h].remove();if(e._handlers=[],e.mobileInput)e.mobileInput.parentNode&&e.mobileInput.parentNode.removeChild(e.mobileInput),e.mobileInput=void 0;else if(e.calendarContainer&&e.calendarContainer.parentNode)if(e.config.static&&e.calendarContainer.parentNode){var g=e.calendarContainer.parentNode;if(g.lastChild&&g.removeChild(g.lastChild),g.parentNode){for(;g.firstChild;)g.parentNode.insertBefore(g.firstChild,g);g.parentNode.removeChild(g)}}else e.calendarContainer.parentNode.removeChild(e.calendarContainer);e.altInput&&(e.input.type="text",e.altInput.parentNode&&e.altInput.parentNode.removeChild(e.altInput),delete e.altInput),e.input&&(e.input.type=e.input._type,e.input.classList.remove("flatpickr-input"),e.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(x){try{delete e[x]}catch{}})}function fe(h){return e.calendarContainer.contains(h)}function bt(h){if(e.isOpen&&!e.config.inline){var g=Se(h),x=fe(g),M=g===e.input||g===e.altInput||e.element.contains(g)||h.path&&h.path.indexOf&&(~h.path.indexOf(e.input)||~h.path.indexOf(e.altInput)),O=!M&&!x&&!fe(h.relatedTarget),L=!e.config.ignoredFocusElements.some(function(U){return U.contains(g)});O&&L&&(e.config.allowInput&&e.setDate(e._input.value,!1,e.config.altInput?e.config.altFormat:e.config.dateFormat),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0&&e.input.value!==""&&e.input.value!==void 0&&c(),e.close(),e.config&&e.config.mode==="range"&&e.selectedDates.length===1&&e.clear(!1))}}function Je(h){if(!(!h||e.config.minDate&&h<e.config.minDate.getFullYear()||e.config.maxDate&&h>e.config.maxDate.getFullYear())){var g=h,x=e.currentYear!==g;e.currentYear=g||e.currentYear,e.config.maxDate&&e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth=Math.min(e.config.maxDate.getMonth(),e.currentMonth):e.config.minDate&&e.currentYear===e.config.minDate.getFullYear()&&(e.currentMonth=Math.max(e.config.minDate.getMonth(),e.currentMonth)),x&&(e.redraw(),ee("onYearChange"),A())}}function Ae(h,g){var x;g===void 0&&(g=!0);var M=e.parseDate(h,void 0,g);if(e.config.minDate&&M&&Ee(M,e.config.minDate,g!==void 0?g:!e.minDateHasTime)<0||e.config.maxDate&&M&&Ee(M,e.config.maxDate,g!==void 0?g:!e.maxDateHasTime)>0)return!1;if(!e.config.enable&&e.config.disable.length===0)return!0;if(M===void 0)return!1;for(var O=!!e.config.enable,L=(x=e.config.enable)!==null&&x!==void 0?x:e.config.disable,U=0,N=void 0;U<L.length;U++){if(N=L[U],typeof N=="function"&&N(M))return O;if(N instanceof Date&&M!==void 0&&N.getTime()===M.getTime())return O;if(typeof N=="string"){var W=e.parseDate(N,void 0,!0);return W&&W.getTime()===M.getTime()?O:!O}else if(typeof N=="object"&&M!==void 0&&N.from&&N.to&&M.getTime()>=N.from.getTime()&&M.getTime()<=N.to.getTime())return O}return!O}function Zt(h){return e.daysContainer!==void 0?h.className.indexOf("hidden")===-1&&h.className.indexOf("flatpickr-disabled")===-1&&e.daysContainer.contains(h):!1}function ea(h){var g=h.target===e._input,x=e._input.value.trimEnd()!==Cn();g&&x&&!(h.relatedTarget&&fe(h.relatedTarget))&&e.setDate(e._input.value,!0,h.target===e.altInput?e.config.altFormat:e.config.dateFormat)}function Mi(h){var g=Se(h),x=e.config.wrap?o.contains(g):g===e._input,M=e.config.allowInput,O=e.isOpen&&(!M||!x),L=e.config.inline&&x&&!M;if(h.keyCode===13&&x){if(M)return e.setDate(e._input.value,!0,g===e.altInput?e.config.altFormat:e.config.dateFormat),e.close(),g.blur();e.open()}else if(fe(g)||O||L){var U=!!e.timeContainer&&e.timeContainer.contains(g);switch(h.keyCode){case 13:U?(h.preventDefault(),c(),wn()):Ei(h);break;case 27:h.preventDefault(),wn();break;case 8:case 46:x&&!e.config.allowInput&&(h.preventDefault(),e.clear());break;case 37:case 39:if(!U&&!x){h.preventDefault();var N=r();if(e.daysContainer!==void 0&&(M===!1||N&&Zt(N))){var W=h.keyCode===39?1:-1;h.ctrlKey?(h.stopPropagation(),oe(W),B(I(1),0)):B(void 0,W)}}else e.hourElement&&e.hourElement.focus();break;case 38:case 40:h.preventDefault();var R=h.keyCode===40?1:-1;e.daysContainer&&g.$i!==void 0||g===e.input||g===e.altInput?h.ctrlKey?(h.stopPropagation(),Je(e.currentYear-R),B(I(1),0)):U||B(void 0,R*7):g===e.currentYearElement?Je(e.currentYear-R):e.config.enableTime&&(!U&&e.hourElement&&e.hourElement.focus(),c(h),e._debouncedChange());break;case 9:if(U){var H=[e.hourElement,e.minuteElement,e.secondElement,e.amPM].concat(e.pluginElements).filter(function(Ce){return Ce}),K=H.indexOf(g);if(K!==-1){var Ye=H[K+(h.shiftKey?-1:1)];h.preventDefault(),(Ye||e._input).focus()}}else!e.config.noCalendar&&e.daysContainer&&e.daysContainer.contains(g)&&h.shiftKey&&(h.preventDefault(),e._input.focus());break}}if(e.amPM!==void 0&&g===e.amPM)switch(h.key){case e.l10n.amPM[0].charAt(0):case e.l10n.amPM[0].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[0],f(),Ue();break;case e.l10n.amPM[1].charAt(0):case e.l10n.amPM[1].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[1],f(),Ue();break}(x||fe(g))&&ee("onKeyDown",h)}function en(h,g){if(g===void 0&&(g="flatpickr-day"),!(e.selectedDates.length!==1||h&&(!h.classList.contains(g)||h.classList.contains("flatpickr-disabled")))){for(var x=h?h.dateObj.getTime():e.days.firstElementChild.dateObj.getTime(),M=e.parseDate(e.selectedDates[0],void 0,!0).getTime(),O=Math.min(x,e.selectedDates[0].getTime()),L=Math.max(x,e.selectedDates[0].getTime()),U=!1,N=0,W=0,R=O;R<L;R+=so.DAY)Ae(new Date(R),!0)||(U=U||R>O&&R<L,R<M&&(!N||R>N)?N=R:R>M&&(!W||R<W)&&(W=R));var H=Array.from(e.rContainer.querySelectorAll("*:nth-child(-n+"+e.config.showMonths+") > ."+g));H.forEach(function(K){var Ye=K.dateObj,Ce=Ye.getTime(),Rt=N>0&&Ce<N||W>0&&Ce>W;if(Rt){K.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(wt){K.classList.remove(wt)});return}else if(U&&!Rt)return;["startRange","inRange","endRange","notAllowed"].forEach(function(wt){K.classList.remove(wt)}),h!==void 0&&(h.classList.add(x<=e.selectedDates[0].getTime()?"startRange":"endRange"),M<x&&Ce===M?K.classList.add("startRange"):M>x&&Ce===M&&K.classList.add("endRange"),Ce>=N&&(W===0||Ce<=W)&&ro(Ce,M,x)&&K.classList.add("inRange"))})}}function ta(){e.isOpen&&!e.config.static&&!e.config.inline&&tn()}function na(h,g){if(g===void 0&&(g=e._positionElement),e.isMobile===!0){if(h){h.preventDefault();var x=Se(h);x&&x.blur()}e.mobileInput!==void 0&&(e.mobileInput.focus(),e.mobileInput.click()),ee("onOpen");return}else if(e._input.disabled||e.config.inline)return;var M=e.isOpen;e.isOpen=!0,M||(e.calendarContainer.classList.add("open"),e._input.classList.add("active"),ee("onOpen"),tn(g)),e.config.enableTime===!0&&e.config.noCalendar===!0&&e.config.allowInput===!1&&(h===void 0||!e.timeContainer.contains(h.relatedTarget))&&setTimeout(function(){return e.hourElement.select()},50)}function Di(h){return function(g){var x=e.config["_"+h+"Date"]=e.parseDate(g,e.config.dateFormat),M=e.config["_"+(h==="min"?"max":"min")+"Date"];x!==void 0&&(e[h==="min"?"minDateHasTime":"maxDateHasTime"]=x.getHours()>0||x.getMinutes()>0||x.getSeconds()>0),e.selectedDates&&(e.selectedDates=e.selectedDates.filter(function(O){return Ae(O)}),!e.selectedDates.length&&h==="min"&&m(x),Ue()),e.daysContainer&&(ki(),x!==void 0?e.currentYearElement[h]=x.getFullYear().toString():e.currentYearElement.removeAttribute(h),e.currentYearElement.disabled=!!M&&x!==void 0&&M.getFullYear()===x.getFullYear())}}function ia(){var h=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],g=de(de({},JSON.parse(JSON.stringify(o.dataset||{}))),t),x={};e.config.parseDate=g.parseDate,e.config.formatDate=g.formatDate,Object.defineProperty(e.config,"enable",{get:function(){return e.config._enable},set:function(H){e.config._enable=Ii(H)}}),Object.defineProperty(e.config,"disable",{get:function(){return e.config._disable},set:function(H){e.config._disable=Ii(H)}});var M=g.mode==="time";if(!g.dateFormat&&(g.enableTime||M)){var O=se.defaultConfig.dateFormat||Tt.dateFormat;x.dateFormat=g.noCalendar||M?"H:i"+(g.enableSeconds?":S":""):O+" H:i"+(g.enableSeconds?":S":"")}if(g.altInput&&(g.enableTime||M)&&!g.altFormat){var L=se.defaultConfig.altFormat||Tt.altFormat;x.altFormat=g.noCalendar||M?"h:i"+(g.enableSeconds?":S K":" K"):L+(" h:i"+(g.enableSeconds?":S":"")+" K")}Object.defineProperty(e.config,"minDate",{get:function(){return e.config._minDate},set:Di("min")}),Object.defineProperty(e.config,"maxDate",{get:function(){return e.config._maxDate},set:Di("max")});var U=function(H){return function(K){e.config[H==="min"?"_minTime":"_maxTime"]=e.parseDate(K,"H:i:S")}};Object.defineProperty(e.config,"minTime",{get:function(){return e.config._minTime},set:U("min")}),Object.defineProperty(e.config,"maxTime",{get:function(){return e.config._maxTime},set:U("max")}),g.mode==="time"&&(e.config.noCalendar=!0,e.config.enableTime=!0),Object.assign(e.config,x,g);for(var N=0;N<h.length;N++)e.config[h[N]]=e.config[h[N]]===!0||e.config[h[N]]==="true";Nn.filter(function(H){return e.config[H]!==void 0}).forEach(function(H){e.config[H]=$n(e.config[H]||[]).map(a)}),e.isMobile=!e.config.disableMobile&&!e.config.inline&&e.config.mode==="single"&&!e.config.disable.length&&!e.config.enable&&!e.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var N=0;N<e.config.plugins.length;N++){var W=e.config.plugins[N](e)||{};for(var R in W)Nn.indexOf(R)>-1?e.config[R]=$n(W[R]).map(a).concat(e.config[R]):typeof g[R]>"u"&&(e.config[R]=W[R])}g.altInputClass||(e.config.altInputClass=Ci().className+" "+e.config.altInputClass),ee("onParseConfig")}function Ci(){return e.config.wrap?o.querySelector("[data-input]"):o}function Si(){typeof e.config.locale!="object"&&typeof se.l10ns[e.config.locale]>"u"&&e.config.errorHandler(new Error("flatpickr: invalid locale "+e.config.locale)),e.l10n=de(de({},se.l10ns.default),typeof e.config.locale=="object"?e.config.locale:e.config.locale!=="default"?se.l10ns[e.config.locale]:void 0),ft.D="("+e.l10n.weekdays.shorthand.join("|")+")",ft.l="("+e.l10n.weekdays.longhand.join("|")+")",ft.M="("+e.l10n.months.shorthand.join("|")+")",ft.F="("+e.l10n.months.longhand.join("|")+")",ft.K="("+e.l10n.amPM[0]+"|"+e.l10n.amPM[1]+"|"+e.l10n.amPM[0].toLowerCase()+"|"+e.l10n.amPM[1].toLowerCase()+")";var h=de(de({},t),JSON.parse(JSON.stringify(o.dataset||{})));h.time_24hr===void 0&&se.defaultConfig.time_24hr===void 0&&(e.config.time_24hr=e.l10n.time_24hr),e.formatDate=Zr(e),e.parseDate=ai({config:e.config,l10n:e.l10n})}function tn(h){if(typeof e.config.position=="function")return void e.config.position(e,h);if(e.calendarContainer!==void 0){ee("onPreCalendarPosition");var g=h||e._positionElement,x=Array.prototype.reduce.call(e.calendarContainer.children,function(wa,Ma){return wa+Ma.offsetHeight},0),M=e.calendarContainer.offsetWidth,O=e.config.position.split(" "),L=O[0],U=O.length>1?O[1]:null,N=g.getBoundingClientRect(),W=window.innerHeight-N.bottom,R=L==="above"||L!=="below"&&W<x&&N.top>x,H=window.pageYOffset+N.top+(R?-x-2:g.offsetHeight+2);if(ge(e.calendarContainer,"arrowTop",!R),ge(e.calendarContainer,"arrowBottom",R),!e.config.inline){var K=window.pageXOffset+N.left,Ye=!1,Ce=!1;U==="center"?(K-=(M-N.width)/2,Ye=!0):U==="right"&&(K-=M-N.width,Ce=!0),ge(e.calendarContainer,"arrowLeft",!Ye&&!Ce),ge(e.calendarContainer,"arrowCenter",Ye),ge(e.calendarContainer,"arrowRight",Ce);var Rt=window.document.body.offsetWidth-(window.pageXOffset+N.right),wt=K+M>window.document.body.offsetWidth,pa=Rt+M>window.document.body.offsetWidth;if(ge(e.calendarContainer,"rightMost",wt),!e.config.static)if(e.calendarContainer.style.top=H+"px",!wt)e.calendarContainer.style.left=K+"px",e.calendarContainer.style.right="auto";else if(!pa)e.calendarContainer.style.left="auto",e.calendarContainer.style.right=Rt+"px";else{var Sn=ra();if(Sn===void 0)return;var ga=window.document.body.offsetWidth,va=Math.max(0,ga/2-M/2),_a=".flatpickr-calendar.centerMost:before",ya=".flatpickr-calendar.centerMost:after",xa=Sn.cssRules.length,ba="{left:"+N.left+"px;right:auto;}";ge(e.calendarContainer,"rightMost",!1),ge(e.calendarContainer,"centerMost",!0),Sn.insertRule(_a+","+ya+ba,xa),e.calendarContainer.style.left=va+"px",e.calendarContainer.style.right="auto"}}}}function ra(){for(var h=null,g=0;g<document.styleSheets.length;g++){var x=document.styleSheets[g];if(x.cssRules){try{x.cssRules}catch{continue}h=x;break}}return h??aa()}function aa(){var h=document.createElement("style");return document.head.appendChild(h),h.sheet}function ki(){e.config.noCalendar||e.isMobile||(A(),rn(),P())}function wn(){e._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(e.close,0):e.close()}function Ei(h){h.preventDefault(),h.stopPropagation();var g=function(H){return H.classList&&H.classList.contains("flatpickr-day")&&!H.classList.contains("flatpickr-disabled")&&!H.classList.contains("notAllowed")},x=Jr(Se(h),g);if(x!==void 0){var M=x,O=e.latestSelectedDateObj=new Date(M.dateObj.getTime()),L=(O.getMonth()<e.currentMonth||O.getMonth()>e.currentMonth+e.config.showMonths-1)&&e.config.mode!=="range";if(e.selectedDateElem=M,e.config.mode==="single")e.selectedDates=[O];else if(e.config.mode==="multiple"){var U=Dn(O);U?e.selectedDates.splice(parseInt(U),1):e.selectedDates.push(O)}else e.config.mode==="range"&&(e.selectedDates.length===2&&e.clear(!1,!1),e.latestSelectedDateObj=O,e.selectedDates.push(O),Ee(O,e.selectedDates[0],!0)!==0&&e.selectedDates.sort(function(H,K){return H.getTime()-K.getTime()}));if(f(),L){var N=e.currentYear!==O.getFullYear();e.currentYear=O.getFullYear(),e.currentMonth=O.getMonth(),N&&(ee("onYearChange"),A()),ee("onMonthChange")}if(rn(),P(),Ue(),!L&&e.config.mode!=="range"&&e.config.showMonths===1?T(M):e.selectedDateElem!==void 0&&e.hourElement===void 0&&e.selectedDateElem&&e.selectedDateElem.focus(),e.hourElement!==void 0&&e.hourElement!==void 0&&e.hourElement.focus(),e.config.closeOnSelect){var W=e.config.mode==="single"&&!e.config.enableTime,R=e.config.mode==="range"&&e.selectedDates.length===2&&!e.config.enableTime;(W||R)&&wn()}v()}}var nn={locale:[Si,z],showMonths:[G,s,$],minDate:[w],maxDate:[w],positionElement:[Pi],clickOpens:[function(){e.config.clickOpens===!0?(d(e._input,"focus",e.open),d(e._input,"click",e.open)):(e._input.removeEventListener("focus",e.open),e._input.removeEventListener("click",e.open))}]};function sa(h,g){if(h!==null&&typeof h=="object"){Object.assign(e.config,h);for(var x in h)nn[x]!==void 0&&nn[x].forEach(function(M){return M()})}else e.config[h]=g,nn[h]!==void 0?nn[h].forEach(function(M){return M()}):Nn.indexOf(h)>-1&&(e.config[h]=$n(g));e.redraw(),Ue(!0)}function Ti(h,g){var x=[];if(h instanceof Array)x=h.map(function(M){return e.parseDate(M,g)});else if(h instanceof Date||typeof h=="number")x=[e.parseDate(h,g)];else if(typeof h=="string")switch(e.config.mode){case"single":case"time":x=[e.parseDate(h,g)];break;case"multiple":x=h.split(e.config.conjunction).map(function(M){return e.parseDate(M,g)});break;case"range":x=h.split(e.l10n.rangeSeparator).map(function(M){return e.parseDate(M,g)});break}else e.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(h)));e.selectedDates=e.config.allowInvalidPreload?x:x.filter(function(M){return M instanceof Date&&Ae(M,!1)}),e.config.mode==="range"&&e.selectedDates.sort(function(M,O){return M.getTime()-O.getTime()})}function oa(h,g,x){if(g===void 0&&(g=!1),x===void 0&&(x=e.config.dateFormat),h!==0&&!h||h instanceof Array&&h.length===0)return e.clear(g);Ti(h,x),e.latestSelectedDateObj=e.selectedDates[e.selectedDates.length-1],e.redraw(),w(void 0,g),m(),e.selectedDates.length===0&&e.clear(!1),Ue(g),g&&ee("onChange")}function Ii(h){return h.slice().map(function(g){return typeof g=="string"||typeof g=="number"||g instanceof Date?e.parseDate(g,void 0,!0):g&&typeof g=="object"&&g.from&&g.to?{from:e.parseDate(g.from,void 0),to:e.parseDate(g.to,void 0)}:g}).filter(function(g){return g})}function la(){e.selectedDates=[],e.now=e.parseDate(e.config.now)||new Date;var h=e.config.defaultDate||((e.input.nodeName==="INPUT"||e.input.nodeName==="TEXTAREA")&&e.input.placeholder&&e.input.value===e.input.placeholder?null:e.input.value);h&&Ti(h,e.config.dateFormat),e._initialDate=e.selectedDates.length>0?e.selectedDates[0]:e.config.minDate&&e.config.minDate.getTime()>e.now.getTime()?e.config.minDate:e.config.maxDate&&e.config.maxDate.getTime()<e.now.getTime()?e.config.maxDate:e.now,e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth(),e.selectedDates.length>0&&(e.latestSelectedDateObj=e.selectedDates[0]),e.config.minTime!==void 0&&(e.config.minTime=e.parseDate(e.config.minTime,"H:i")),e.config.maxTime!==void 0&&(e.config.maxTime=e.parseDate(e.config.maxTime,"H:i")),e.minDateHasTime=!!e.config.minDate&&(e.config.minDate.getHours()>0||e.config.minDate.getMinutes()>0||e.config.minDate.getSeconds()>0),e.maxDateHasTime=!!e.config.maxDate&&(e.config.maxDate.getHours()>0||e.config.maxDate.getMinutes()>0||e.config.maxDate.getSeconds()>0)}function ca(){if(e.input=Ci(),!e.input){e.config.errorHandler(new Error("Invalid input element specified"));return}e.input._type=e.input.type,e.input.type="text",e.input.classList.add("flatpickr-input"),e._input=e.input,e.config.altInput&&(e.altInput=q(e.input.nodeName,e.config.altInputClass),e._input=e.altInput,e.altInput.placeholder=e.input.placeholder,e.altInput.disabled=e.input.disabled,e.altInput.required=e.input.required,e.altInput.tabIndex=e.input.tabIndex,e.altInput.type="text",e.input.setAttribute("type","hidden"),!e.config.static&&e.input.parentNode&&e.input.parentNode.insertBefore(e.altInput,e.input.nextSibling)),e.config.allowInput||e._input.setAttribute("readonly","readonly"),Pi()}function Pi(){e._positionElement=e.config.positionElement||e._input}function ua(){var h=e.config.enableTime?e.config.noCalendar?"time":"datetime-local":"date";e.mobileInput=q("input",e.input.className+" flatpickr-mobile"),e.mobileInput.tabIndex=1,e.mobileInput.type=h,e.mobileInput.disabled=e.input.disabled,e.mobileInput.required=e.input.required,e.mobileInput.placeholder=e.input.placeholder,e.mobileFormatStr=h==="datetime-local"?"Y-m-d\\TH:i:S":h==="date"?"Y-m-d":"H:i:S",e.selectedDates.length>0&&(e.mobileInput.defaultValue=e.mobileInput.value=e.formatDate(e.selectedDates[0],e.mobileFormatStr)),e.config.minDate&&(e.mobileInput.min=e.formatDate(e.config.minDate,"Y-m-d")),e.config.maxDate&&(e.mobileInput.max=e.formatDate(e.config.maxDate,"Y-m-d")),e.input.getAttribute("step")&&(e.mobileInput.step=String(e.input.getAttribute("step"))),e.input.type="hidden",e.altInput!==void 0&&(e.altInput.type="hidden");try{e.input.parentNode&&e.input.parentNode.insertBefore(e.mobileInput,e.input.nextSibling)}catch{}d(e.mobileInput,"change",function(g){e.setDate(Se(g).value,!1,e.mobileFormatStr),ee("onChange"),ee("onClose")})}function fa(h){if(e.isOpen===!0)return e.close();e.open(h)}function ee(h,g){if(e.config!==void 0){var x=e.config[h];if(x!==void 0&&x.length>0)for(var M=0;x[M]&&M<x.length;M++)x[M](e.selectedDates,e.input.value,e,g);h==="onChange"&&(e.input.dispatchEvent(Mn("change")),e.input.dispatchEvent(Mn("input")))}}function Mn(h){var g=document.createEvent("Event");return g.initEvent(h,!0,!0),g}function Dn(h){for(var g=0;g<e.selectedDates.length;g++){var x=e.selectedDates[g];if(x instanceof Date&&Ee(x,h)===0)return""+g}return!1}function da(h){return e.config.mode!=="range"||e.selectedDates.length<2?!1:Ee(h,e.selectedDates[0])>=0&&Ee(h,e.selectedDates[1])<=0}function rn(){e.config.noCalendar||e.isMobile||!e.monthNav||(e.yearElements.forEach(function(h,g){var x=new Date(e.currentYear,e.currentMonth,1);x.setMonth(e.currentMonth+g),e.config.showMonths>1||e.config.monthSelectorType==="static"?e.monthElements[g].textContent=_n(x.getMonth(),e.config.shorthandCurrentMonth,e.l10n)+" ":e.monthsDropdownContainer.value=x.getMonth().toString(),h.value=x.getFullYear().toString()}),e._hidePrevMonthArrow=e.config.minDate!==void 0&&(e.currentYear===e.config.minDate.getFullYear()?e.currentMonth<=e.config.minDate.getMonth():e.currentYear<e.config.minDate.getFullYear()),e._hideNextMonthArrow=e.config.maxDate!==void 0&&(e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth+1>e.config.maxDate.getMonth():e.currentYear>e.config.maxDate.getFullYear()))}function Cn(h){var g=h||(e.config.altInput?e.config.altFormat:e.config.dateFormat);return e.selectedDates.map(function(x){return e.formatDate(x,g)}).filter(function(x,M,O){return e.config.mode!=="range"||e.config.enableTime||O.indexOf(x)===M}).join(e.config.mode!=="range"?e.config.conjunction:e.l10n.rangeSeparator)}function Ue(h){h===void 0&&(h=!0),e.mobileInput!==void 0&&e.mobileFormatStr&&(e.mobileInput.value=e.latestSelectedDateObj!==void 0?e.formatDate(e.latestSelectedDateObj,e.mobileFormatStr):""),e.input.value=Cn(e.config.dateFormat),e.altInput!==void 0&&(e.altInput.value=Cn(e.config.altFormat)),h!==!1&&ee("onValueUpdate")}function ha(h){var g=Se(h),x=e.prevMonthNav.contains(g),M=e.nextMonthNav.contains(g);x||M?oe(x?-1:1):e.yearElements.indexOf(g)>=0?g.select():g.classList.contains("arrowUp")?e.changeYear(e.currentYear+1):g.classList.contains("arrowDown")&&e.changeYear(e.currentYear-1)}function ma(h){h.preventDefault();var g=h.type==="keydown",x=Se(h),M=x;e.amPM!==void 0&&x===e.amPM&&(e.amPM.textContent=e.l10n.amPM[Re(e.amPM.textContent===e.l10n.amPM[0])]);var O=parseFloat(M.getAttribute("min")),L=parseFloat(M.getAttribute("max")),U=parseFloat(M.getAttribute("step")),N=parseInt(M.value,10),W=h.delta||(g?h.which===38?1:-1:0),R=N+U*W;if(typeof M.value<"u"&&M.value.length===2){var H=M===e.hourElement,K=M===e.minuteElement;R<O?(R=L+R+Re(!H)+(Re(H)&&Re(!e.amPM)),K&&D(void 0,-1,e.hourElement)):R>L&&(R=M===e.hourElement?R-L-Re(!e.amPM):O,K&&D(void 0,1,e.hourElement)),e.amPM&&H&&(U===1?R+N===23:Math.abs(R-N)>U)&&(e.amPM.textContent=e.l10n.amPM[Re(e.amPM.textContent===e.l10n.amPM[0])]),M.value=ye(R)}}return i(),e}function It(o,t){for(var e=Array.prototype.slice.call(o).filter(function(a){return a instanceof HTMLElement}),n=[],i=0;i<e.length;i++){var r=e[i];try{if(r.getAttribute("data-fp-omit")!==null)continue;r._flatpickr!==void 0&&(r._flatpickr.destroy(),r._flatpickr=void 0),r._flatpickr=lo(r,t||{}),n.push(r._flatpickr)}catch(a){console.error(a)}}return n.length===1?n[0]:n}typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(o){return It(this,o)},HTMLElement.prototype.flatpickr=function(o){return It([this],o)});var se=function(o,t){return typeof o=="string"?It(window.document.querySelectorAll(o),t):o instanceof Node?It([o],t):It(o,t)};se.defaultConfig={};se.l10ns={en:de({},Qt),default:de({},Qt)};se.localize=function(o){se.l10ns.default=de(de({},se.l10ns.default),o)};se.setDefaults=function(o){se.defaultConfig=de(de({},se.defaultConfig),o)};se.parseDate=ai({});se.formatDate=Zr({});se.compareDates=Ee;typeof jQuery<"u"&&typeof jQuery.fn<"u"&&(jQuery.fn.flatpickr=function(o){return It(this,o)});Date.prototype.fp_incr=function(o){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof o=="string"?parseInt(o,10):o))};typeof window<"u"&&(window.flatpickr=se);class co{constructor(){this.audioHandler=La.getInstance(),this.marketDataService=new Ra,this.mask=null,this.picker=null,this.ui={datePickerInput:document.getElementById("date-picker"),btnToday:document.getElementById("btn-today"),marketInfo:document.getElementById("market-info"),valSentiment:document.getElementById("val-mood-state"),valFearGreed:document.getElementById("risk-val"),valVix:document.getElementById("val-vix"),headlinesContainer:document.getElementById("headlines-container")},this.init()}async init(){await this.marketDataService.init();const t=Object.keys(this.marketDataService.dataMap||{});t.length===0&&console.error("Critical: No market data found for calendar."),this.picker=se(this.ui.datePickerInput,{dateFormat:"Y-m-d",defaultDate:t.sort().pop()||"today",theme:"dark",disable:[n=>{const i=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),s=`${i}-${r}-${a}`;return this.marketDataService.dataMap?!this.marketDataService.dataMap[s]:!0}],onChange:n=>{n.length>0&&this.loadDate(n[0])}}),this.ui.timelineSlider=document.getElementById("timeline-slider"),this.ui.timelineStart=document.getElementById("timeline-start"),this.ui.timelineCurrent=document.getElementById("timeline-current"),this.ui.timelineCanvas=document.getElementById("timeline-canvas"),this.ui.btnPlay=document.getElementById("btn-play"),this.ui.modelSelect=document.getElementById("model-select"),this.isPlaying=!1,this.playInterval=null,this.ui.timelineSlider&&(this.ui.timelineSlider.min=0,this.ui.timelineSlider.max=t.length-1,this.ui.timelineStart.textContent=t[0],this.drawTimeline(t),this.ui.timelineSlider.addEventListener("input",n=>{this.stopPlay();const i=parseInt(n.target.value),r=t.sort()[i];r&&(this.picker.setDate(new Date(r+"T00:00:00"),!1),this.loadDate(new Date(r+"T00:00:00")))}),this.ui.btnPlay&&this.ui.btnPlay.addEventListener("click",()=>this.togglePlay(t))),this.ui.modelSelect&&this.ui.modelSelect.addEventListener("change",n=>{this.mask&&this.mask.changeModel(n.target.value)}),console.log("[AppController] About to call setupEventListeners"),this.setupEventListeners(),console.log("[AppController] setupEventListeners completed");const e=t.sort().pop();e?this.picker.setDate(e,!0):this.loadDate(new Date)}drawTimeline(t){if(!this.ui.timelineCanvas||!this.marketDataService.dataMap)return;const e=this.ui.timelineCanvas,n=e.getContext("2d"),i=e.parentElement.offsetWidth,r=e.parentElement.offsetHeight,a=window.devicePixelRatio||1;e.width=i*a,e.height=r*a,n.scale(a,a);const s=t.map(p=>this.marketDataService.dataMap[p]),c=s.length,u=i/c;n.fillStyle="rgba(0,0,0,0.2)",n.fillRect(0,0,i,r),n.strokeStyle="rgba(255,255,255,0.05)",n.lineWidth=1,n.beginPath();for(let p=1;p<4;p++){const _=r/4*p;n.moveTo(0,_),n.lineTo(i,_)}if(n.stroke(),c===0)return;s.forEach((p,_)=>{if(!p)return;const d=p.intradayRange||.5,v=p.fearGreedIndex||50,y=Math.min(1,d/3)*r,w=_*u,b=Math.max(1,u-.5);let D,k,C;v<50?(D=255,k=Math.floor(v/50*255),C=0):(D=Math.floor((100-v)/50*255),k=255,C=0),n.fillStyle=`rgba(${D}, ${k}, ${C}, 0.5)`,n.fillRect(w,r-y,b,y)});const l=10,f=60,m=p=>r-(Math.min(f,Math.max(l,p))-l)/(f-l)*(r*.9);n.strokeStyle="#ffffff",n.lineWidth=2.5,n.lineJoin=n.lineCap="round",n.beginPath(),s.forEach((p,_)=>{if(!p)return;const d=_*u+u/2,v=m(p.vix||15);_===0?n.moveTo(d,v):n.lineTo(d,v)}),n.stroke()}togglePlay(t){this.isPlaying?this.stopPlay():this.startPlay(t)}startPlay(t){this.isPlaying||(this.isPlaying=!0,this.ui.btnPlay.textContent="",this.playInterval=setInterval(()=>{let e=parseInt(this.ui.timelineSlider.value);e>=t.length-1&&(e=-1),this.ui.timelineSlider.value=++e;const n=t.sort()[e],i=new Date(n+"T00:00:00");this.picker.setDate(i,!1),this.loadDate(i)},200))}stopPlay(){this.isPlaying=!1,this.ui.btnPlay.textContent="",this.playInterval&&clearInterval(this.playInterval)}setupEventListeners(){this.ui.btnToday&&this.ui.btnToday.addEventListener("click",()=>{this.stopPlay(),this.picker.setDate(new Date,!0)}),this.initCommandSearch()}initCommandSearch(){console.log("[CommandSearch] Initializing...");const t=document.getElementById("command-search-overlay"),e=document.getElementById("command-search-modal"),n=document.getElementById("command-search-input"),i=document.getElementById("search-results"),r=document.getElementById("btn-search");if(console.log("[CommandSearch] Elements found:",{overlay:!!t,modal:!!e,input:!!n,resultsContainer:!!i,searchButton:!!r}),!t||!n){console.error("[CommandSearch] Required elements not found! Aborting.");return}this.searchState={isOpen:!1,selectedIndex:-1,results:[],activeFilter:null},r&&(console.log("[CommandSearch] Adding click listener to search button"),r.addEventListener("click",()=>{console.log("[CommandSearch] Search button clicked!"),this.openCommandSearch()})),document.addEventListener("keydown",a=>{(a.metaKey||a.ctrlKey)&&a.key==="k"&&(a.preventDefault(),this.toggleCommandSearch()),a.key==="Escape"&&this.searchState.isOpen&&this.closeCommandSearch(),this.searchState.isOpen&&(a.key==="ArrowDown"?(a.preventDefault(),this.navigateSearchResults(1)):a.key==="ArrowUp"?(a.preventDefault(),this.navigateSearchResults(-1)):a.key==="Enter"&&(a.preventDefault(),this.executeSelectedResult()))}),t.addEventListener("click",a=>{a.target===t&&this.closeCommandSearch()}),n.addEventListener("input",a=>{console.log("[CommandSearch] Input changed:",a.target.value),this.handleSearchInput(a.target.value)}),document.querySelectorAll(".hint-item").forEach(a=>{a.addEventListener("click",()=>{n.value=a.dataset.query,this.handleSearchInput(a.dataset.query)})}),document.querySelectorAll(".result-item[data-action]").forEach(a=>{a.addEventListener("click",()=>{this.executeQuickAction(a.dataset.action)})}),document.querySelectorAll(".sector-chip").forEach(a=>{a.addEventListener("click",()=>{this.filterBySector(a.dataset.sector),a.classList.toggle("active")})}),document.querySelectorAll(".condition-item").forEach(a=>{a.addEventListener("click",()=>{this.filterByCondition(a.dataset.condition)})})}toggleCommandSearch(){this.searchState.isOpen?this.closeCommandSearch():this.openCommandSearch()}openCommandSearch(){const t=document.getElementById("command-search-overlay"),e=document.getElementById("command-search-input");t.classList.remove("hidden"),this.searchState.isOpen=!0,setTimeout(()=>e.focus(),100),this.stopPlay()}closeCommandSearch(){const t=document.getElementById("command-search-overlay"),e=document.getElementById("command-search-input");t.classList.add("hidden"),this.searchState.isOpen=!1,e.value="",this.searchState.selectedIndex=-1,this.resetSearchResults()}resetSearchResults(){document.querySelectorAll(".search-section").forEach(e=>e.style.display="block");const t=document.querySelector(".dynamic-results");t&&t.remove(),document.querySelectorAll(".result-item.selected").forEach(e=>{e.classList.remove("selected")})}handleSearchInput(t){var c,u;if(console.log("[handleSearchInput] Called with:",t),t=t.trim().toLowerCase(),!t){this.resetSearchResults();return}const e=[],n=Object.keys(this.marketDataService.dataMap||{}).sort();console.log("[handleSearchInput] Valid dates count:",n.length);const i=l=>(l==null?void 0:l.marketChangePercent)??(l==null?void 0:l.dailyChange)??(l==null?void 0:l.percentChange)??0,r=this.generateSmartSuggestions(t,n);console.log("[handleSearchInput] Suggestions:",r.length);const a=this.parseDateQuery(t);if(a){const l=this.marketDataService.dataMap[a];l&&e.push({type:"date",date:a,label:` ${a} - NASDAQ ${((c=l.indexValue)==null?void 0:c.toLocaleString())||"--"}`,change:i(l),extra:`VIX: ${((u=l.vix)==null?void 0:u.toFixed(1))||"--"} | F&G: ${l.fearGreedIndex||"--"}`})}if(t.match(/highest|peak|best|top|max|record/)){const l=this.findExtremes("highest",t,n,i);e.push(...l.slice(0,8))}if(t.match(/lowest|valley|worst|bottom|min|crash|dip/)){const l=this.findExtremes("lowest",t,n,i);e.push(...l.slice(0,8))}const s=t.match(/(nasdaq|sp|s&p|dow|djia)\s*(?:at|near|hits?|reached?|crossed?)?\s*(\d{3,6})/i);if(s){const l=this.findByIndexValue(s[1],parseInt(s[2]),n,i);e.push(...l.slice(0,8))}if(t.match(/vix|volatil|spike|calm|stable/)){const l=this.searchByVIX(t,n,i);e.push(...l.slice(0,8))}if(t.match(/fear|greed|panic|euphori|sentiment/)){const l=this.searchByFearGreed(t,n,i);e.push(...l.slice(0,8))}if(t.match(/gain|loss|rally|crash|selloff|drop|surge|jump|biggest|largest|green|red|\+\d|\-\d|\d%/)){const l=this.searchByChange(t,n,i);e.push(...l.slice(0,8))}if(t.match(/tech|financ|energy|health|industrial|utility|material|consumer|real estate|communication/)){const l=this.searchBySector(t,n,i);e.push(...l.slice(0,8))}if(t.match(/today|yesterday|last week|this month|this year|recent|latest|q1|q2|q3|q4/)){const l=this.searchByTimeframe(t,n,i);e.push(...l.slice(0,8))}if(t.match(/yield|inverted|bond|treasury|rate|10y|2y|spread/)){const l=this.searchByYield(t,n,i);e.push(...l.slice(0,8))}if(t.match(/volatile|swing|whipsaw|range|breakout|consolidat/)){const l=this.searchByVolatilityPattern(t,n,i);e.push(...l.slice(0,8))}if(t.match(/streak|consecutive|row|days up|days down|winning|losing/)){const l=this.findStreaks(t,n,i);e.push(...l.slice(0,8))}if(t.match(/vs|versus|compare|outperform|underperform|beat|lag/)){const l=this.searchByComparison(t,n,i);e.push(...l.slice(0,8))}console.log("[handleSearchInput] Final results:",e.length,"suggestions:",r.length),this.displaySearchResults(e,r)}generateSmartSuggestions(t,e){const n=t.toLowerCase();return[{trigger:"high",text:" Highest NASDAQ day",action:"highest nasdaq"},{trigger:"high",text:" Highest S&P 500 day",action:"highest sp500"},{trigger:"low",text:" Lowest NASDAQ day",action:"lowest nasdaq"},{trigger:"low",text:" Lowest S&P 500 day",action:"lowest sp500"},{trigger:"peak",text:" Market peak (all-time high)",action:"peak nasdaq"},{trigger:"valley",text:" Market valley (bottom)",action:"valley nasdaq"},{trigger:"crash",text:" Biggest crash day",action:"biggest crash"},{trigger:"rally",text:" Biggest rally day",action:"biggest rally"},{trigger:"vix",text:" VIX spike days (>30)",action:"vix > 30"},{trigger:"vix",text:" Low VIX days (<15)",action:"vix < 15"},{trigger:"fear",text:" Extreme fear days",action:"extreme fear"},{trigger:"greed",text:" Extreme greed days",action:"extreme greed"},{trigger:"nasd",text:" NASDAQ at specific value...",action:"nasdaq "},{trigger:"sp",text:" S&P 500 at specific value...",action:"sp500 "},{trigger:"s&p",text:" S&P 500 at specific value...",action:"sp500 "},{trigger:"best",text:" Best performing day",action:"best day"},{trigger:"worst",text:" Worst performing day",action:"worst day"},{trigger:"streak",text:" Winning streaks",action:"winning streak"},{trigger:"streak",text:" Losing streaks",action:"losing streak"},{trigger:"volatile",text:" Most volatile days",action:"most volatile"},{trigger:"tech",text:" Tech sector performance",action:"tech sector"},{trigger:"financ",text:" Financials sector",action:"financial sector"},{trigger:"energy",text:" Energy sector",action:"energy sector"},{trigger:"yield",text:" Inverted yield curve days",action:"inverted yield"},{trigger:"today",text:" Today's data",action:"today"},{trigger:"last",text:" Last week",action:"last week"},{trigger:"recent",text:" Recent trading days",action:"recent"},{trigger:"+",text:" Days with gains over...",action:"gain > "},{trigger:"-",text:" Days with losses over...",action:"loss > "},{trigger:"record",text:" Record high days",action:"record high"},{trigger:"panic",text:" Panic selling days",action:"panic"},{trigger:"euphori",text:" Euphoria days",action:"euphoria"}].filter(r=>n.length>0&&r.trigger.startsWith(n.substring(0,Math.min(n.length,r.trigger.length)))).slice(0,5)}parseDateQuery(t){const e=t.match(/(\d{4}-\d{2}-\d{2})/);if(e&&this.marketDataService.dataMap[e[1]])return e[1];const n=["january","february","march","april","may","june","july","august","september","october","november","december"],i=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];for(let r=0;r<n.length;r++){const a=new RegExp(`(${n[r]}|${i[r]})\\s*(\\d{1,2})(?:,?\\s*(\\d{4}))?`,"i"),s=t.match(a);if(s){const c=String(r+1).padStart(2,"0"),u=String(s[2]).padStart(2,"0"),f=`${s[3]||new Date().getFullYear()}-${c}-${u}`;if(this.marketDataService.dataMap[f])return f}}return null}findExtremes(t,e,n,i){const r=[];let a="indexValue",s="NASDAQ";e.match(/sp|s&p|500/)?(a="sp500Value",s="S&P 500"):e.match(/dow|djia/)?(a="dowValue",s="DOW"):e.match(/vix/)?(a="vix",s="VIX"):e.match(/gain|change|rally|move/)&&(a="marketChangePercent",s="Daily Change");let c=null,u=t==="highest"?-1/0:1/0;for(const f of n){const m=this.marketDataService.dataMap[f],p=(m==null?void 0:m[a])??0;(t==="highest"&&p>u||t==="lowest"&&p<u)&&(u=p,c=f)}if(c){const f=this.marketDataService.dataMap[c],m=a==="marketChangePercent"?`${u>=0?"+":""}${u.toFixed(2)}%`:u.toLocaleString();r.push({type:"extreme",date:c,label:`${t==="highest"?"":""} ${t.toUpperCase()} ${s}: ${m} on ${c}`,change:i(f),value:u})}const l=n.map(f=>{var m;return{date:f,data:this.marketDataService.dataMap[f],value:((m=this.marketDataService.dataMap[f])==null?void 0:m[a])??0}}).filter(f=>f.value!==0).sort((f,m)=>t==="highest"?m.value-f.value:f.value-m.value).slice(0,5);for(const f of l)if(f.date!==c){const m=a==="marketChangePercent"?`${f.value>=0?"+":""}${f.value.toFixed(2)}%`:f.value.toLocaleString();r.push({type:"extreme",date:f.date,label:`${s}: ${m} on ${f.date}`,change:i(f.data),value:f.value})}return r}findByIndexValue(t,e,n,i){const r=[];let a="indexValue",s="NASDAQ";t.match(/sp|s&p/i)?(a="sp500Value",s="S&P 500"):t.match(/dow|djia/i)&&(a="dowValue",s="DOW");const c=e*.01;for(const u of n){const l=this.marketDataService.dataMap[u],f=(l==null?void 0:l[a])??0;Math.abs(f-e)<=c&&r.push({type:"value-match",date:u,label:` ${s} at ${f.toLocaleString()} on ${u}`,change:i(l),value:f,diff:Math.abs(f-e)})}if(r.sort((u,l)=>u.diff-l.diff),r.length===0){const u=n.map(l=>{var f,m;return{date:l,data:this.marketDataService.dataMap[l],value:((f=this.marketDataService.dataMap[l])==null?void 0:f[a])??0,diff:Math.abs((((m=this.marketDataService.dataMap[l])==null?void 0:m[a])??0)-e)}}).filter(l=>l.value>0).sort((l,f)=>l.diff-f.diff).slice(0,5);for(const l of u)r.push({type:"value-near",date:l.date,label:` ${s} at ${l.value.toLocaleString()} (target: ${e.toLocaleString()})`,change:i(l.data),value:l.value})}return r}searchByVIX(t,e,n){const i=[];let r=20,a=">";const s=t.match(/vix\s*([<>]=?)\s*(\d+)/i);s?(a=s[1],r=parseFloat(s[2])):t.match(/high|spike|fear|panic/)?(r=25,a=">"):t.match(/low|calm|stable|quiet/)&&(r=15,a="<");for(const c of e){const u=this.marketDataService.dataMap[c],l=(u==null?void 0:u.vix)||0;let f=!1;a===">"&&l>r&&(f=!0),a===">="&&l>=r&&(f=!0),a==="<"&&l<r&&(f=!0),a==="<="&&l<=r&&(f=!0),f&&i.push({type:"vix",date:c,label:` VIX ${l.toFixed(1)} on ${c}`,change:n(u),vix:l})}return i.sort((c,u)=>a.includes(">")?u.vix-c.vix:c.vix-u.vix),i}searchByFearGreed(t,e,n){const i=[];let r=0,a=100;t.match(/extreme fear|panic/)?(r=0,a=25):t.match(/fear/)?(r=0,a=45):t.match(/extreme greed|euphori/)?(r=75,a=100):t.match(/greed/)?(r=55,a=100):t.match(/neutral/)&&(r=40,a=60);for(const s of e){const c=this.marketDataService.dataMap[s],u=(c==null?void 0:c.fearGreedIndex)??50;if(u>=r&&u<=a){const l=u<25?"":u<45?"":u<55?"":u<75?"":"";i.push({type:"feargreed",date:s,label:`${l} F&G ${u} on ${s}`,change:n(c),fg:u})}}return t.match(/fear|panic/)?i.sort((s,c)=>s.fg-c.fg):i.sort((s,c)=>c.fg-s.fg),i}searchByChange(t,e,n){const i=[];for(const r of e){const a=this.marketDataService.dataMap[r],s=n(a);i.push({type:"change",date:r,label:`${s>=0?"":""} ${s>=0?"+":""}${s.toFixed(2)}% on ${r}`,change:s})}return t.match(/gain|rally|surge|jump|green|best|top|\+/)?i.sort((r,a)=>a.change-r.change):i.sort((r,a)=>r.change-a.change),i}searchBySector(t,e,n){var s;const i=[],r={tech:{symbol:"XLK",name:"Technology"},financ:{symbol:"XLF",name:"Financials"},energy:{symbol:"XLE",name:"Energy"},health:{symbol:"XLV",name:"Healthcare"},industrial:{symbol:"XLI",name:"Industrials"},utility:{symbol:"XLU",name:"Utilities"},material:{symbol:"XLB",name:"Materials"},consumer:{symbol:"XLY",name:"Consumer"},"real estate":{symbol:"XLRE",name:"Real Estate"},communication:{symbol:"XLC",name:"Communication"}};let a=null;for(const[c,u]of Object.entries(r))if(t.includes(c)){a=u;break}if(!a)return i;for(const c of e){const u=this.marketDataService.dataMap[c],l=(s=u==null?void 0:u.sectors)==null?void 0:s.find(f=>f.symbol===a.symbol);if(l){const f=l.change??0;i.push({type:"sector",date:c,label:` ${a.name} ${f>=0?"+":""}${f.toFixed(2)}% on ${c}`,change:n(u),sectorChange:f})}}return i.sort((c,u)=>Math.abs(u.sectorChange)-Math.abs(c.sectorChange)),i}searchByTimeframe(t,e,n){var c;const i=[],r=new Date;let a=null,s=r;if(t.includes("today")?a=r:t.includes("yesterday")?(a=new Date(r),a.setDate(a.getDate()-1),s=a):t.includes("last week")?(a=new Date(r),a.setDate(a.getDate()-7)):t.includes("this month")?a=new Date(r.getFullYear(),r.getMonth(),1):(t.includes("recent")||t.includes("latest"))&&(a=new Date(r),a.setDate(a.getDate()-5)),!a)return i;for(const u of e.reverse()){const l=new Date(u+"T00:00:00");if(l>=a&&l<=s){const f=this.marketDataService.dataMap[u];i.push({type:"timeframe",date:u,label:` ${u} - NASDAQ ${((c=f==null?void 0:f.indexValue)==null?void 0:c.toLocaleString())||"--"}`,change:n(f)})}if(i.length>=10)break}return i}searchByYield(t,e,n){const i=[];for(const r of e){const a=this.marketDataService.dataMap[r],s=a==null?void 0:a.yieldCurve;if(s){const c=(s.y10??0)-(s.y2??s.y3m??0),u=c<0;t.includes("invert")&&u?i.push({type:"yield",date:r,label:` Inverted curve (spread: ${c.toFixed(2)}%) on ${r}`,change:n(a),spread:c}):t.includes("invert")||i.push({type:"yield",date:r,label:` Yield spread: ${c.toFixed(2)}% on ${r}`,change:n(a),spread:c})}}return i.sort((r,a)=>r.spread-a.spread),i}searchByVolatilityPattern(t,e,n){const i=[];for(let r=5;r<e.length;r++){const s=e.slice(r-5,r).map(u=>Math.abs(n(this.marketDataService.dataMap[u]))),c=s.reduce((u,l)=>u+l,0)/s.length;if(c>1.5){const u=this.marketDataService.dataMap[e[r]];i.push({type:"volatility",date:e[r],label:` High volatility period (avg ${c.toFixed(2)}%) on ${e[r]}`,change:n(u),volatility:c})}}return i.sort((r,a)=>a.volatility-r.volatility),i}findStreaks(t,e,n){const i=[];let r=0,a=t.includes("winning")||t.includes("up")?"up":"down";for(let s=0;s<e.length;s++){const u=n(this.marketDataService.dataMap[e[s]])>0;a==="up"&&u||a==="down"&&!u?(r===0&&e[s],r++):(r>=3&&i.push({type:"streak",date:e[s-1],label:`${a==="up"?"":""} ${r}-day ${a==="up"?"winning":"losing"} streak ending ${e[s-1]}`,change:n(this.marketDataService.dataMap[e[s-1]]),streakLength:r}),r=0)}return i.sort((s,c)=>c.streakLength-s.streakLength),i}searchByComparison(t,e,n){const i=[];for(const r of e){const a=this.marketDataService.dataMap[r],s=(a==null?void 0:a.marketChangePercent)??0,c=(a==null?void 0:a.sp500Change)??0,u=s-c;t.includes("outperform")&&u>.5?i.push({type:"compare",date:r,label:` NASDAQ outperformed S&P by ${u.toFixed(2)}% on ${r}`,change:n(a),diff:u}):t.includes("underperform")&&u<-.5&&i.push({type:"compare",date:r,label:` NASDAQ underperformed S&P by ${Math.abs(u).toFixed(2)}% on ${r}`,change:n(a),diff:u})}return i.sort((r,a)=>Math.abs(a.diff)-Math.abs(r.diff)),i}displaySearchResults(t,e=[]){const n=document.getElementById("search-results"),i=document.getElementById("command-search-input");(t.length>0||e.length>0)&&document.querySelectorAll(".search-section").forEach(u=>u.style.display="none");const r=document.querySelector(".dynamic-results");r&&r.remove();const a=document.createElement("div");a.className="dynamic-results";let s="";if(e.length>0&&(s=`
                <div class="suggestions-section">
                    <div class="section-label"> SUGGESTIONS</div>
                    ${e.map(u=>`
                        <div class="suggestion-item" data-action="${u.action}">
                            ${u.text}
                        </div>
                    `).join("")}
                </div>
            `),t.length===0&&e.length===0){a.innerHTML='<div class="no-results">No matches found. Try: "highest nasdaq", "vix > 25", "crash days"</div>',n.appendChild(a);return}const c=t.length>0?`
            <div class="search-section">
                <div class="section-label"> RESULTS (${t.length})</div>
                ${t.slice(0,10).map((u,l)=>{const f=u.change??0,m=f>=0;return`
                        <div class="result-item ${l===0?"selected":""}" data-date="${u.date}">
                            <span class="result-label">${u.label}</span>
                            <span class="change-badge ${m?"positive":"negative"}">
                                ${m?"+":""}${f.toFixed(2)}%
                            </span>
                        </div>
                    `}).join("")}
            </div>
        `:"";a.innerHTML=s+c,n.appendChild(a),a.querySelectorAll(".suggestion-item").forEach(u=>{u.addEventListener("click",()=>{i.value=u.dataset.action,this.handleSearchInput(u.dataset.action)})}),a.querySelectorAll(".result-item").forEach(u=>{u.addEventListener("click",()=>{const l=u.dataset.date;l&&(this.navigateToDate(l),this.closeCommandSearch())})}),this.searchState.results=t,this.searchState.selectedIndex=t.length>0?0:-1}navigateSearchResults(t){const e=document.querySelectorAll(".dynamic-results .result-item, .search-results .result-item[data-action]");e.length!==0&&(e.forEach(n=>n.classList.remove("selected")),this.searchState.selectedIndex+=t,this.searchState.selectedIndex<0&&(this.searchState.selectedIndex=e.length-1),this.searchState.selectedIndex>=e.length&&(this.searchState.selectedIndex=0),e[this.searchState.selectedIndex].classList.add("selected"),e[this.searchState.selectedIndex].scrollIntoView({block:"nearest"}))}executeSelectedResult(){const t=document.querySelector(".result-item.selected");t&&(t.dataset.date?(this.navigateToDate(t.dataset.date),this.closeCommandSearch()):t.dataset.action&&this.executeQuickAction(t.dataset.action))}executeQuickAction(t){var i,r,a,s,c;const e=Object.keys(this.marketDataService.dataMap||{}).sort();let n=null;switch(t){case"biggest-gain":let u=-1/0;for(const m of e){const p=((i=this.marketDataService.dataMap[m])==null?void 0:i.dailyChange)||0;p>u&&(u=p,n=m)}break;case"biggest-loss":let l=1/0;for(const m of e){const p=((r=this.marketDataService.dataMap[m])==null?void 0:r.dailyChange)||0;p<l&&(l=p,n=m)}break;case"highest-vix":let f=0;for(const m of e){const p=((a=this.marketDataService.dataMap[m])==null?void 0:a.vix)||0;p>f&&(f=p,n=m)}break;case"extreme-fear":for(const m of e.reverse())if((((s=this.marketDataService.dataMap[m])==null?void 0:s.fearGreedIndex)??50)<25){n=m;break}break;case"extreme-greed":for(const m of e.reverse())if((((c=this.marketDataService.dataMap[m])==null?void 0:c.fearGreedIndex)??50)>75){n=m;break}break}n&&(this.navigateToDate(n),this.closeCommandSearch())}filterBySector(t){const e=document.getElementById("command-search-input");e.value=`sector:${t}`,this.handleSearchInput(e.value)}filterByCondition(t){const e=document.getElementById("command-search-input");if(t.includes("change"))t.includes("-gt-")?e.value="biggest gains":t.includes("-lt-")&&(e.value="biggest losses");else if(t.includes("vix")){const n=t.match(/vix-gt-(\d+)/),i=t.match(/vix-lt-(\d+)/);n?e.value=`vix > ${n[1]}`:i&&(e.value=`vix < ${i[1]}`)}this.handleSearchInput(e.value)}navigateToDate(t){const e=new Date(t+"T00:00:00");this.picker.setDate(e,!1),this.loadDate(e);const i=Object.keys(this.marketDataService.dataMap||{}).sort().indexOf(t);i>=0&&this.ui.timelineSlider&&(this.ui.timelineSlider.value=i)}loadDate(t){const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),r=`${e}-${n}-${i}`,a=this.marketDataService.getDataForDate(t);this.updateUI(a,!a||a.regime==="Data Missing",r),this.updateVisuals(a)}updateUI(t,e,n){console.log("[updateUI] CALLED with data:",t?t.date:"NONE");const i=document.getElementById("market-status");i&&(i.classList.toggle("hidden",!e),e&&(i.textContent=`Market Closed on ${n}. Data from ${t.date}`)),document.getElementById("val-index").textContent=t.indexValue.toLocaleString();const r=document.getElementById("val-change");r.textContent=(t.marketChangePercent>0?"+":"")+t.marketChangePercent+"%",r.className="change-pill "+(t.marketChangePercent>=0?"positive":"negative");const a=document.getElementById("val-sp500");a.textContent=t.sp500Value?t.sp500Value.toLocaleString():"--";const s=document.getElementById("val-sp500-change");if(s.textContent=t.sp500Value?(t.sp500Change>0?"+":"")+t.sp500Change+"%":"--%",s.className="change-pill "+(t.sp500Change>=0?"positive":"negative"),this.ui.marketInfo.classList.remove("hidden"),this.ui.valSentiment){this.ui.valSentiment.textContent=t.moodState?t.moodState.toUpperCase():"NEUTRAL";let c="#ffffff";const u=(t.moodState||"").toLowerCase();u.includes("panic")||u.includes("fear")||u.includes("bear")?c="#ff5050":u.includes("greed")||u.includes("euphoria")||u.includes("bull")?c="#00ffaa":u.includes("anxiety")&&(c="#ffcc00"),this.ui.valSentiment.style.color=c;const l=document.getElementById("val-regime");if(l&&t.regime&&(l.textContent=t.regime+" Regime"),this.ui.yield&&(this.ui.yield.textContent=t.yield10y),this.ui.valVix){this.ui.valVix.textContent=t.vix;const b=parseFloat(t.vix);isNaN(b)||(b<18?this.ui.valVix.style.color="#00ffaa":b>25?this.ui.valVix.style.color="#ff5050":this.ui.valVix.style.color="#ffffff")}const f=document.getElementById("val-volume");if(f){const b=t.volume||0;f.textContent=b>1e9?(b/1e9).toFixed(1)+"B":(b/1e6).toFixed(1)+"M"}this.ui.range52w&&(this.ui.range52w.textContent=t.range52w||"15222.78 - 20204.58");const m=t.fearGreedIndex||50;let p="NEUTRAL",_="#ffffff";if(m<=25?(p=`EXTREME FEAR (${m})`,_="#ff5050"):m<=45?(p=`FEAR (${m})`,_="#ffaa50"):m<=55?(p=`NEUTRAL (${m})`,_="#ffffff"):m<=75?(p=`GREED (${m})`,_="#50ffaa"):(p=`EXTREME GREED (${m})`,_="#00ffaa"),this.ui.valSentiment){this.ui.valSentiment.textContent=p,this.ui.valSentiment.style.color=_,this.ui.valSentiment.style.fontWeight="bold";const b=document.getElementById("val-regime");b&&(b.textContent="CNN Fear & Greed Index",b.style.fontSize="0.7em",b.style.opacity="0.7")}const d=document.getElementById("val-day-range");d&&(d.textContent=t.dayLow?`${t.dayLow} - ${t.dayHigh}`:"--");const v=document.getElementById("val-52w-range");if(v&&(v.textContent=t.yearLow?`${t.yearLow} - ${t.yearHigh}`:"--"),this.ui.timelineSlider&&this.marketDataService.dataMap){const D=Object.keys(this.marketDataService.dataMap).sort().indexOf(t.date);D!==-1&&(this.ui.timelineSlider.value=D,this.ui.timelineCurrent.textContent=t.date)}this.ui.headlinesContainer.innerHTML="",t.headlines.forEach(b=>{const D=typeof b=="object"&&b!==null,k=D?b.title:b,C=D?b.link:"#",T=document.createElement("p");T.style.margin="0",T.innerHTML=`<a href="${C}" target="_blank" rel="noopener noreferrer" style="cursor:pointer">${k}</a>`,this.ui.headlinesContainer.appendChild(T)});const y=this.ui.marketInfo.querySelector(".sources");if(y&&y.remove(),t.sources){const b=document.createElement("div");b.className="sources",b.style.cssText="font-size:0.7em; opacity:0.5; margin-top:1rem; border-top:1px solid rgba(255,255,255,0.1); padding-top:0.5rem;",b.textContent="Data Sources: "+t.sources[0]+", "+t.sources[1],this.ui.marketInfo.appendChild(b)}this.renderTreemap(t),this.drawIndexChart(t),this.updateMarketBreadth(t);const w=document.getElementById("velocity-marker");w&&t.fearGreedIndex&&(w.style.left=t.fearGreedIndex+"%")}console.log("[updateUI] Running AI scan, data:",t?t.date:"undefined"),this.runAIPatternScan(t)}updateMarketBreadth(t){if(!t.sectorMap)return;let e=0,n=0;Object.values(t.sectorMap).forEach(u=>{(typeof u=="object"?u.change:u)>=0?e++:n++});const i=e+n||1,r=e/i*100,a=document.getElementById("breadth-fill"),s=document.getElementById("breadth-up"),c=document.getElementById("breadth-down");a&&(a.style.width=r+"%"),s&&(s.textContent=`${e} Up`),c&&(c.textContent=`${n} Down`)}renderTreemap(t){const e=document.getElementById("treemap-container");if(!e||!t.sectorMap)return;let n=[];Object.keys(t.sectorMap).forEach(m=>{const p=t.sectorMap[m],_=typeof p=="object"?p.change:p,d=typeof p=="object"?p.weight:1;n.push({id:m,val:_,weight:d})}),n.sort((m,p)=>p.weight-m.weight),e.innerHTML="";const i={x:0,y:0,w:e.clientWidth,h:e.clientHeight};if(i.w===0||i.h===0)return;const r=(m,p)=>{if(m.length===0)return 0;const _=m.reduce((w,b)=>w+b.area,0),d=p*p,v=_*_;let y=0;for(let w of m){const b=w.area,D=Math.max(d*b/v,v/(d*b));D>y&&(y=D)}return y},a=(m,p,_,d,v)=>{const y=document.createElement("div");y.className="sector-cell",y.style.left=p+"px",y.style.top=_+"px",y.style.width=Math.max(0,d-1)+"px",y.style.height=Math.max(0,v-1)+"px";const w=m.val;let b,D;if(w>=0){const T=Math.min(1,w/3),I=11,E=46+T*40;b=`rgb(${I}, ${E}, 30)`,D="#4ade80"}else b=`rgb(${46+Math.min(1,Math.abs(w)/3)*40}, 11, 11)`,D="#f87171";y.style.backgroundColor=b,y.style.color=D,y.style.border="1px solid rgba(0,0,0,0.3)",y.style.boxShadow="inset 0 0 10px rgba(0,0,0,0.2)";const C={XLK:"Technology",XLF:"Financials",XLV:"Healthcare",XLY:"Discretionary",XLP:"Staples",XLE:"Energy",XLI:"Industrials",XLB:"Materials",XLU:"Utilities",XLRE:"Real Estate",XLC:"Comm. Svcs"}[m.id]||m.id;y.innerHTML=`
                <div style="text-align:center; pointer-events:none; width:100%; overflow:hidden; display:flex; flex-direction:column; justify-content:center; height:100%;">
                    <span style="display:block; font-size:0.8em; font-weight:700; color:white; margin-bottom:2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; padding:0 2px;">${C}</span>
                    <span style="font-size:0.85em; font-weight:600;">${w>0?"+":""}${w}%</span>
                </div>
            `,y.title=`${C}: ${w}%`,e.appendChild(y)},s=(m,p)=>{const _=m.reduce((v,y)=>v+y.area,0);if(p.w<p.h){const v=_/p.w;let y=p.x;m.forEach(w=>{const b=w.area/v;a(w,y,p.y,b,v),y+=b}),p.y+=v,p.h-=v}else{const v=_/p.h;let y=p.y;m.forEach(w=>{const b=w.area/v;a(w,p.x,y,v,b),y+=b}),p.x+=v,p.w-=v}},c=n.reduce((m,p)=>m+p.weight,0),u=i.w*i.h/c;n.forEach(m=>m.area=m.weight*u);let l=[],f=[...n];for(;f.length>0;){const m=f[0],p=Math.min(i.w,i.h),_=[...l,m],d=r(l,p),v=r(_,p);if(l.length===0||v<=d)l.push(m),f.shift();else if(s(l,i),l=[],i.w<=0||i.h<=0)break}l.length>0&&s(l,i)}drawIndexChart(t){const e=document.getElementById("market-chart");if(!e||!this.marketDataService.dataMap)return;const n=e.getContext("2d"),i=e.width,r=e.height;n.clearRect(0,0,i,r);const a=Object.keys(this.marketDataService.dataMap).sort(),s=a.indexOf(t.date);if(s===-1)return;const c=Math.max(0,s-30),l=a.slice(c,s+1).map(v=>this.marketDataService.dataMap[v].indexValue||0),f=Math.min(...l),p=Math.max(...l)-f||1,_=l[l.length-1]>=l[0];n.strokeStyle=_?"#00ffaa":"#ff5050",n.lineWidth=2,n.lineJoin="round",n.beginPath(),l.forEach((v,y)=>{const w=y/(l.length-1)*i,D=(r-(v-f)/p*r)*.8+r*.1;y===0?n.moveTo(w,D):n.lineTo(w,D)}),n.stroke();const d=n.createLinearGradient(0,0,0,r);d.addColorStop(0,_?"rgba(0, 255, 170, 0.2)":"rgba(255, 80, 80, 0.2)"),d.addColorStop(1,"rgba(0,0,0,0)"),n.fillStyle=d,n.lineTo(i,r),n.lineTo(0,r),n.fill()}runAIPatternScan(t){var $,z;const e=document.getElementById("ai-analyst-text");if(!e||!t)return;const n=t.fearGreedIndex||50,i=parseFloat(t.vix)||15,r=parseFloat(t.marketChangePercent)||0;parseFloat(t.sp500Change),parseFloat(t.dowChange);const a=t.rsi||50,s=t.yieldSpread||0,c=t.date||"";($=t.indexValue)!=null&&$.toLocaleString(),(z=t.sp500Value)!=null&&z.toLocaleString();let u="NEUTRAL",l="#ffffff",f="",m="#ffffff11";n<=25?(u="EXTREME FEAR",l="#ff5050",f="",m="#ff505022"):n<=40?(u="FEAR",l="#ff7744",f="",m="#ff774422"):n>=75?(u="EXTREME GREED",l="#00ffaa",f="",m="#00ffaa22"):n>=60?(u="GREED",l="#50ffaa",f="",m="#50ffaa22"):i>25?(u="HIGH VOLATILITY",l="#ff5050",f="",m="#ff505022"):i<15&&r>0&&(u="RISK-ON",l="#00ffaa",f="",m="#00ffaa22");let p="",_="#8899a6";r>1.5?(p=" Rally",_="#00ffaa"):r>.5?(p=" Up",_="#50ffaa"):r>0?(p=" +",_="#ffcc00"):r<-1.5?(p=" Selloff",_="#ff5050"):r<-.5?(p=" Down",_="#ff7744"):r<0?(p=" -",_="#ffcc00"):(p=" Flat",_="#8899a6");let d="",v="";if(t.sectorMap){const Y={XLK:"Tech",XLF:"Financials",XLV:"Healthcare",XLE:"Energy",XLI:"Industrials",XLU:"Utilities",XLY:"Consumer Discretionary",XLP:"Consumer Staples",XLB:"Materials",XLRE:"Real Estate",XLC:"Communications"},oe=Object.entries(t.sectorMap);let ue=null,Qe=null,_e=-1/0,fe=1/0;oe.forEach(([bt,Je])=>{const Ae=typeof Je=="object"?Je.change:Je;Ae>_e&&(_e=Ae,ue=bt),Ae<fe&&(fe=Ae,Qe=bt)}),d=Y[ue]||ue||"",v=Y[Qe]||Qe||""}let y="";const w=Math.abs(r);n<=25&&i>25?y=` Capitulation conditions present. Extreme fear with volatility spiking. ${v?`${v} under heavy selling pressure.`:""} Historically, these washouts mark bottoms. Smart money accumulates here.`:n<=25&&r<-1?y=` Broad risk-off as fear dominates. Markets searching for support levels. ${d?`Only ${d} showing any resilience.`:""} Oversold conditions may trigger a technical bounce.`:n>=75&&r>1?y=` Euphoric rally pushing into overbought territory. ${d?`${d} leading the charge.`:""} Late-stage momentum  exercise caution. Mean reversion risk elevated.`:n>=60&&r>.5?y=` Bulls firmly in control with strong breadth. ${d?`${d} outperforming the broader market.`:""} Momentum favors continuation. Dips likely to be bought.`:i>25?y=` Volatility surging  expect wild price swings. ${v?`${v} taking the brunt of selling.`:""} Options premiums elevated. Consider hedging or reducing exposure.`:r<-1.5?y=` Sharp selling across the board. ${v?`${v} leading losses.`:""} Key support levels being tested. Watch for follow-through or reversal signals.`:r>1.5?y=` Strong rally with broad participation. ${d?`${d} surging.`:""} Bulls in command  momentum intact. Technical breakout signals possible.`:w<.3&&i<18?y=" Quiet consolidation day. Markets coiling for the next move. Low volatility suggests complacency. Watch for breakout catalysts.":r>0&&n<45?y=` Tentative green despite lingering fear. ${d?`${d} leading.`:""} Early signs of stabilization. Sentiment still fragile but improving.`:r<0&&n>55?y=` Mild pullback amid greedy sentiment. ${v?`${v} seeing some profit-taking.`:""} Healthy consolidation or start of rotation? Monitor closely.`:r>0?y=` Modest gains with balanced sentiment. ${d?`${d} showing relative strength.`:""} Risk appetite present but not aggressive.`:r<0?y=` Slight weakness across indices. ${v?`${v} underperforming.`:""} Cautious tone but no panic. Watch for continuation or support.`:y=" Indecisive session with markets little changed. Neither bulls nor bears with conviction. Wait for clearer directional signals.";let b="",D="#8899a6";s<0?(b=" Inverted (Recession Signal)",D="#ff5050"):s<.5?(b=" Flat (Slowing)",D="#ffcc00"):(b=" Normal",D="#50ffaa");let k="";d&&v&&(k=`<span style="color:#50ffaa"> ${d}</span> <span style="color:#ff7744"> ${v}</span>`);let C=50;C+=(n-50)*.4,C+=r*8,C-=(i-18)*1.5,C+=s>0?5:-10,C=Math.max(0,Math.min(100,Math.round(C)));let T="Balanced",I="#ffffff";C>=70?(T="Strong",I="#00ffaa"):C>=55?(T="Healthy",I="#50ffaa"):C<=30?(T="Weak",I="#ff5050"):C<=45&&(T="Fragile",I="#ff7744");let E=50;r>0&&i<18&&(E+=20),r<0&&i>22&&(E-=20),n>60&&r<0&&(E-=10),n<40&&r>0&&(E+=15),E=Math.max(0,Math.min(100,Math.round(E)));let B=E>=60?"Inflow":E<=40?"Outflow":"Neutral",j=E>=60?"#50ffaa":E<=40?"#ff7744":"#8899a6",P=50;P+=(i-18)*2,P-=(n-50)*.3,s<0&&(P+=20),Math.abs(r)>2&&(P+=15),P=Math.max(0,Math.min(100,Math.round(P)));let A="Moderate",V="#ffcc00";P>=70?(A="Elevated",V="#ff5050"):P>=55?(A="Caution",V="#ff7744"):P<=30?(A="Low",V="#00ffaa"):P<=45&&(A="Calm",V="#50ffaa");let G=50+r*15+(a-50)*.3;G=Math.max(0,Math.min(100,Math.round(G)));let S=G>=65?" Bullish":G<=35?" Bearish":" Neutral",F=G>=65?"#50ffaa":G<=35?"#ff7744":"#8899a6";e.innerHTML=`
            <div style="margin-bottom: 8px; display: flex; align-items: center; gap: 8px; flex-wrap: nowrap; white-space: nowrap; overflow: hidden;">
                <span style="background: ${m}; color: ${l}; padding: 3px 8px; border-radius: 4px; font-size: 0.7em; font-weight: 700; letter-spacing: 0.3px; box-shadow: 0 0 8px ${l}44; flex-shrink: 0;">
                    ${f} ${u}
                </span>
                <span style="font-size: 0.7em; color: var(--text-faint); flex-shrink: 0;">${c}</span>
                <span style="margin-left: auto; font-size: 0.7em; color: ${_}; font-weight: 600; flex-shrink: 0;">${p}</span>
            </div>
            
            <div style="font-size: 0.9em; line-height: 1.7; color: var(--text-main); margin-bottom: 12px;">
                ${y}
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; margin-bottom: 10px; font-size: 0.7em;">
                <div style="background: rgba(255,255,255,0.05); padding: 8px 6px; border-radius: 4px; text-align: center; border-bottom: 2px solid ${I};">
                    <div style="color: var(--text-faint); font-size: 0.9em; margin-bottom: 2px;">PULSE</div>
                    <div style="color: ${I}; font-weight: 700; font-size: 1.1em;">${C}</div>
                    <div style="color: ${I}; font-size: 0.8em;">${T}</div>
                </div>
                <div style="background: rgba(255,255,255,0.05); padding: 8px 6px; border-radius: 4px; text-align: center; border-bottom: 2px solid ${j};">
                    <div style="color: var(--text-faint); font-size: 0.9em; margin-bottom: 2px;">FLOW</div>
                    <div style="color: ${j}; font-weight: 700; font-size: 1.1em;">${E}</div>
                    <div style="color: ${j}; font-size: 0.8em;">${B}</div>
                </div>
                <div style="background: rgba(255,255,255,0.05); padding: 8px 6px; border-radius: 4px; text-align: center; border-bottom: 2px solid ${V};">
                    <div style="color: var(--text-faint); font-size: 0.9em; margin-bottom: 2px;">RISK</div>
                    <div style="color: ${V}; font-weight: 700; font-size: 1.1em;">${P}</div>
                    <div style="color: ${V}; font-size: 0.8em;">${A}</div>
                </div>
                <div style="background: rgba(255,255,255,0.05); padding: 8px 6px; border-radius: 4px; text-align: center; border-bottom: 2px solid ${F};">
                    <div style="color: var(--text-faint); font-size: 0.9em; margin-bottom: 2px;">MOMO</div>
                    <div style="color: ${F}; font-weight: 700; font-size: 1.1em;">${G}</div>
                    <div style="color: ${F}; font-size: 0.8em;">${S}</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 12px; flex-wrap: wrap; font-size: 0.75em; color: var(--text-faint); padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.1);">
                <span> Yield: <strong style="color: ${D}">${b}</strong></span>
                ${k?`<span> ${k}</span>`:""}
            </div>
        `,e.style.borderLeft=`3px solid ${l}`,e.style.paddingLeft="12px",e.style.background=`linear-gradient(135deg, ${l}08, transparent)`,e.style.borderRadius="0 8px 8px 0",e.style.padding="12px"}updateVisuals(t){if(!this.mask)try{this.mask=ht.getInstance()}catch(e){console.warn("Mask instance not ready yet",e)}this.mask&&this.mask.updateVisualization?(console.log("[AppController] Updating mask visualization with data:",t.date),this.mask.updateVisualization(t)):console.warn("[AppController] Mask not available for visualization update")}drawSparkline(t,e,n=null){const i=document.getElementById(t);if(!i)return;const r=i.getContext("2d"),a=i.width,s=i.height;if(r.clearRect(0,0,a,s),!e||e.length<2)return;const c=Math.min(...e),l=Math.max(...e)-c||1,f=e[e.length-1]>=e[0],m=n||(f?"#00ffaa":"#ff5050");r.strokeStyle=m,r.lineWidth=1.5,r.lineJoin="round",r.beginPath(),e.forEach((_,d)=>{const v=d/(e.length-1)*a,y=s-(_-c)/l*(s-4)-2;d===0?r.moveTo(v,y):r.lineTo(v,y)}),r.stroke();const p=r.createLinearGradient(0,0,0,s);p.addColorStop(0,m),p.addColorStop(1,"rgba(0,0,0,0)"),r.globalAlpha=.15,r.fillStyle=p,r.lineTo(a,s),r.lineTo(0,s),r.fill(),r.globalAlpha=1}updateLeaderboard(t){const e=document.getElementById("leaders-list"),n=document.getElementById("laggards-list");if(!t.sectorMap||!e||!n)return;const i=Object.entries(t.sectorMap).map(([a,s])=>({id:a,val:typeof s=="object"?s.change:s}));i.sort((a,s)=>s.val-a.val);const r=a=>`<div>${a.id}: ${a.val>0?"+":""}${a.val}%</div>`;e.innerHTML=i.slice(0,3).map(r).join(""),n.innerHTML=i.slice(-3).reverse().map(r).join("")}updateAIAnalystList(t,e){const n=document.getElementById("ai-signals-list");if(!n)return;let i=[];if(i.push(`System State: <span class="ai-signal">${t.moodState}</span> (${t.regime})`),t.marketChangePercent>1?i.push('<span class="ai-signal" style="color:#00ffaa">Strong Breadth</span>: Buyers dominant (>1%)'):t.marketChangePercent<-1&&i.push('<span class="ai-signal" style="color:#ff5050">Distribution</span>: Heavy selling pressure'),t.sectorMap){const l=Object.entries(t.sectorMap).map(([v,y])=>({id:v,val:y.change||y}));l.sort((v,y)=>y.val-v.val);const f=l[0],m=l[l.length-1],p={XLK:"Tech",XLF:"Financials",XLV:"Health",XLE:"Energy",XLI:"Industrials",XLU:"Utilities"},_=p[f.id]||f.id,d=p[m.id]||m.id;f.val>.5&&i.push(`Rotation into <span class="ai-signal">${_}</span> (+${f.val}%)`),m.val<-.5&&i.push(`Weakness in <span class="ai-signal" style="color:#ff5050">${d}</span> (${m.val}%)`)}const r=t.rsi||50;r>75?i.push(`RSI Divergence: <span class="ai-signal" style="color:#ff5050">Overbought</span> (${r.toFixed(0)})`):r<25&&i.push(`RSI Compression: <span class="ai-signal" style="color:#00ffaa">Oversold</span> (${r.toFixed(0)})`);const a=parseFloat(t.vix);a>30&&i.push(`Volatility Spiking: VIX ${a} (Defensive Posture)`),t.volumeRatio>1.5?i.push(`Institutional Volume: ${t.volumeRatio}x Average`):t.volumeRatio<.6&&i.push(`Low Liquidity Environment (${t.volumeRatio}x Vol)`);const s=t.tenYearYield||4;s>4.5?i.push(`Macro Headwind: 10Y Yields Elevated (${s}%)`):s<3.5&&i.push(`Yield Support: Rates stabilizing (${s}%)`);const c=["Pattern: Bull Flag detected on hourly.","Pattern: Consolidation ahead of breakout.","Sentiment: Retail sentiment is cooling.","Flows: Net positive delta in dark pools.","Algo: HFT activity detected at close."],u=t.date.split("").reduce((l,f)=>l+f.charCodeAt(0),0);i.push(c[u%c.length]),n.innerHTML=i.map(l=>`<li>${l}</li>`).join("")}updateUI(t,e,n){const i=document.getElementById("market-status");if(i&&(i.classList.toggle("hidden",!e),e&&(i.textContent=`Market Closed on ${n}. Data from ${t.date}`)),document.getElementById("val-index")){const S=t.indexValue!==void 0?t.indexValue:0;document.getElementById("val-index").textContent=S.toLocaleString(void 0,{maximumFractionDigits:2});const F=document.getElementById("val-change");if(F){const $=parseFloat(t.marketChangePercent||0).toFixed(2);F.textContent=(t.marketChangePercent>0?"+":"")+$+"%",F.className="change-pill "+(t.marketChangePercent>0?"positive":"negative")}}if(document.getElementById("val-sp500")){const S=t.sp500Value!==void 0?t.sp500Value:0;document.getElementById("val-sp500").textContent=S.toLocaleString(void 0,{maximumFractionDigits:2});const F=document.getElementById("val-sp500-change");if(F){const $=parseFloat(t.sp500Change||0).toFixed(2);F.textContent=(t.sp500Change>0?"+":"")+$+"%",F.className="change-pill "+(t.sp500Change>0?"positive":"negative")}}const r=document.getElementById("val-volume");if(r){const S=t.volume;isNaN(S)?r.textContent=S||"--":r.textContent=S>1e9?(S/1e9).toFixed(1)+"B":(S/1e6).toFixed(1)+"M"}const a=document.getElementById("val-vix");if(a){const S=parseFloat(t.vix);a.textContent=isNaN(S)?"--":S.toFixed(2),isNaN(S)||(a.style.color=S>20?"#ff5050":S<15?"#00ffaa":"#ffffff")}const s=document.getElementById("val-52w-range");if(s){const S=t.yearLow?parseFloat(t.yearLow).toFixed(2):"--",F=t.yearHigh?parseFloat(t.yearHigh).toFixed(2):"--";s.textContent=t.yearLow&&t.yearHigh?`${S} - ${F}`:"--"}if(document.getElementById("val-gold")){const S=parseFloat(t.gold);document.getElementById("val-gold").textContent=isNaN(S)?"--":S.toLocaleString(void 0,{maximumFractionDigits:1})}if(document.getElementById("val-oil")){const S=parseFloat(t.oil);document.getElementById("val-oil").textContent=isNaN(S)?"--":S.toFixed(2)}if(this.drawIndexChart&&this.drawIndexChart(t),!this.marketDataService.dataMap)return;const c=Object.keys(this.marketDataService.dataMap).sort(),u=c.indexOf(t.date);let l=[],f=[],m=[],p=0,_=0,d=0;if(u!==-1){const S=Math.max(0,u-20),F=c.slice(S,u+1);l=F.map(z=>this.marketDataService.dataMap[z].indexValue),f=F.map(z=>this.marketDataService.dataMap[z].sp500Value),m=F.map(z=>this.marketDataService.dataMap[z].tenYearYield||4);const $=z=>z.length<2?0:(z[z.length-1]-z[0])/z[0]*100;p=$(l).toFixed(2),_=$(f).toFixed(2),d=$(m).toFixed(2)}this.drawSparkline("chart-nasdaq",l),this.drawSparkline("chart-sp500",f),this.drawSparkline("chart-yield",m,"#cc99ff");const v=(S,F,$)=>{const z=document.getElementById(S);z&&(z.textContent=F,z.style.color=$)},y=S=>S>=0?"#00ffaa":"#ff5050";v("val-index-mini",t.indexValue.toLocaleString(),"#fff"),v("pch-nasdaq",(p>0?"+":"")+p+"%",y(p)),v("val-sp500-mini",t.sp500Value.toLocaleString(),"#fff"),v("pch-sp500",(_>0?"+":"")+_+"%",y(_)),v("val-yield-mini",(t.tenYearYield||4)+"%","#fff"),v("pch-yield",(d>0?"+":"")+d+"%",y(d));const w=t.rsi||50,b=document.getElementById("meter-rsi"),D=document.getElementById("val-rsi");b&&(b.style.width=`${w}%`,b.style.backgroundColor=w>70?"#ff5050":w<30?"#00ffaa":"#ffcc00"),D&&(D.textContent=w.toFixed(1));const k=t.volumeRatio||1,C=document.getElementById("meter-rvol"),T=document.getElementById("val-rvol");if(C){const S=Math.min(100,k/2*100);C.style.width=`${S}%`,C.style.backgroundColor=k>1?"#00ffaa":"#ffffff"}if(T&&(T.textContent=k.toFixed(2)+"x"),this.updateLeaderboard(t),this.updateAIAnalystList(t),this.ui.headlinesContainer.innerHTML="",t.headlines.forEach(S=>{const F=typeof S=="object"&&S!==null,$=F?S.title:S,z=F?S.link:"#",Y=document.createElement("p");Y.style.margin="0",Y.innerHTML=`<a href="${z}" target="_blank" rel="noopener noreferrer" style="cursor:pointer">${$}</a>`,this.ui.headlinesContainer.appendChild(Y)}),this.ui.valSentiment){this.ui.valSentiment.textContent=t.moodState.toUpperCase();const S=t.fearGreedIndex;let F="NEUTRAL",$="#ffffff";S<=25?(F=`EXTREME FEAR (${S})`,$="#ff5050"):S<=45?(F=`FEAR (${S})`,$="#ffaa50"):S<=55?(F=`NEUTRAL (${S})`,$="#ffffff"):S<=75?(F=`GREED (${S})`,$="#50ffaa"):(F=`EXTREME GREED (${S})`,$="#00ffaa"),this.ui.valSentiment.textContent=F,this.ui.valSentiment.style.color=$}const I=document.getElementById("val-regime");I&&(I.textContent="CNN Fear & Greed Index");const E=document.getElementById("val-fear-greed");if(E&&t.fearGreedIndex!==void 0){const S=t.fearGreedIndex;let F=S,$="#ffffff";if(S<=25?(F=`${S}  Extreme Fear`,$="#ff5050"):S<=45?(F=`${S}  Fear`,$="#ffaa50"):S<=55?(F=`${S}  Neutral`,$="#ffffff"):S<=75?(F=`${S}  Greed`,$="#50ffaa"):(F=`${S}  Extreme Greed`,$="#00ffaa"),this.audioHandler&&typeof this.audioHandler.setMood=="function"){let z="neutral";S<=25?z="extreme_fear":S<=45?z="fear":S<=55?z="neutral":S<=75?z="greed":z="extreme_greed",this.audioHandler.setMood(z),t.vix&&typeof this.audioHandler.setDistortionLevel=="function"&&this.audioHandler.setDistortionLevel(parseFloat(t.vix))}if(!this.mask&&ht&&typeof ht.getInstance=="function"&&(this.mask=ht.getInstance()),this.mask&&typeof this.mask.switchModel=="function"){const z=this.determineRulingGod(t);if(z&&(this.mask.switchModel(z),this.ui.valSentiment&&(this.ui.valSentiment.textContent=z.toUpperCase(),this.ui.valSentiment.style.color="#FFD700"),this.postProcessing)){let Y={strength:1,threshold:.25,radius:.1};switch(z){case"zeus":Y={strength:2.5,threshold:.1,radius:.2};break;case"dionysus":Y={strength:2,threshold:.15,radius:.3};break;case"hades":case"poseidon":Y={strength:.6,threshold:.4,radius:.05};break;case"hypnos":case"chronos":Y={strength:.8,threshold:.3,radius:0};break;case"ares":Y={strength:1.5,threshold:.3,radius:.05};break;case"apollo":case"athena":Y={strength:1.2,threshold:.2,radius:.25};break}this.postProcessing.setBloomParams(Y)}}E.textContent=F,E.style.color=$}if(document.getElementById("val-yield-curve")){const S=parseFloat(t.yieldCurve);document.getElementById("val-yield-curve").textContent=isNaN(S)?"--":S.toFixed(2)+"%"}if(document.getElementById("val-dxy")){const S=parseFloat(t.dollarIndex);document.getElementById("val-dxy").textContent=isNaN(S)?"--":S.toFixed(2)}if(document.getElementById("val-dow")){const S=parseFloat(t.dowValue);document.getElementById("val-dow").textContent=isNaN(S)?"--":S.toLocaleString(void 0,{maximumFractionDigits:2});const F=document.getElementById("val-dow-change");if(F){const $=parseFloat(t.dowChange);isNaN($)?F.textContent="--":(F.textContent=($>0?"+":"")+$.toFixed(2)+"%",F.className="change-pill "+($>0?"positive":"negative"))}}this.renderTreemap(t),this.updateMarketBreadth(t);const B=document.getElementById("velocity-marker");B&&t.fearGreedIndex&&(B.style.left=t.fearGreedIndex+"%");const j=document.getElementById("risk-marker"),P=document.getElementById("risk-val");if(j&&t.fearGreedIndex!==void 0&&(j.style.left=t.fearGreedIndex+"%",P)){const S=t.fearGreedIndex;S<40?(P.textContent="Risk Off",P.style.color="#ff5050"):S>60?(P.textContent="Risk On",P.style.color="#00ffaa"):(P.textContent="Neutral",P.style.color="#ffffff")}if(this.ui.timelineSlider&&this.marketDataService.dataMap){const F=Object.keys(this.marketDataService.dataMap).sort().indexOf(t.date);F!==-1&&(this.ui.timelineSlider.value=F,this.ui.timelineCurrent.textContent=t.date)}const A=document.getElementById("val-dow");A&&(A.textContent=t.dowValue?parseFloat(t.dowValue).toLocaleString(void 0,{maximumFractionDigits:2}):"--");const V=document.getElementById("val-dow-change");if(V){const S=t.dowChange||0;V.textContent=(S>0?"+":"")+S+"%",V.className="change-pill "+(S>=0?"positive":"negative")}this.ui.currentDataCache=t,this.drawIndexChart(t),this.drawYieldCurve(t);const G=document.getElementById("headlines-container");G&&t.headlines&&(G.innerHTML="",t.headlines.slice(0,10).forEach(S=>{const F=typeof S=="object"&&S!==null,$=F?S.title:S,z=F?S.link:"#",Y=document.createElement("p");Y.style.margin="0",Y.style.marginBottom="6px",Y.innerHTML=`<a href="${z}" target="_blank" rel="noopener noreferrer">${$}</a>`,G.appendChild(Y)})),this.runAIPatternScan(t)}setupEventListeners(){var n,i,r,a,s;this.ui.btnToday&&this.ui.btnToday.addEventListener("click",()=>{this.stopPlay(),this.picker.setDate(new Date,!0)});const t=["nasdaq","sp500","dow"],e=c=>{this.activeChart=c;const u={nasdaq:"NASDAQ",sp500:"S&P 500",dow:"DOW JONES"},l=document.getElementById("chart-title");l&&(l.textContent=u[c]),["row-nasdaq","row-sp500","row-dow"].forEach(p=>{const _=document.getElementById(p);_&&_.classList.remove("active-row")});const f="row-"+c,m=document.getElementById(f);m&&m.classList.add("active-row"),this.ui.currentDataCache&&this.drawIndexChart(this.ui.currentDataCache)};(n=document.getElementById("row-nasdaq"))==null||n.addEventListener("click",()=>e("nasdaq")),(i=document.getElementById("row-sp500"))==null||i.addEventListener("click",()=>e("sp500")),(r=document.getElementById("row-dow"))==null||r.addEventListener("click",()=>e("dow")),(a=document.getElementById("btn-chart-prev"))==null||a.addEventListener("click",()=>{let c=t.indexOf(this.activeChart);c=(c-1+t.length)%t.length,e(t[c])}),(s=document.getElementById("btn-chart-next"))==null||s.addEventListener("click",()=>{let c=t.indexOf(this.activeChart);c=(c+1)%t.length,e(t[c])}),this.initCommandSearch()}drawYieldCurve(t){const e=document.getElementById("yield-curve-chart");if(!e)return;const n=window.devicePixelRatio||1,i=e.getBoundingClientRect();e.width=i.width*n,e.height=i.height*n;const r=e.getContext("2d");r.scale(n,n);const a=i.width,s=i.height;r.clearRect(0,0,a,s);let c={};Array.isArray(t.yieldCurve)&&t.yieldCurve.forEach(P=>{c[P.maturity]=P.val});const u=c["3M"]||t.threeMonthYield||4.3,l=c["5Y"]||t.fiveYearYield||4,f=c["10Y"]||t.tenYearYield||4.2,m=c["30Y"]||t.thirtyYearYield||4.5,p=[{months:3,val:u},{months:60,val:l},{months:120,val:f},{months:360,val:m}],_=(P,A,V,G,S)=>V+(S-V)*(P-A)/(G-A),d=P=>{if(P<=p[0].months)return p[0].val;if(P>=p[p.length-1].months)return p[p.length-1].val;for(let A=0;A<p.length-1;A++)if(P>=p[A].months&&P<=p[A+1].months)return _(P,p[A].months,p[A].val,p[A+1].months,p[A+1].val);return f},y=[{label:"3M",months:3},{label:"6M",months:6},{label:"1Y",months:12},{label:"2Y",months:24},{label:"3Y",months:36},{label:"5Y",months:60},{label:"7Y",months:84},{label:"10Y",months:120},{label:"20Y",months:240},{label:"30Y",months:360}].map(P=>({maturity:P.label,val:d(P.months),isReal:P.months===3||P.months===60||P.months===120||P.months===360})),w=y.map(P=>P.val),b=Math.min(...w)-.2,D=Math.max(...w)+.2,k=D-b||1,C={left:35,right:10,top:15,bottom:20},T=a-C.left-C.right,I=s-C.top-C.bottom,E=P=>C.left+P/(y.length-1)*T,B=P=>C.top+I-(P-b)/k*I;r.strokeStyle="rgba(255, 255, 255, 0.1)",r.lineWidth=1,r.setLineDash([2,2]);for(let P=0;P<=4;P++){const A=C.top+I/4*P;r.beginPath(),r.moveTo(C.left,A),r.lineTo(a-C.right,A),r.stroke()}r.setLineDash([]),r.beginPath(),r.strokeStyle="#00ffcc",r.lineWidth=2,r.lineCap="round",r.lineJoin="round";for(let P=0;P<y.length;P++){const A=E(P),V=B(y[P].val);if(P===0)r.moveTo(A,V);else{const G=E(P-1),S=B(y[P-1].val),F=(G+A)/2;r.quadraticCurveTo(G+(A-G)*.5,S,F,(S+V)/2),r.quadraticCurveTo(F,V,A,V)}}r.stroke();const j=r.createLinearGradient(0,C.top,0,s);j.addColorStop(0,"rgba(0, 255, 204, 0.2)"),j.addColorStop(1,"rgba(0, 255, 204, 0)"),r.lineTo(E(y.length-1),s),r.lineTo(E(0),s),r.closePath(),r.fillStyle=j,r.fill(),y.forEach((P,A)=>{const V=E(A),G=B(P.val);r.beginPath(),P.isReal?(r.arc(V,G,4,0,Math.PI*2),r.fillStyle="#00ffcc"):(r.arc(V,G,2,0,Math.PI*2),r.fillStyle="#888888"),r.fill()}),r.fillStyle="rgba(255, 255, 255, 0.7)",r.font='10px "Space Mono", monospace',r.textAlign="center",y.forEach((P,A)=>{if(A%2===0||A===y.length-1){const V=E(A);r.fillText(P.maturity,V,s-3)}}),r.textAlign="right",r.fillStyle="rgba(255, 255, 255, 0.6)",r.font='10px "Space Mono", monospace',r.fillText(D.toFixed(1)+"%",C.left-3,C.top+4),r.fillText(b.toFixed(1)+"%",C.left-3,s-C.bottom),y[0].val>y[y.length-1].val&&(r.fillStyle="#ff5050",r.font='bold 10px "Space Mono", monospace',r.textAlign="right",r.fillText(" INVERTED",a-C.right,C.top))}drawIndexChart(t){if(!t)return;this.currentData=t;const e=document.getElementById("market-chart");if(!e||!this.marketDataService.dataMap)return;this.activeChart,this.activeChart;const n=e.getContext("2d"),i=e.width,r=e.height;n.clearRect(0,0,i,r);const a=Object.keys(this.marketDataService.dataMap).sort(),s=a.indexOf(t.date);if(s===-1)return;const c=Math.max(0,s-30),u=a.slice(c,s+1);let l=[];if(this.activeChart==="sp500"?l=u.map(v=>this.marketDataService.dataMap[v].sp500Value):this.activeChart==="dow"?l=u.map(v=>this.marketDataService.dataMap[v].dowValue||0):l=u.map(v=>this.marketDataService.dataMap[v].indexValue),l.length<2)return;const f=Math.min(...l),p=Math.max(...l)-f||1;n.beginPath();const _=l[l.length-1]>=l[0]?"#00ffaa":"#ff5050";n.strokeStyle=_,n.lineWidth=2;const d=n.createLinearGradient(0,0,0,r);d.addColorStop(0,_),d.addColorStop(1,"rgba(0,0,0,0)"),n.fillStyle=d,n.moveTo(0,r),l.forEach((v,y)=>{const w=y/(l.length-1)*i,b=r-(v-f)/p*r*.8-r*.1;n.lineTo(w,b)}),n.lineTo(i,r),n.globalAlpha=.2,n.fill(),n.globalAlpha=1,n.beginPath(),l.forEach((v,y)=>{const w=y/(l.length-1)*i,b=r-(v-f)/p*r*.8-r*.1;y===0?n.moveTo(w,b):n.lineTo(w,b)}),n.stroke()}determineRulingGod(t){if(!t)return null;const e=t.fearGreedIndex||50,n=t.vix||20,i=t.marketChangePercent||0,r=t.volumeRatio||1,a=t.rsi||50;Math.abs(t.marketGap||0);const s=t.dayHigh||0,c=t.yearHigh||s,u=t.yearLow||t.dayLow,l=t.indexValue||0,f=t.intradayRange||0;return l>=c*.98||i>1&&e>75?"zeus":e>80&&a>70?"dionysus":r>1.5&&Math.abs(i)>1.5?"hermes":i>1&&a<50?"apollo":e<15?"hades":i<-1.8&&r>1.3?"poseidon":n>28&&f>1.5?"ares":Math.abs(i)<.3&&n>20?"hecate":r<.6?"hypnos":n<14?"chronos":l<=u*1.05?"hephaestus":"athena"}}document.addEventListener("DOMContentLoaded",()=>{console.log("[Main] Initializing WebGL Experience...");const o=document.querySelector("canvas.experience__canvas");o?new Ji(o,ht):console.error("Canvas element not found!"),console.log("[Main] Initializing AppController..."),window.app=new co});
